var snarkjs=function(t){"use strict";const a=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function o(t,a){return a&&10!=a?16==a?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const e=o;function i(t){const o=t.toString(16);return 4*(o.length-1)+a[parseInt(o[0],16)]}function n(t){return BigInt(t)<BigInt(0)}function c(t){return!t}function l(t,a){return BigInt(t)<<BigInt(a)}function s(t,a){return BigInt(t)>>BigInt(a)}const r=l,d=s;function _(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function u(t){let a=BigInt(t);const o=[];for(;a;)a&BigInt(1)?o.push(1):o.push(0),a>>=BigInt(1);return o}function g(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)}function p(t,a){return BigInt(t)+BigInt(a)}function f(t,a){return BigInt(t)-BigInt(a)}function L(t){return-BigInt(t)}function h(t,a){return BigInt(t)*BigInt(a)}function m(t,a){return BigInt(t)**BigInt(a)}function b(t,a){return BigInt(t)/BigInt(a)}function y(t,a){return BigInt(t)%BigInt(a)}function x(t,a){return BigInt(t)==BigInt(a)}function F(t,a){return BigInt(t)>BigInt(a)}function C(t,a){return BigInt(t)>=BigInt(a)}function w(t,a){return BigInt(t)&BigInt(a)}function B(t,a,o,e){const i="0000000"+o.toString(16),n=new Uint32Array(t.buffer,t.byteOffset+a,e/4),c=1+(4*(i.length-7)-1>>5);for(let t=0;t<c;t++)n[t]=parseInt(i.substring(i.length-8*t-8,i.length-8*t),16);for(let t=c;t<n.length;t++)n[t]=0;for(let a=4*n.length;a<e;a++)t[a]=g(w(s(o,8*a),255))}function A(t,a,o,e){const i="0000000"+o.toString(16),n=new DataView(t.buffer,t.byteOffset+a,e),c=1+(4*(i.length-7)-1>>5);for(let t=0;t<c;t++)n.setUint32(e-4*t-4,parseInt(i.substring(i.length-8*t-8,i.length-8*t),16),!1);for(let t=0;t<e/4-c;t++)n[t]=0}function P(t,a,e){e=e||t.byteLength,a=a||0;const i=new Uint32Array(t.buffer,t.byteOffset+a,e/4),n=new Array(e/4);return i.forEach(((t,a)=>n[n.length-a-1]=t.toString(16).padStart(8,"0"))),o(n.join(""),16)}function v(t,a,e){e=e||t.byteLength,a=a||0;const i=new DataView(t.buffer,t.byteOffset+a,e),n=new Array(e/4);for(let t=0;t<e/4;t++)n[t]=i.getUint32(4*t,!1).toString(16).padStart(8,"0");return o(n.join(""),16)}function I(t,a){return t.toString(a)}function q(t){const a=new Uint8Array(Math.floor((i(t)-1)/8)+1);return B(a,0,t,a.byteLength),a}const E=e(0),O=e(1);var S=Object.freeze({__proto__:null,fromString:o,e:e,fromArray:function(t,a){let o=BigInt(0);a=BigInt(a);for(let e=0;e<t.length;e++)o=o*a+BigInt(t[e]);return o},bitLength:i,isNegative:n,isZero:c,shiftLeft:l,shiftRight:s,shl:r,shr:d,isOdd:_,naf:function(t){let a=BigInt(t);const o=[];for(;a;){if(a&BigInt(1)){const t=2-Number(a%BigInt(4));o.push(t),a-=BigInt(t)}else o.push(0);a>>=BigInt(1)}return o},bits:u,toNumber:g,toArray:function(t,a){const o=[];let e=BigInt(t);for(a=BigInt(a);e;)o.unshift(Number(e%a)),e/=a;return o},add:p,sub:f,neg:L,mul:h,square:function(t){return BigInt(t)*BigInt(t)},pow:m,exp:function(t,a){return BigInt(t)**BigInt(a)},abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},div:b,mod:y,eq:x,neq:function(t,a){return BigInt(t)!=BigInt(a)},lt:function(t,a){return BigInt(t)<BigInt(a)},gt:F,leq:function(t,a){return BigInt(t)<=BigInt(a)},geq:C,band:w,bor:function(t,a){return BigInt(t)|BigInt(a)},bxor:function(t,a){return BigInt(t)^BigInt(a)},land:function(t,a){return BigInt(t)&&BigInt(a)},lor:function(t,a){return BigInt(t)||BigInt(a)},lnot:function(t){return!BigInt(t)},toRprLE:B,toRprBE:A,fromRprLE:P,fromRprBE:v,toString:I,toLEBuff:q,zero:E,one:O});function z(t,a,o){if(c(o))return t.one;const e=u(o);if(0==e.length)return t.one;let i=a;for(let o=e.length-2;o>=0;o--)i=t.square(i),e[o]&&(i=t.mul(i,a));return i}function M(t){if(t.m%2==1)if(x(y(t.p,4),1))if(x(y(t.p,8),1))if(x(y(t.p,16),1))!function(t){t.sqrt_q=m(t.p,t.m),t.sqrt_s=0,t.sqrt_t=f(t.sqrt_q,1);for(;!_(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=b(t.sqrt_t,2);let a=t.one;for(;t.eq(a,t.one);){const o=t.random();t.sqrt_z=t.pow(o,t.sqrt_t),a=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=b(f(t.sqrt_t,1),2),t.sqrt=function(t){const a=this;if(a.isZero(t))return a.zero;let o=a.pow(t,a.sqrt_tm1d2);const e=a.pow(a.mul(a.square(o),t),2**(a.sqrt_s-1));if(a.eq(e,a.negone))return null;let i=a.sqrt_s,n=a.mul(t,o),c=a.mul(n,o),l=a.sqrt_z;for(;!a.eq(c,a.one);){let t=a.square(c),e=1;for(;!a.eq(t,a.one);)t=a.square(t),e++;o=l;for(let t=0;t<i-e-1;t++)o=a.square(o);l=a.square(o),c=a.mul(c,l),n=a.mul(n,o),i=e}return a.geq(n,a.zero)?n:a.neg(n)}}(t);else{if(!x(y(t.p,16),9))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}(t)}else{if(!x(y(t.p,8),5))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}(t)}else x(y(t.p,4),3)&&function(t){t.sqrt_q=m(t.p,t.m),t.sqrt_e1=b(f(t.sqrt_q,3),4),t.sqrt=function(a){if(this.isZero(a))return this.zero;const o=this.pow(a,this.sqrt_e1),e=this.mul(this.square(o),a);if(this.eq(e,this.negone))return null;const i=this.mul(o,a);return t.geq(i,t.zero)?i:t.neg(i)}}(t);else{const a=y(m(t.p,t.m/2),4);1==a?function(t){t.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}(t):3==a?function(t){t.sqrt_q=m(t.p,t.m/2),t.sqrt_e34=b(f(t.sqrt_q,3),4),t.sqrt_e12=b(f(t.sqrt_q,1),2),t.frobenius=function(a,o){return a%2==1?t.conjugate(o):o},t.sqrt=function(t){const a=this,o=a.pow(t,a.sqrt_e34),e=a.mul(a.square(o),t),i=a.mul(a.frobenius(1,e),e);if(a.eq(i,a.negone))return null;const n=a.mul(o,t);let c;if(a.eq(e,a.negone))c=a.mul(n,[a.F.zero,a.F.one]);else{const t=a.pow(a.add(a.one,e),a.sqrt_e12);c=a.mul(t,n)}return a.geq(c,a.zero)?c:a.neg(c)}}(t):function(t){t.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}(t)}}function T(t,a,o,e,i){t[a]=t[a]+t[o]>>>0,t[i]=(t[i]^t[a])>>>0,t[i]=(t[i]<<16|t[i]>>>16&65535)>>>0,t[e]=t[e]+t[i]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<12|t[o]>>>20&4095)>>>0,t[a]=t[a]+t[o]>>>0,t[i]=(t[i]^t[a])>>>0,t[i]=(t[i]<<8|t[i]>>>24&255)>>>0,t[e]=t[e]+t[i]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<7|t[o]>>>25&127)>>>0}class G{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return p(h(this.nextU32(),4294967296),this.nextU32())}nextBool(){return 1==(1&this.nextU32())}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let a=0;a<10;a++)T(t=this.buff,0,4,8,12),T(t,1,5,9,13),T(t,2,6,10,14),T(t,3,7,11,15),T(t,0,5,10,15),T(t,1,6,11,12),T(t,2,7,8,13),T(t,3,4,9,14);var t;for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}function R(t){let a=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(a);else for(let o=0;o<t;o++)a[o]=4294967296*Math.random()>>>0;return a}let N=null;function k(){return N||(N=new G(function(){const t=R(32),a=new Uint32Array(t.buffer),o=[];for(let t=0;t<8;t++)o.push(a[t]);return o}()),N)}class U{constructor(t,a,o){this.F=a,this.G=t,this.opMulGF=o;let e=a.sqrt_t||a.t,i=a.sqrt_s||a.s,n=a.one;for(;a.eq(a.pow(n,a.half),a.one);)n=a.add(n,a.one);this.w=new Array(i+1),this.wi=new Array(i+1),this.w[i]=this.F.pow(n,e),this.wi[i]=this.F.inv(this.w[i]);let c=i-1;for(;c>=0;)this.w[c]=this.F.square(this.w[c+1]),this.wi[c]=this.F.square(this.wi[c+1]),c--;this.roots=[],this._setRoots(Math.min(i,15))}_setRoots(t){for(let a=t;a>=0&&!this.roots[a];a--){let t=this.F.one;const o=1<<a,e=new Array(o);for(let i=0;i<o;i++)e[i]=t,t=this.F.mul(t,this.w[a]);this.roots[a]=e}}fft(t){if(t.length<=1)return t;const a=j(t.length-1)+1;this._setRoots(a);const o=1<<a;if(t.length!=o)throw new Error("Size must be multiple of 2");return Z(this,t,a,0,1)}ifft(t){if(t.length<=1)return t;const a=j(t.length-1)+1;this._setRoots(a);const o=1<<a;if(t.length!=o)throw new Error("Size must be multiple of 2");const e=Z(this,t,a,0,1),i=this.F.inv(this.F.mulScalar(this.F.one,o)),n=new Array(o);for(let t=0;t<o;t++)n[t]=this.opMulGF(e[(o-t)%o],i);return n}}function j(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function Z(t,a,o,e,i){const n=1<<o;if(1==n)return[a[e]];if(2==n)return[t.G.add(a[e],a[e+i]),t.G.sub(a[e],a[e+i])];const c=n>>1,l=Z(t,a,o-1,e,2*i),s=Z(t,a,o-1,e+i,2*i),r=new Array(n);for(let a=0;a<c;a++)r[a]=t.G.add(l[a],t.opMulGF(s[a],t.roots[o][a])),r[a+c]=t.G.sub(l[a],t.opMulGF(s[a],t.roots[o][a]));return r}class ${constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=i(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const a=this.negone>>this.one;this.nqr=this.two;let o=this.pow(this.nqr,a);for(;!this.eq(o,this.negone);)this.nqr=this.nqr+this.one,o=this.pow(this.nqr,a);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),M(this),this.FFT=new U(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,a){let o;if(a?16==a&&(o=BigInt("0x"+t)):o=BigInt(t),o<0){let t=-o;return t>=this.p&&(t%=this.p),this.p-t}return o>=this.p?o%this.p:o}add(t,a){const o=t+a;return o>=this.p?o-this.p:o}sub(t,a){return t>=a?t-a:this.p-a+t}neg(t){return t?this.p-t:t}mul(t,a){return t*a%this.p}mulScalar(t,a){return t*this.e(a)%this.p}square(t){return t*t%this.p}eq(t,a){return t==a}neq(t,a){return t!=a}lt(t,a){return(t>this.half?t-this.p:t)<(a>this.half?a-this.p:a)}gt(t,a){return(t>this.half?t-this.p:t)>(a>this.half?a-this.p:a)}leq(t,a){return(t>this.half?t-this.p:t)<=(a>this.half?a-this.p:a)}geq(t,a){return(t>this.half?t-this.p:t)>=(a>this.half?a-this.p:a)}div(t,a){return this.mul(t,this.inv(a))}idiv(t,a){if(!a)throw new Error("Division by zero");return t/a}inv(t){if(!t)throw new Error("Division by zero");let a=this.zero,o=this.p,e=this.one,i=t%this.p;for(;i;){let t=o/i;[a,e]=[e,a-t*e],[o,i]=[i,o-t*i]}return a<this.zero&&(a+=this.p),a}mod(t,a){return t%a}pow(t,a){return z(this,t,a)}exp(t,a){return z(this,t,a)}band(t,a){const o=t&a&this.mask;return o>=this.p?o-this.p:o}bor(t,a){const o=(t|a)&this.mask;return o>=this.p?o-this.p:o}bxor(t,a){const o=(t^a)&this.mask;return o>=this.p?o-this.p:o}bnot(t){const a=t^this.mask;return a>=this.p?a-this.p:a}shl(t,a){if(Number(a)<this.bitLength){const o=t<<a&this.mask;return o>=this.p?o-this.p:o}{const o=this.p-a;return Number(o)<this.bitLength?t>>o:this.zero}}shr(t,a){if(Number(a)<this.bitLength)return t>>a;{const o=this.p-a;if(Number(o)<this.bitLength){const a=t<<o&this.mask;return a>=this.p?a-this.p:a}return 0}}land(t,a){return t&&a?this.one:this.zero}lor(t,a){return t||a?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let a=this.s,o=this.nqr_to_t,e=this.pow(t,this.t),i=this.pow(t,this.add(this.t,this.one)>>this.one);for(;e!=this.one;){let t=this.square(e),n=1;for(;t!=this.one;)n++,t=this.square(t);let c=o;for(let t=0;t<a-n-1;t++)c=this.square(c);a=n,o=this.square(c),e=this.mul(e,o),i=this.mul(i,c)}return i>this.p>>this.one&&(i=this.neg(i)),i}normalize(t,a){if((t=BigInt(t,a))<0){let a=-t;return a>=this.p&&(a%=this.p),this.p-a}return t>=this.p?t%this.p:t}random(){const t=2*this.bitLength/8;let a=this.zero;for(let o=0;o<t;o++)a=(a<<BigInt(8))+BigInt(R(1)[0]);return a%this.p}toString(t,a){let o;if(a=a||10,t>this.half&&10==a){o="-"+(this.p-t).toString(a)}else o=t.toString(a);return o}isZero(t){return t==this.zero}fromRng(t){let a;do{a=this.zero;for(let o=0;o<this.n64;o++)a+=t.nextU64()<<BigInt(64*o);a&=this.mask}while(a>=this.p);return a=a*this.Ri%this.p,a}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,a,o){B(t,a,o,8*this.n64)}toRprBE(t,a,o){A(t,a,o,8*this.n64)}toRprBEM(t,a,o){return this.toRprBE(t,a,this.mul(this.R,o))}toRprLEM(t,a,o){return this.toRprLE(t,a,this.mul(this.R,o))}fromRprLE(t,a){return P(t,a,this.n8)}fromRprBE(t,a){return v(t,a,this.n8)}fromRprLEM(t,a){return this.mul(this.fromRprLE(t,a),this.Ri)}fromRprBEM(t,a){return this.mul(this.fromRprBE(t,a),this.Ri)}toObject(t){return t}}var W={bigInt2BytesLE:function(t,a){const o=Array(a);let e=BigInt(t);for(let t=0;t<a;t++)o[t]=Number(0xFFn&e),e>>=8n;return o},bigInt2U32LE:function(t,a){const o=Array(a);let e=BigInt(t);for(let t=0;t<a;t++)o[t]=Number(0xFFFFFFFFn&e),e>>=32n;return o},isOcamNum:function(t){return!!Array.isArray(t)&&(3==t.length&&("number"==typeof t[0]&&("number"==typeof t[1]&&!!Array.isArray(t[2]))))}},V=function(t,a,o,e,i,n,c){const l=t.addFunction(a);l.addParam("base","i32"),l.addParam("scalar","i32"),l.addParam("scalarLength","i32"),l.addParam("r","i32"),l.addLocal("i","i32"),l.addLocal("b","i32");const s=l.getCodeBuilder(),r=s.i32_const(t.alloc(o));l.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(c,s.getLocal("r")),...s.ret([])])),l.addCode(s.call(n,s.getLocal("base"),r)),l.addCode(s.call(c,s.getLocal("r"))),l.addCode(s.setLocal("i",s.getLocal("scalarLength"))),l.addCode(s.block(s.loop(s.setLocal("i",s.i32_sub(s.getLocal("i"),s.i32_const(1))),s.setLocal("b",s.i32_load8_u(s.i32_add(s.getLocal("scalar"),s.getLocal("i")))),...function(){const t=[];for(let a=0;a<8;a++)t.push(...s.call(i,s.getLocal("r"),s.getLocal("r")),...s.if(s.i32_ge_u(s.getLocal("b"),s.i32_const(128>>a)),[...s.setLocal("b",s.i32_sub(s.getLocal("b"),s.i32_const(128>>a))),...s.call(e,s.getLocal("r"),r,s.getLocal("r"))]));return t}(),s.br_if(1,s.i32_eqz(s.getLocal("i"))),s.br(0))))},Q=function(t,a){const o=8*t.modules[a].n64,e=t.addFunction(a+"_batchInverse");e.addParam("pIn","i32"),e.addParam("inStep","i32"),e.addParam("n","i32"),e.addParam("pOut","i32"),e.addParam("outStep","i32"),e.addLocal("itAux","i32"),e.addLocal("itIn","i32"),e.addLocal("itOut","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(o));e.addCode(i.setLocal("itAux",i.i32_load(i.i32_const(0))),i.i32_store(i.i32_const(0),i.i32_add(i.getLocal("itAux"),i.i32_mul(i.i32_add(i.getLocal("n"),i.i32_const(1)),i.i32_const(o))))),e.addCode(i.call(a+"_one",i.getLocal("itAux")),i.setLocal("itIn",i.getLocal("pIn")),i.setLocal("itAux",i.i32_add(i.getLocal("itAux"),i.i32_const(o))),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("n"))),i.if(i.call(a+"_isZero",i.getLocal("itIn")),i.call(a+"_copy",i.i32_sub(i.getLocal("itAux"),i.i32_const(o)),i.getLocal("itAux")),i.call(a+"_mul",i.getLocal("itIn"),i.i32_sub(i.getLocal("itAux"),i.i32_const(o)),i.getLocal("itAux"))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.getLocal("inStep"))),i.setLocal("itAux",i.i32_add(i.getLocal("itAux"),i.i32_const(o))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.setLocal("itIn",i.i32_sub(i.getLocal("itIn"),i.getLocal("inStep"))),i.setLocal("itAux",i.i32_sub(i.getLocal("itAux"),i.i32_const(o))),i.setLocal("itOut",i.i32_add(i.getLocal("pOut"),i.i32_mul(i.i32_sub(i.getLocal("n"),i.i32_const(1)),i.getLocal("outStep")))),i.call(a+"_inverse",i.getLocal("itAux"),i.getLocal("itAux")),i.block(i.loop(i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.if(i.call(a+"_isZero",i.getLocal("itIn")),[...i.call(a+"_copy",i.getLocal("itAux"),i.i32_sub(i.getLocal("itAux"),i.i32_const(o))),...i.call(a+"_zero",i.getLocal("itOut"))],[...i.call(a+"_copy",i.i32_sub(i.getLocal("itAux"),i.i32_const(o)),n),...i.call(a+"_mul",i.getLocal("itAux"),i.getLocal("itIn"),i.i32_sub(i.getLocal("itAux"),i.i32_const(o))),...i.call(a+"_mul",i.getLocal("itAux"),n,i.getLocal("itOut"))]),i.setLocal("itIn",i.i32_sub(i.getLocal("itIn"),i.getLocal("inStep"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.getLocal("outStep"))),i.setLocal("itAux",i.i32_sub(i.getLocal("itAux"),i.i32_const(o))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),e.addCode(i.i32_store(i.i32_const(0),i.getLocal("itAux")))};var J=function(t,a,o,e,i,n){void 0===n&&(n=e<i);const c=t.addFunction(a);c.addParam("pIn","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn","i32"),c.addLocal("itOut","i32");const l=c.getCodeBuilder();n?c.addCode(l.setLocal("itIn",l.i32_add(l.getLocal("pIn"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(e)))),l.setLocal("itOut",l.i32_add(l.getLocal("pOut"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(i)))),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(o,l.getLocal("itIn"),l.getLocal("itOut")),l.setLocal("itIn",l.i32_sub(l.getLocal("itIn"),l.i32_const(e))),l.setLocal("itOut",l.i32_sub(l.getLocal("itOut"),l.i32_const(i))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0)))):c.addCode(l.setLocal("itIn",l.getLocal("pIn")),l.setLocal("itOut",l.getLocal("pOut")),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(o,l.getLocal("itIn"),l.getLocal("itOut")),l.setLocal("itIn",l.i32_add(l.getLocal("itIn"),l.i32_const(e))),l.setLocal("itOut",l.i32_add(l.getLocal("itOut"),l.i32_const(i))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))};var D=function(t,a,o,e,i,n){void 0===n&&(n=e<i);const c=t.addFunction(a);c.addParam("pIn1","i32"),c.addParam("pIn2","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn1","i32"),c.addLocal("itIn2","i32"),c.addLocal("itOut","i32");const l=c.getCodeBuilder();n?c.addCode(l.setLocal("itIn1",l.i32_add(l.getLocal("pIn1"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(e)))),l.setLocal("itIn2",l.i32_add(l.getLocal("pIn2"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(e)))),l.setLocal("itOut",l.i32_add(l.getLocal("pOut"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.i32_const(1)),l.i32_const(i)))),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(o,l.getLocal("itIn1"),l.getLocal("itIn2"),l.getLocal("itOut")),l.setLocal("itIn1",l.i32_sub(l.getLocal("itIn1"),l.i32_const(e))),l.setLocal("itIn2",l.i32_sub(l.getLocal("itIn2"),l.i32_const(e))),l.setLocal("itOut",l.i32_sub(l.getLocal("itOut"),l.i32_const(i))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0)))):c.addCode(l.setLocal("itIn1",l.getLocal("pIn1")),l.setLocal("itIn2",l.getLocal("pIn2")),l.setLocal("itOut",l.getLocal("pOut")),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(o,l.getLocal("itIn1"),l.getLocal("itIn2"),l.getLocal("itOut")),l.setLocal("itIn1",l.i32_add(l.getLocal("itIn1"),l.i32_const(e))),l.setLocal("itIn2",l.i32_add(l.getLocal("itIn2"),l.i32_const(e))),l.setLocal("itOut",l.i32_add(l.getLocal("itOut"),l.i32_const(i))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))};var K={};function X(t,a){return t===a?0:t>a?1:-1}function Y(t){return t*t}function H(t){return t%2n!==0n}function tt(t){return t%2n===0n}function at(t){return t<0n}function ot(t){return t>0n}function et(t){return at(t)?t.toString(2).length-1:t.toString(2).length}function it(t){return t<0n?-t:t}function nt(t){return 1n===it(t)}function ct(t,a){for(var o,e,i,n=0n,c=1n,l=a,s=it(t);0n!==s;)o=l/s,e=n,i=l,n=c,l=s,c=e-o*c,s=i-o*s;if(!nt(l))throw new Error(t.toString()+" and "+a.toString()+" are not co-prime");return-1===X(n,0n)&&(n+=a),at(t)?-n:n}function lt(t,a,o){if(0n===o)throw new Error("Cannot take modPow with modulus 0");var e=1n,i=t%o;for(at(a)&&(a*=-1n,i=ct(i,o));ot(a);){if(0n===i)return 0n;H(a)&&(e=e*i%o),a/=2n,i=Y(i)%o}return e}function st(t,a){return 0n!==a&&(!!nt(a)||(0===function(t,a){return(t=t>=0n?t:-t)===(a=a>=0n?a:-a)?0:t>a?1:-1}(a,2n)?tt(t):t%a===0n))}function rt(t,a){for(var o,e,i,n=function(t){return t-1n}(t),c=n,l=0;tt(c);)c/=2n,l++;t:for(e=0;e<a.length;e++)if(!(t<a[e]||nt(i=lt(BigInt(a[e]),c,t))||i===n)){for(o=l-1;0!=o;o--){if(nt(i=Y(i)%t))return!1;if(i===n)continue t}return!1}return!0}K.bitLength=et,K.isOdd=H,K.isNegative=at,K.abs=it,K.isUnit=nt,K.compare=X,K.modInv=ct,K.modPow=lt,K.isPrime=function(t){var a=function(t){var a=it(t);return!nt(a)&&(2n===a||3n===a||5n===a||!(tt(a)||st(a,3n)||st(a,5n))&&(a<49n||void 0))}(t);if(void 0!==a)return a;var o=it(t),e=et(o);if(e<=64)return rt(o,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var i=Math.log(2)*Number(e),n=Math.ceil(i),c=[],l=0;l<n;l++)c.push(BigInt(l+2));return rt(o,c)},K.square=Y;const dt=function(t,a,o){const e=o||"int";if(t.modules[e])return e;t.modules[e]={};const i=2*a,n=8*a;return function(){const o=t.addFunction(e+"_copy");o.addParam("px","i32"),o.addParam("pr","i32");const i=o.getCodeBuilder();for(let t=0;t<a;t++)o.addCode(i.i64_store(i.getLocal("pr"),8*t,i.i64_load(i.getLocal("px"),8*t)))}(),function(){const o=t.addFunction(e+"_zero");o.addParam("pr","i32");const i=o.getCodeBuilder();for(let t=0;t<a;t++)o.addCode(i.i64_store(i.getLocal("pr"),8*t,i.i64_const(0)))}(),function(){const o=t.addFunction(e+"_isZero");o.addParam("px","i32"),o.setReturnType("i32");const i=o.getCodeBuilder();o.addCode(function t(a){return 0==a?i.ret(i.i64_eqz(i.i64_load(i.getLocal("px")))):i.if(i.i64_eqz(i.i64_load(i.getLocal("px"),8*a)),t(a-1),i.ret(i.i32_const(0)))}(a-1)),o.addCode(i.ret(i.i32_const(0)))}(),function(){const o=t.addFunction(e+"_one");o.addParam("pr","i32");const i=o.getCodeBuilder();o.addCode(i.i64_store(i.getLocal("pr"),0,i.i64_const(1)));for(let t=1;t<a;t++)o.addCode(i.i64_store(i.getLocal("pr"),8*t,i.i64_const(0)))}(),function(){const o=t.addFunction(e+"_eq");o.addParam("px","i32"),o.addParam("py","i32"),o.setReturnType("i32");const i=o.getCodeBuilder();o.addCode(function t(a){return 0==a?i.ret(i.i64_eq(i.i64_load(i.getLocal("px")),i.i64_load(i.getLocal("py")))):i.if(i.i64_eq(i.i64_load(i.getLocal("px"),8*a),i.i64_load(i.getLocal("py"),8*a)),t(a-1),i.ret(i.i32_const(0)))}(a-1)),o.addCode(i.ret(i.i32_const(0)))}(),function(){const o=t.addFunction(e+"_gte");o.addParam("px","i32"),o.addParam("py","i32"),o.setReturnType("i32");const i=o.getCodeBuilder();o.addCode(function t(a){return 0==a?i.ret(i.i64_ge_u(i.i64_load(i.getLocal("px")),i.i64_load(i.getLocal("py")))):i.if(i.i64_lt_u(i.i64_load(i.getLocal("px"),8*a),i.i64_load(i.getLocal("py"),8*a)),i.ret(i.i32_const(0)),i.if(i.i64_gt_u(i.i64_load(i.getLocal("px"),8*a),i.i64_load(i.getLocal("py"),8*a)),i.ret(i.i32_const(1)),t(a-1)))}(a-1)),o.addCode(i.ret(i.i32_const(0)))}(),function(){const a=t.addFunction(e+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.setReturnType("i32"),a.addLocal("c","i64");const o=a.getCodeBuilder();a.addCode(o.setLocal("c",o.i64_add(o.i64_load32_u(o.getLocal("x")),o.i64_load32_u(o.getLocal("y"))))),a.addCode(o.i64_store32(o.getLocal("r"),o.getLocal("c")));for(let t=1;t<i;t++)a.addCode(o.setLocal("c",o.i64_add(o.i64_add(o.i64_load32_u(o.getLocal("x"),4*t),o.i64_load32_u(o.getLocal("y"),4*t)),o.i64_shr_u(o.getLocal("c"),o.i64_const(32))))),a.addCode(o.i64_store32(o.getLocal("r"),4*t,o.getLocal("c")));a.addCode(o.i32_wrap_i64(o.i64_shr_u(o.getLocal("c"),o.i64_const(32))))}(),function(){const a=t.addFunction(e+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.setReturnType("i32"),a.addLocal("c","i64");const o=a.getCodeBuilder();a.addCode(o.setLocal("c",o.i64_sub(o.i64_load32_u(o.getLocal("x")),o.i64_load32_u(o.getLocal("y"))))),a.addCode(o.i64_store32(o.getLocal("r"),o.i64_and(o.getLocal("c"),o.i64_const("0xFFFFFFFF"))));for(let t=1;t<i;t++)a.addCode(o.setLocal("c",o.i64_add(o.i64_sub(o.i64_load32_u(o.getLocal("x"),4*t),o.i64_load32_u(o.getLocal("y"),4*t)),o.i64_shr_s(o.getLocal("c"),o.i64_const(32))))),a.addCode(o.i64_store32(o.getLocal("r"),4*t,o.i64_and(o.getLocal("c"),o.i64_const("0xFFFFFFFF"))));a.addCode(o.i32_wrap_i64(o.i64_shr_s(o.getLocal("c"),o.i64_const(32))))}(),function(){const a=t.addFunction(e+"_mul");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64");for(let t=0;t<i;t++)a.addLocal("x"+t,"i64"),a.addLocal("y"+t,"i64");const o=a.getCodeBuilder(),n=[],c=[];function l(t,a){let e,i;return n[t]?e=o.getLocal("x"+t):(e=o.teeLocal("x"+t,o.i64_load32_u(o.getLocal("x"),4*t)),n[t]=!0),c[a]?i=o.getLocal("y"+a):(i=o.teeLocal("y"+a,o.i64_load32_u(o.getLocal("y"),4*a)),c[a]=!0),o.i64_mul(e,i)}let s="c0",r="c1";for(let t=0;t<2*i-1;t++){for(let e=Math.max(0,t-i+1);e<=t&&e<i;e++){const i=t-e;a.addCode(o.setLocal(s,o.i64_add(o.i64_and(o.getLocal(s),o.i64_const(4294967295)),l(e,i)))),a.addCode(o.setLocal(r,o.i64_add(o.getLocal(r),o.i64_shr_u(o.getLocal(s),o.i64_const(32)))))}a.addCode(o.i64_store32(o.getLocal("r"),4*t,o.getLocal(s))),[s,r]=[r,s],a.addCode(o.setLocal(r,o.i64_shr_u(o.getLocal(s),o.i64_const(32))))}a.addCode(o.i64_store32(o.getLocal("r"),4*i*2-4,o.getLocal(s)))}(),function(){const a=t.addFunction(e+"_square");a.addParam("x","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64"),a.addLocal("c0_old","i64"),a.addLocal("c1_old","i64");for(let t=0;t<i;t++)a.addLocal("x"+t,"i64");const o=a.getCodeBuilder(),n=[];function c(t,a){let e,i;return n[t]?e=o.getLocal("x"+t):(e=o.teeLocal("x"+t,o.i64_load32_u(o.getLocal("x"),4*t)),n[t]=!0),n[a]?i=o.getLocal("x"+a):(i=o.teeLocal("x"+a,o.i64_load32_u(o.getLocal("x"),4*a)),n[a]=!0),o.i64_mul(e,i)}let l="c0",s="c1",r="c0_old",d="c1_old";for(let t=0;t<2*i-1;t++){a.addCode(o.setLocal(l,o.i64_const(0)),o.setLocal(s,o.i64_const(0)));for(let e=Math.max(0,t-i+1);e<t+1>>1&&e<i;e++){const i=t-e;a.addCode(o.setLocal(l,o.i64_add(o.i64_and(o.getLocal(l),o.i64_const(4294967295)),c(e,i)))),a.addCode(o.setLocal(s,o.i64_add(o.getLocal(s),o.i64_shr_u(o.getLocal(l),o.i64_const(32)))))}a.addCode(o.setLocal(l,o.i64_shl(o.i64_and(o.getLocal(l),o.i64_const(4294967295)),o.i64_const(1)))),a.addCode(o.setLocal(s,o.i64_add(o.i64_shl(o.getLocal(s),o.i64_const(1)),o.i64_shr_u(o.getLocal(l),o.i64_const(32))))),t%2==0&&(a.addCode(o.setLocal(l,o.i64_add(o.i64_and(o.getLocal(l),o.i64_const(4294967295)),c(t>>1,t>>1)))),a.addCode(o.setLocal(s,o.i64_add(o.getLocal(s),o.i64_shr_u(o.getLocal(l),o.i64_const(32)))))),t>0&&(a.addCode(o.setLocal(l,o.i64_add(o.i64_and(o.getLocal(l),o.i64_const(4294967295)),o.i64_and(o.getLocal(r),o.i64_const(4294967295))))),a.addCode(o.setLocal(s,o.i64_add(o.i64_add(o.getLocal(s),o.i64_shr_u(o.getLocal(l),o.i64_const(32))),o.getLocal(d))))),a.addCode(o.i64_store32(o.getLocal("r"),4*t,o.getLocal(l))),a.addCode(o.setLocal(r,o.getLocal(s)),o.setLocal(d,o.i64_shr_u(o.getLocal(r),o.i64_const(32))))}a.addCode(o.i64_store32(o.getLocal("r"),4*i*2-4,o.getLocal(r)))}(),function(){const a=t.addFunction(e+"_squareOld");a.addParam("x","i32"),a.addParam("r","i32");const o=a.getCodeBuilder();a.addCode(o.call(e+"_mul",o.getLocal("x"),o.getLocal("x"),o.getLocal("r")))}(),function(){!function(){const a=t.addFunction(e+"__mul1");a.addParam("px","i32"),a.addParam("y","i64"),a.addParam("pr","i32"),a.addLocal("c","i64");const o=a.getCodeBuilder();a.addCode(o.setLocal("c",o.i64_mul(o.i64_load32_u(o.getLocal("px"),0,0),o.getLocal("y")))),a.addCode(o.i64_store32(o.getLocal("pr"),0,0,o.getLocal("c")));for(let t=1;t<i;t++)a.addCode(o.setLocal("c",o.i64_add(o.i64_mul(o.i64_load32_u(o.getLocal("px"),4*t,0),o.getLocal("y")),o.i64_shr_u(o.getLocal("c"),o.i64_const(32))))),a.addCode(o.i64_store32(o.getLocal("pr"),4*t,0,o.getLocal("c")))}(),function(){const a=t.addFunction(e+"__add1");a.addParam("x","i32"),a.addParam("y","i64"),a.addLocal("c","i64"),a.addLocal("px","i32");const o=a.getCodeBuilder();a.addCode(o.setLocal("px",o.getLocal("x"))),a.addCode(o.setLocal("c",o.i64_add(o.i64_load32_u(o.getLocal("px"),0,0),o.getLocal("y")))),a.addCode(o.i64_store32(o.getLocal("px"),0,0,o.getLocal("c"))),a.addCode(o.setLocal("c",o.i64_shr_u(o.getLocal("c"),o.i64_const(32)))),a.addCode(o.block(o.loop(o.br_if(1,o.i64_eqz(o.getLocal("c"))),o.setLocal("px",o.i32_add(o.getLocal("px"),o.i32_const(4))),o.setLocal("c",o.i64_add(o.i64_load32_u(o.getLocal("px"),0,0),o.getLocal("c"))),o.i64_store32(o.getLocal("px"),0,0,o.getLocal("c")),o.setLocal("c",o.i64_shr_u(o.getLocal("c"),o.i64_const(32))),o.br(0))))}();const a=t.addFunction(e+"_div");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("c","i32"),a.addParam("r","i32"),a.addLocal("rr","i32"),a.addLocal("cc","i32"),a.addLocal("eX","i32"),a.addLocal("eY","i32"),a.addLocal("sy","i64"),a.addLocal("sx","i64"),a.addLocal("ec","i32");const o=a.getCodeBuilder(),c=o.i32_const(t.alloc(n)),l=o.i32_const(t.alloc(n)),s=o.i32_const(t.alloc(n)),r=o.getLocal("cc"),d=o.getLocal("rr"),_=t.alloc(2*n),u=o.i32_const(_),g=o.i32_const(_+n);a.addCode(o.if(o.getLocal("c"),o.setLocal("cc",o.getLocal("c")),o.setLocal("cc",l))),a.addCode(o.if(o.getLocal("r"),o.setLocal("rr",o.getLocal("r")),o.setLocal("rr",s))),a.addCode(o.call(e+"_copy",o.getLocal("x"),d)),a.addCode(o.call(e+"_copy",o.getLocal("y"),c)),a.addCode(o.call(e+"_zero",r)),a.addCode(o.call(e+"_zero",u)),a.addCode(o.setLocal("eX",o.i32_const(n-1))),a.addCode(o.setLocal("eY",o.i32_const(n-1))),a.addCode(o.block(o.loop(o.br_if(1,o.i32_or(o.i32_load8_u(o.i32_add(c,o.getLocal("eY")),0,0),o.i32_eq(o.getLocal("eY"),o.i32_const(3)))),o.setLocal("eY",o.i32_sub(o.getLocal("eY"),o.i32_const(1))),o.br(0)))),a.addCode(o.setLocal("sy",o.i64_add(o.i64_load32_u(o.i32_sub(o.i32_add(c,o.getLocal("eY")),o.i32_const(3)),0,0),o.i64_const(1)))),a.addCode(o.if(o.i64_eq(o.getLocal("sy"),o.i64_const(1)),o.drop(o.i64_div_u(o.i64_const(0),o.i64_const(0))))),a.addCode(o.block(o.loop(o.block(o.loop(o.br_if(1,o.i32_or(o.i32_load8_u(o.i32_add(d,o.getLocal("eX")),0,0),o.i32_eq(o.getLocal("eX"),o.i32_const(7)))),o.setLocal("eX",o.i32_sub(o.getLocal("eX"),o.i32_const(1))),o.br(0))),o.setLocal("sx",o.i64_load(o.i32_sub(o.i32_add(d,o.getLocal("eX")),o.i32_const(7)),0,0)),o.setLocal("sx",o.i64_div_u(o.getLocal("sx"),o.getLocal("sy"))),o.setLocal("ec",o.i32_sub(o.i32_sub(o.getLocal("eX"),o.getLocal("eY")),o.i32_const(4))),o.block(o.loop(o.br_if(1,o.i32_and(o.i64_eqz(o.i64_and(o.getLocal("sx"),o.i64_const("0xFFFFFFFF00000000"))),o.i32_ge_s(o.getLocal("ec"),o.i32_const(0)))),o.setLocal("sx",o.i64_shr_u(o.getLocal("sx"),o.i64_const(8))),o.setLocal("ec",o.i32_add(o.getLocal("ec"),o.i32_const(1))),o.br(0))),o.if(o.i64_eqz(o.getLocal("sx")),[...o.br_if(2,o.i32_eqz(o.call(e+"_gte",d,c))),...o.setLocal("sx",o.i64_const(1)),...o.setLocal("ec",o.i32_const(0))]),o.call(e+"__mul1",c,o.getLocal("sx"),g),o.drop(o.call(e+"_sub",d,o.i32_sub(g,o.getLocal("ec")),d)),o.call(e+"__add1",o.i32_add(r,o.getLocal("ec")),o.getLocal("sx")),o.br(0))))}(),function(){const a=t.addFunction(e+"_inverseMod");a.addParam("px","i32"),a.addParam("pm","i32"),a.addParam("pr","i32"),a.addLocal("t","i32"),a.addLocal("newt","i32"),a.addLocal("r","i32"),a.addLocal("qq","i32"),a.addLocal("qr","i32"),a.addLocal("newr","i32"),a.addLocal("swp","i32"),a.addLocal("x","i32"),a.addLocal("signt","i32"),a.addLocal("signnewt","i32"),a.addLocal("signx","i32");const o=a.getCodeBuilder(),i=o.i32_const(t.alloc(n)),c=o.i32_const(t.alloc(n)),l=o.i32_const(t.alloc(n)),s=o.i32_const(t.alloc(n)),r=o.i32_const(t.alloc(n)),d=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(2*n)),u=o.i32_const(t.alloc(n));a.addCode(o.setLocal("t",i),o.call(e+"_zero",i),o.setLocal("signt",o.i32_const(0))),a.addCode(o.setLocal("r",c),o.call(e+"_copy",o.getLocal("pm"),c)),a.addCode(o.setLocal("newt",l),o.call(e+"_one",l),o.setLocal("signnewt",o.i32_const(0))),a.addCode(o.setLocal("newr",s),o.call(e+"_copy",o.getLocal("px"),s)),a.addCode(o.setLocal("qq",r)),a.addCode(o.setLocal("qr",d)),a.addCode(o.setLocal("x",u)),a.addCode(o.block(o.loop(o.br_if(1,o.call(e+"_isZero",o.getLocal("newr"))),o.call(e+"_div",o.getLocal("r"),o.getLocal("newr"),o.getLocal("qq"),o.getLocal("qr")),o.call(e+"_mul",o.getLocal("qq"),o.getLocal("newt"),_),o.if(o.getLocal("signt"),o.if(o.getLocal("signnewt"),o.if(o.call(e+"_gte",_,o.getLocal("t")),[...o.drop(o.call(e+"_sub",_,o.getLocal("t"),o.getLocal("x"))),...o.setLocal("signx",o.i32_const(0))],[...o.drop(o.call(e+"_sub",o.getLocal("t"),_,o.getLocal("x"))),...o.setLocal("signx",o.i32_const(1))]),[...o.drop(o.call(e+"_add",_,o.getLocal("t"),o.getLocal("x"))),...o.setLocal("signx",o.i32_const(1))]),o.if(o.getLocal("signnewt"),[...o.drop(o.call(e+"_add",_,o.getLocal("t"),o.getLocal("x"))),...o.setLocal("signx",o.i32_const(0))],o.if(o.call(e+"_gte",o.getLocal("t"),_),[...o.drop(o.call(e+"_sub",o.getLocal("t"),_,o.getLocal("x"))),...o.setLocal("signx",o.i32_const(0))],[...o.drop(o.call(e+"_sub",_,o.getLocal("t"),o.getLocal("x"))),...o.setLocal("signx",o.i32_const(1))]))),o.setLocal("swp",o.getLocal("t")),o.setLocal("t",o.getLocal("newt")),o.setLocal("newt",o.getLocal("x")),o.setLocal("x",o.getLocal("swp")),o.setLocal("signt",o.getLocal("signnewt")),o.setLocal("signnewt",o.getLocal("signx")),o.setLocal("swp",o.getLocal("r")),o.setLocal("r",o.getLocal("newr")),o.setLocal("newr",o.getLocal("qr")),o.setLocal("qr",o.getLocal("swp")),o.br(0)))),a.addCode(o.if(o.getLocal("signt"),o.drop(o.call(e+"_sub",o.getLocal("pm"),o.getLocal("t"),o.getLocal("pr"))),o.call(e+"_copy",o.getLocal("t"),o.getLocal("pr"))))}(),t.exportFunction(e+"_copy"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_one"),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_gte"),t.exportFunction(e+"_add"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_mul"),t.exportFunction(e+"_square"),t.exportFunction(e+"_squareOld"),t.exportFunction(e+"_div"),t.exportFunction(e+"_inverseMod"),e},_t=W,ut=V,gt=Q,pt=J,ft=D,{bitLength:Lt,modInv:ht,modPow:mt,isPrime:bt,isOdd:yt,square:xt}=K;var Ft=function(t,a,o,e){const i=BigInt(a),n=Math.floor((Lt(i-1n)-1)/64)+1,c=2*n,l=8*n,s=o||"f1m";if(t.modules[s])return s;const r=dt(t,n,e),d=t.alloc(l,_t.bigInt2BytesLE(i,l)),_=t.alloc(_t.bigInt2BytesLE(xt(1n<<BigInt(64*n))%i,l)),u=t.alloc(_t.bigInt2BytesLE((1n<<BigInt(64*n))%i,l)),g=t.alloc(_t.bigInt2BytesLE(0n,l)),p=i-1n,f=p>>1n,L=t.alloc(l,_t.bigInt2BytesLE(f,l)),h=f+1n,m=t.alloc(l,_t.bigInt2BytesLE(h,l));t.modules[s]={pq:d,pR2:_,n64:n,q:i,pOne:u,pZero:g,pePlusOne:m};let b=2n;if(bt(i))for(;mt(b,f,i)!==p;)b+=1n;let y=0,x=p;for(;!yt(x)&&0n!==x;)y++,x>>=1n;const F=t.alloc(l,_t.bigInt2BytesLE(x,l)),C=mt(b,x,i),w=t.alloc(_t.bigInt2BytesLE((C<<BigInt(64*n))%i,l)),B=x+1n>>1n,A=t.alloc(l,_t.bigInt2BytesLE(B,l));return t.exportFunction(r+"_copy",s+"_copy"),t.exportFunction(r+"_zero",s+"_zero"),t.exportFunction(r+"_isZero",s+"_isZero"),t.exportFunction(r+"_eq",s+"_eq"),function(){const a=t.addFunction(s+"_isOne");a.addParam("x","i32"),a.setReturnType("i32");const o=a.getCodeBuilder();a.addCode(o.ret(o.call(r+"_eq",o.getLocal("x"),o.i32_const(u))))}(),function(){const a=t.addFunction(s+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const o=a.getCodeBuilder();a.addCode(o.if(o.call(r+"_add",o.getLocal("x"),o.getLocal("y"),o.getLocal("r")),o.drop(o.call(r+"_sub",o.getLocal("r"),o.i32_const(d),o.getLocal("r"))),o.if(o.call(r+"_gte",o.getLocal("r"),o.i32_const(d)),o.drop(o.call(r+"_sub",o.getLocal("r"),o.i32_const(d),o.getLocal("r"))))))}(),function(){const a=t.addFunction(s+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const o=a.getCodeBuilder();a.addCode(o.if(o.call(r+"_sub",o.getLocal("x"),o.getLocal("y"),o.getLocal("r")),o.drop(o.call(r+"_add",o.getLocal("r"),o.i32_const(d),o.getLocal("r")))))}(),function(){const a=t.addFunction(s+"_neg");a.addParam("x","i32"),a.addParam("r","i32");const o=a.getCodeBuilder();a.addCode(o.call(s+"_sub",o.i32_const(g),o.getLocal("x"),o.getLocal("r")))}(),function(){const a=t.alloc(c*c*8),o=t.addFunction(s+"_mReduct");o.addParam("t","i32"),o.addParam("r","i32"),o.addLocal("np32","i64"),o.addLocal("c","i64"),o.addLocal("m","i64");const e=o.getCodeBuilder(),n=Number(0x100000000n-ht(i,0x100000000n));o.addCode(e.setLocal("np32",e.i64_const(n)));for(let t=0;t<c;t++){o.addCode(e.setLocal("c",e.i64_const(0))),o.addCode(e.setLocal("m",e.i64_and(e.i64_mul(e.i64_load32_u(e.getLocal("t"),4*t),e.getLocal("np32")),e.i64_const("0xFFFFFFFF"))));for(let a=0;a<c;a++)o.addCode(e.setLocal("c",e.i64_add(e.i64_add(e.i64_load32_u(e.getLocal("t"),4*(t+a)),e.i64_shr_u(e.getLocal("c"),e.i64_const(32))),e.i64_mul(e.i64_load32_u(e.i32_const(d),4*a),e.getLocal("m"))))),o.addCode(e.i64_store32(e.getLocal("t"),4*(t+a),e.getLocal("c")));o.addCode(e.i64_store32(e.i32_const(a),4*t,e.i64_shr_u(e.getLocal("c"),e.i64_const(32))))}o.addCode(e.call(s+"_add",e.i32_const(a),e.i32_add(e.getLocal("t"),e.i32_const(4*c)),e.getLocal("r")))}(),function(){const a=t.addFunction(s+"_mul");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64"),a.addLocal("np32","i64");for(let t=0;t<c;t++)a.addLocal("x"+t,"i64"),a.addLocal("y"+t,"i64"),a.addLocal("m"+t,"i64"),a.addLocal("q"+t,"i64");const o=a.getCodeBuilder(),e=Number(0x100000000n-ht(i,0x100000000n));a.addCode(o.setLocal("np32",o.i64_const(e)));const n=[],l=[],_=[];function u(t,a){let e,i;return n[t]?e=o.getLocal("x"+t):(e=o.teeLocal("x"+t,o.i64_load32_u(o.getLocal("x"),4*t)),n[t]=!0),l[a]?i=o.getLocal("y"+a):(i=o.teeLocal("y"+a,o.i64_load32_u(o.getLocal("y"),4*a)),l[a]=!0),o.i64_mul(e,i)}function g(t,a){let e,i;return _[t]?e=o.getLocal("q"+t):(e=o.teeLocal("q"+t,o.i64_load32_u(o.i32_const(0),d+4*t)),_[t]=!0),i=o.getLocal("m"+a),o.i64_mul(e,i)}let p="c0",f="c1";for(let t=0;t<2*c-1;t++){for(let e=Math.max(0,t-c+1);e<=t&&e<c;e++){const i=t-e;a.addCode(o.setLocal(p,o.i64_add(o.i64_and(o.getLocal(p),o.i64_const(4294967295)),u(e,i)))),a.addCode(o.setLocal(f,o.i64_add(o.getLocal(f),o.i64_shr_u(o.getLocal(p),o.i64_const(32)))))}for(let e=Math.max(1,t-c+1);e<=t&&e<c;e++){const i=t-e;a.addCode(o.setLocal(p,o.i64_add(o.i64_and(o.getLocal(p),o.i64_const(4294967295)),g(e,i)))),a.addCode(o.setLocal(f,o.i64_add(o.getLocal(f),o.i64_shr_u(o.getLocal(p),o.i64_const(32)))))}t<c&&(a.addCode(o.setLocal("m"+t,o.i64_and(o.i64_mul(o.i64_and(o.getLocal(p),o.i64_const(4294967295)),o.getLocal("np32")),o.i64_const("0xFFFFFFFF")))),a.addCode(o.setLocal(p,o.i64_add(o.i64_and(o.getLocal(p),o.i64_const(4294967295)),g(0,t)))),a.addCode(o.setLocal(f,o.i64_add(o.getLocal(f),o.i64_shr_u(o.getLocal(p),o.i64_const(32)))))),t>=c&&a.addCode(o.i64_store32(o.getLocal("r"),4*(t-c),o.getLocal(p))),[p,f]=[f,p],a.addCode(o.setLocal(f,o.i64_shr_u(o.getLocal(p),o.i64_const(32))))}a.addCode(o.i64_store32(o.getLocal("r"),4*c-4,o.getLocal(p))),a.addCode(o.if(o.i32_wrap_i64(o.getLocal(f)),o.drop(o.call(r+"_sub",o.getLocal("r"),o.i32_const(d),o.getLocal("r"))),o.if(o.call(r+"_gte",o.getLocal("r"),o.i32_const(d)),o.drop(o.call(r+"_sub",o.getLocal("r"),o.i32_const(d),o.getLocal("r"))))))}(),function(){const a=t.addFunction(s+"_square");a.addParam("x","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64"),a.addLocal("c0_old","i64"),a.addLocal("c1_old","i64"),a.addLocal("np32","i64");for(let t=0;t<c;t++)a.addLocal("x"+t,"i64"),a.addLocal("m"+t,"i64"),a.addLocal("q"+t,"i64");const o=a.getCodeBuilder(),e=Number(0x100000000n-ht(i,0x100000000n));a.addCode(o.setLocal("np32",o.i64_const(e)));const n=[],l=[];function _(t,a){let e,i;return n[t]?e=o.getLocal("x"+t):(e=o.teeLocal("x"+t,o.i64_load32_u(o.getLocal("x"),4*t)),n[t]=!0),n[a]?i=o.getLocal("x"+a):(i=o.teeLocal("x"+a,o.i64_load32_u(o.getLocal("x"),4*a)),n[a]=!0),o.i64_mul(e,i)}function u(t,a){let e,i;return l[t]?e=o.getLocal("q"+t):(e=o.teeLocal("q"+t,o.i64_load32_u(o.i32_const(0),d+4*t)),l[t]=!0),i=o.getLocal("m"+a),o.i64_mul(e,i)}let g="c0",p="c1",f="c0_old",L="c1_old";for(let t=0;t<2*c-1;t++){a.addCode(o.setLocal(g,o.i64_const(0)),o.setLocal(p,o.i64_const(0)));for(let e=Math.max(0,t-c+1);e<t+1>>1&&e<c;e++){const i=t-e;a.addCode(o.setLocal(g,o.i64_add(o.i64_and(o.getLocal(g),o.i64_const(4294967295)),_(e,i)))),a.addCode(o.setLocal(p,o.i64_add(o.getLocal(p),o.i64_shr_u(o.getLocal(g),o.i64_const(32)))))}a.addCode(o.setLocal(g,o.i64_shl(o.i64_and(o.getLocal(g),o.i64_const(4294967295)),o.i64_const(1)))),a.addCode(o.setLocal(p,o.i64_add(o.i64_shl(o.getLocal(p),o.i64_const(1)),o.i64_shr_u(o.getLocal(g),o.i64_const(32))))),t%2==0&&(a.addCode(o.setLocal(g,o.i64_add(o.i64_and(o.getLocal(g),o.i64_const(4294967295)),_(t>>1,t>>1)))),a.addCode(o.setLocal(p,o.i64_add(o.getLocal(p),o.i64_shr_u(o.getLocal(g),o.i64_const(32)))))),t>0&&(a.addCode(o.setLocal(g,o.i64_add(o.i64_and(o.getLocal(g),o.i64_const(4294967295)),o.i64_and(o.getLocal(f),o.i64_const(4294967295))))),a.addCode(o.setLocal(p,o.i64_add(o.i64_add(o.getLocal(p),o.i64_shr_u(o.getLocal(g),o.i64_const(32))),o.getLocal(L)))));for(let e=Math.max(1,t-c+1);e<=t&&e<c;e++){const i=t-e;a.addCode(o.setLocal(g,o.i64_add(o.i64_and(o.getLocal(g),o.i64_const(4294967295)),u(e,i)))),a.addCode(o.setLocal(p,o.i64_add(o.getLocal(p),o.i64_shr_u(o.getLocal(g),o.i64_const(32)))))}t<c&&(a.addCode(o.setLocal("m"+t,o.i64_and(o.i64_mul(o.i64_and(o.getLocal(g),o.i64_const(4294967295)),o.getLocal("np32")),o.i64_const("0xFFFFFFFF")))),a.addCode(o.setLocal(g,o.i64_add(o.i64_and(o.getLocal(g),o.i64_const(4294967295)),u(0,t)))),a.addCode(o.setLocal(p,o.i64_add(o.getLocal(p),o.i64_shr_u(o.getLocal(g),o.i64_const(32)))))),t>=c&&a.addCode(o.i64_store32(o.getLocal("r"),4*(t-c),o.getLocal(g))),a.addCode(o.setLocal(f,o.getLocal(p)),o.setLocal(L,o.i64_shr_u(o.getLocal(f),o.i64_const(32))))}a.addCode(o.i64_store32(o.getLocal("r"),4*c-4,o.getLocal(f))),a.addCode(o.if(o.i32_wrap_i64(o.getLocal(L)),o.drop(o.call(r+"_sub",o.getLocal("r"),o.i32_const(d),o.getLocal("r"))),o.if(o.call(r+"_gte",o.getLocal("r"),o.i32_const(d)),o.drop(o.call(r+"_sub",o.getLocal("r"),o.i32_const(d),o.getLocal("r"))))))}(),function(){const a=t.addFunction(s+"_squareOld");a.addParam("x","i32"),a.addParam("r","i32");const o=a.getCodeBuilder();a.addCode(o.call(s+"_mul",o.getLocal("x"),o.getLocal("x"),o.getLocal("r")))}(),function(){const a=t.addFunction(s+"_toMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const o=a.getCodeBuilder();a.addCode(o.call(s+"_mul",o.getLocal("x"),o.i32_const(_),o.getLocal("r")))}(),function(){const a=t.alloc(2*l),o=t.addFunction(s+"_fromMontgomery");o.addParam("x","i32"),o.addParam("r","i32");const e=o.getCodeBuilder();o.addCode(e.call(r+"_copy",e.getLocal("x"),e.i32_const(a))),o.addCode(e.call(r+"_zero",e.i32_const(a+l))),o.addCode(e.call(s+"_mReduct",e.i32_const(a),e.getLocal("r")))}(),function(){const a=t.addFunction(s+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");const o=a.getCodeBuilder(),e=o.i32_const(t.alloc(l));a.addCode(o.call(s+"_fromMontgomery",o.getLocal("x"),e),o.call(r+"_gte",e,o.i32_const(m)))}(),function(){const a=t.addFunction(s+"_sign");a.addParam("x","i32"),a.setReturnType("i32");const o=a.getCodeBuilder(),e=o.i32_const(t.alloc(l));a.addCode(o.if(o.call(r+"_isZero",o.getLocal("x")),o.ret(o.i32_const(0))),o.call(s+"_fromMontgomery",o.getLocal("x"),e),o.if(o.call(r+"_gte",e,o.i32_const(m)),o.ret(o.i32_const(-1))),o.ret(o.i32_const(1)))}(),function(){const a=t.addFunction(s+"_inverse");a.addParam("x","i32"),a.addParam("r","i32");const o=a.getCodeBuilder();a.addCode(o.call(s+"_fromMontgomery",o.getLocal("x"),o.getLocal("r"))),a.addCode(o.call(r+"_inverseMod",o.getLocal("r"),o.i32_const(d),o.getLocal("r"))),a.addCode(o.call(s+"_toMontgomery",o.getLocal("r"),o.getLocal("r")))}(),function(){const a=t.addFunction(s+"_one");a.addParam("pr","i32");const o=a.getCodeBuilder();a.addCode(o.call(r+"_copy",o.i32_const(u),o.getLocal("pr")))}(),function(){const a=t.addFunction(s+"_load");a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32"),a.addLocal("p","i32"),a.addLocal("l","i32"),a.addLocal("i","i32"),a.addLocal("j","i32");const o=a.getCodeBuilder(),e=o.i32_const(t.alloc(l)),i=t.alloc(l),n=o.i32_const(i);a.addCode(o.call(r+"_zero",o.getLocal("r")),o.setLocal("i",o.i32_const(l)),o.setLocal("p",o.getLocal("scalar")),o.block(o.loop(o.br_if(1,o.i32_gt_u(o.getLocal("i"),o.getLocal("scalarLen"))),o.if(o.i32_eq(o.getLocal("i"),o.i32_const(l)),o.call(s+"_one",e),o.call(s+"_mul",e,o.i32_const(_),e)),o.call(s+"_mul",o.getLocal("p"),e,n),o.call(s+"_add",o.getLocal("r"),n,o.getLocal("r")),o.setLocal("p",o.i32_add(o.getLocal("p"),o.i32_const(l))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(l))),o.br(0))),o.setLocal("l",o.i32_rem_u(o.getLocal("scalarLen"),o.i32_const(l))),o.if(o.i32_eqz(o.getLocal("l")),o.ret([])),o.call(r+"_zero",n),o.setLocal("j",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("l"))),o.i32_store8(o.getLocal("j"),i,o.i32_load8_u(o.getLocal("p"))),o.setLocal("p",o.i32_add(o.getLocal("p"),o.i32_const(1))),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0))),o.if(o.i32_eq(o.getLocal("i"),o.i32_const(l)),o.call(s+"_one",e),o.call(s+"_mul",e,o.i32_const(_),e)),o.call(s+"_mul",n,e,n),o.call(s+"_add",o.getLocal("r"),n,o.getLocal("r")))}(),function(){const a=t.addFunction(s+"_timesScalar");a.addParam("x","i32"),a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32");const o=a.getCodeBuilder(),e=o.i32_const(t.alloc(l));a.addCode(o.call(s+"_load",o.getLocal("scalar"),o.getLocal("scalarLen"),e),o.call(s+"_toMontgomery",e,e),o.call(s+"_mul",o.getLocal("x"),e,o.getLocal("r")))}(),gt(t,s),pt(t,s+"_batchToMontgomery",s+"_toMontgomery",l,l),pt(t,s+"_batchFromMontgomery",s+"_fromMontgomery",l,l),pt(t,s+"_batchNeg",s+"_neg",l,l),ft(t,s+"_batchAdd",s+"_add",l,l),ft(t,s+"_batchSub",s+"_sub",l,l),ft(t,s+"_batchMul",s+"_mul",l,l),t.exportFunction(s+"_add"),t.exportFunction(s+"_sub"),t.exportFunction(s+"_neg"),t.exportFunction(s+"_isNegative"),t.exportFunction(s+"_isOne"),t.exportFunction(s+"_sign"),t.exportFunction(s+"_mReduct"),t.exportFunction(s+"_mul"),t.exportFunction(s+"_square"),t.exportFunction(s+"_squareOld"),t.exportFunction(s+"_fromMontgomery"),t.exportFunction(s+"_toMontgomery"),t.exportFunction(s+"_inverse"),t.exportFunction(s+"_one"),t.exportFunction(s+"_load"),t.exportFunction(s+"_timesScalar"),ut(t,s+"_exp",l,s+"_mul",s+"_square",r+"_copy",s+"_one"),t.exportFunction(s+"_exp"),t.exportFunction(s+"_batchInverse"),bt(i)&&(!function(){const a=t.addFunction(s+"_sqrt");a.addParam("n","i32"),a.addParam("r","i32"),a.addLocal("m","i32"),a.addLocal("i","i32"),a.addLocal("j","i32");const o=a.getCodeBuilder(),e=o.i32_const(u),i=o.i32_const(t.alloc(l)),n=o.i32_const(t.alloc(l)),c=o.i32_const(t.alloc(l)),r=o.i32_const(t.alloc(l)),d=o.i32_const(t.alloc(l));a.addCode(o.if(o.call(s+"_isZero",o.getLocal("n")),o.ret(o.call(s+"_zero",o.getLocal("r")))),o.setLocal("m",o.i32_const(y)),o.call(s+"_copy",o.i32_const(w),i),o.call(s+"_exp",o.getLocal("n"),o.i32_const(F),o.i32_const(l),n),o.call(s+"_exp",o.getLocal("n"),o.i32_const(A),o.i32_const(l),c),o.block(o.loop(o.br_if(1,o.call(s+"_eq",n,e)),o.call(s+"_square",n,r),o.setLocal("i",o.i32_const(1)),o.block(o.loop(o.br_if(1,o.call(s+"_eq",r,e)),o.call(s+"_square",r,r),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.call(s+"_copy",i,d),o.setLocal("j",o.i32_sub(o.i32_sub(o.getLocal("m"),o.getLocal("i")),o.i32_const(1))),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("j"))),o.call(s+"_square",d,d),o.setLocal("j",o.i32_sub(o.getLocal("j"),o.i32_const(1))),o.br(0))),o.setLocal("m",o.getLocal("i")),o.call(s+"_square",d,i),o.call(s+"_mul",n,i,n),o.call(s+"_mul",c,d,c),o.br(0))),o.if(o.call(s+"_isNegative",c),o.call(s+"_neg",c,o.getLocal("r")),o.call(s+"_copy",c,o.getLocal("r"))))}(),function(){const a=t.addFunction(s+"_isSquare");a.addParam("n","i32"),a.setReturnType("i32");const o=a.getCodeBuilder(),e=o.i32_const(u),i=o.i32_const(t.alloc(l));a.addCode(o.if(o.call(s+"_isZero",o.getLocal("n")),o.ret(o.i32_const(1))),o.call(s+"_exp",o.getLocal("n"),o.i32_const(L),o.i32_const(l),i),o.call(s+"_eq",i,e))}(),t.exportFunction(s+"_sqrt"),t.exportFunction(s+"_isSquare")),t.exportFunction(s+"_batchToMontgomery"),t.exportFunction(s+"_batchFromMontgomery"),s};const Ct=Ft,{bitLength:wt}=K;var Bt=function(t,a,o,e,i){const n=BigInt(a),c=Math.floor((wt(n-1n)-1)/64)+1,l=8*c,s=o||"f1";if(t.modules[s])return s;t.modules[s]={n64:c};const r=i||"int",d=Ct(t,n,e,r),_=t.modules[d].pR2,u=t.modules[d].pq,g=t.modules[d].pePlusOne;return function(){const a=t.alloc(l),o=t.addFunction(s+"_mul");o.addParam("x","i32"),o.addParam("y","i32"),o.addParam("r","i32");const e=o.getCodeBuilder();o.addCode(e.call(d+"_mul",e.getLocal("x"),e.getLocal("y"),e.i32_const(a))),o.addCode(e.call(d+"_mul",e.i32_const(a),e.i32_const(_),e.getLocal("r")))}(),function(){const a=t.addFunction(s+"_square");a.addParam("x","i32"),a.addParam("r","i32");const o=a.getCodeBuilder();a.addCode(o.call(s+"_mul",o.getLocal("x"),o.getLocal("x"),o.getLocal("r")))}(),function(){const a=t.addFunction(s+"_inverse");a.addParam("x","i32"),a.addParam("r","i32");const o=a.getCodeBuilder();a.addCode(o.call(r+"_inverseMod",o.getLocal("x"),o.i32_const(u),o.getLocal("r")))}(),function(){const a=t.addFunction(s+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");const o=a.getCodeBuilder();a.addCode(o.call(r+"_gte",o.getLocal("x"),o.i32_const(g)))}(),t.exportFunction(d+"_add",s+"_add"),t.exportFunction(d+"_sub",s+"_sub"),t.exportFunction(d+"_neg",s+"_neg"),t.exportFunction(s+"_mul"),t.exportFunction(s+"_square"),t.exportFunction(s+"_inverse"),t.exportFunction(s+"_isNegative"),t.exportFunction(d+"_copy",s+"_copy"),t.exportFunction(d+"_zero",s+"_zero"),t.exportFunction(d+"_one",s+"_one"),t.exportFunction(d+"_isZero",s+"_isZero"),t.exportFunction(d+"_eq",s+"_eq"),s};const At=V,Pt=Q,vt=W;var It=function(t,a,o,e){if(t.modules[o])return o;const i=8*t.modules[e].n64,n=t.modules[e].q;return t.modules[o]={n64:2*t.modules[e].n64},function(){const a=t.addFunction(o+"_isZero");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i));a.addCode(n.i32_and(n.call(e+"_isZero",c),n.call(e+"_isZero",l)))}(),function(){const a=t.addFunction(o+"_isOne");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i));a.addCode(n.ret(n.i32_and(n.call(e+"_isOne",c),n.call(e+"_isZero",l))))}(),function(){const a=t.addFunction(o+"_zero");a.addParam("x","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i));a.addCode(n.call(e+"_zero",c),n.call(e+"_zero",l))}(),function(){const a=t.addFunction(o+"_one");a.addParam("x","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i));a.addCode(n.call(e+"_one",c),n.call(e+"_zero",l))}(),function(){const a=t.addFunction(o+"_copy");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("r"),r=n.i32_add(n.getLocal("r"),n.i32_const(i));a.addCode(n.call(e+"_copy",c,s),n.call(e+"_copy",l,r))}(),function(){const n=t.addFunction(o+"_mul");n.addParam("x","i32"),n.addParam("y","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),l=c.getLocal("x"),s=c.i32_add(c.getLocal("x"),c.i32_const(i)),r=c.getLocal("y"),d=c.i32_add(c.getLocal("y"),c.i32_const(i)),_=c.getLocal("r"),u=c.i32_add(c.getLocal("r"),c.i32_const(i)),g=c.i32_const(t.alloc(i)),p=c.i32_const(t.alloc(i)),f=c.i32_const(t.alloc(i)),L=c.i32_const(t.alloc(i));n.addCode(c.call(e+"_mul",l,r,g),c.call(e+"_mul",s,d,p),c.call(e+"_add",l,s,f),c.call(e+"_add",r,d,L),c.call(e+"_mul",f,L,f),c.call(a,p,_),c.call(e+"_add",g,_,_),c.call(e+"_add",g,p,u),c.call(e+"_sub",f,u,u))}(),function(){const a=t.addFunction(o+"_mul1");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("y"),r=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(i));a.addCode(n.call(e+"_mul",c,s,r),n.call(e+"_mul",l,s,d))}(),function(){const n=t.addFunction(o+"_square");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),l=c.getLocal("x"),s=c.i32_add(c.getLocal("x"),c.i32_const(i)),r=c.getLocal("r"),d=c.i32_add(c.getLocal("r"),c.i32_const(i)),_=c.i32_const(t.alloc(i)),u=c.i32_const(t.alloc(i)),g=c.i32_const(t.alloc(i)),p=c.i32_const(t.alloc(i));n.addCode(c.call(e+"_mul",l,s,_),c.call(e+"_add",l,s,u),c.call(a,s,g),c.call(e+"_add",l,g,g),c.call(a,_,p),c.call(e+"_add",p,_,p),c.call(e+"_mul",u,g,r),c.call(e+"_sub",r,p,r),c.call(e+"_add",_,_,d))}(),function(){const a=t.addFunction(o+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("y"),r=n.i32_add(n.getLocal("y"),n.i32_const(i)),d=n.getLocal("r"),_=n.i32_add(n.getLocal("r"),n.i32_const(i));a.addCode(n.call(e+"_add",c,s,d),n.call(e+"_add",l,r,_))}(),function(){const a=t.addFunction(o+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("y"),r=n.i32_add(n.getLocal("y"),n.i32_const(i)),d=n.getLocal("r"),_=n.i32_add(n.getLocal("r"),n.i32_const(i));a.addCode(n.call(e+"_sub",c,s,d),n.call(e+"_sub",l,r,_))}(),function(){const a=t.addFunction(o+"_neg");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("r"),r=n.i32_add(n.getLocal("r"),n.i32_const(i));a.addCode(n.call(e+"_neg",c,s),n.call(e+"_neg",l,r))}(),function(){const a=t.addFunction(o+"_conjugate");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("r"),r=n.i32_add(n.getLocal("r"),n.i32_const(i));a.addCode(n.call(e+"_copy",c,s),n.call(e+"_neg",l,r))}(),function(){const a=t.addFunction(o+"_toMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("r"),r=n.i32_add(n.getLocal("r"),n.i32_const(i));a.addCode(n.call(e+"_toMontgomery",c,s),n.call(e+"_toMontgomery",l,r))}(),function(){const a=t.addFunction(o+"_fromMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("r"),r=n.i32_add(n.getLocal("r"),n.i32_const(i));a.addCode(n.call(e+"_fromMontgomery",c,s),n.call(e+"_fromMontgomery",l,r))}(),function(){const a=t.addFunction(o+"_eq");a.addParam("x","i32"),a.addParam("y","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("y"),r=n.i32_add(n.getLocal("y"),n.i32_const(i));a.addCode(n.i32_and(n.call(e+"_eq",c,s),n.call(e+"_eq",l,r)))}(),function(){const n=t.addFunction(o+"_inverse");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),l=c.getLocal("x"),s=c.i32_add(c.getLocal("x"),c.i32_const(i)),r=c.getLocal("r"),d=c.i32_add(c.getLocal("r"),c.i32_const(i)),_=c.i32_const(t.alloc(i)),u=c.i32_const(t.alloc(i)),g=c.i32_const(t.alloc(i)),p=c.i32_const(t.alloc(i));n.addCode(c.call(e+"_square",l,_),c.call(e+"_square",s,u),c.call(a,u,g),c.call(e+"_sub",_,g,g),c.call(e+"_inverse",g,p),c.call(e+"_mul",l,p,r),c.call(e+"_mul",s,p,d),c.call(e+"_neg",d,d))}(),function(){const a=t.addFunction(o+"_timesScalar");a.addParam("x","i32"),a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.getLocal("r"),r=n.i32_add(n.getLocal("r"),n.i32_const(i));a.addCode(n.call(e+"_timesScalar",c,n.getLocal("scalar"),n.getLocal("scalarLen"),s),n.call(e+"_timesScalar",l,n.getLocal("scalar"),n.getLocal("scalarLen"),r))}(),function(){const a=t.addFunction(o+"_sign");a.addParam("x","i32"),a.addLocal("s","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i));a.addCode(n.setLocal("s",n.call(e+"_sign",l)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.ret(n.call(e+"_sign",c)))}(),function(){const a=t.addFunction(o+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i));a.addCode(n.if(n.call(e+"_isZero",l),n.ret(n.call(e+"_isNegative",c))),n.ret(n.call(e+"_isNegative",l)))}(),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_isOne"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_copy"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_mul1"),t.exportFunction(o+"_square"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_neg"),t.exportFunction(o+"_sign"),t.exportFunction(o+"_conjugate"),t.exportFunction(o+"_fromMontgomery"),t.exportFunction(o+"_toMontgomery"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_inverse"),Pt(t,o),At(t,o+"_exp",2*i,o+"_mul",o+"_square",o+"_copy",o+"_one"),function(){const a=t.addFunction(o+"_sqrt");a.addParam("a","i32"),a.addParam("pr","i32");const c=a.getCodeBuilder(),l=c.i32_const(t.alloc(vt.bigInt2BytesLE((BigInt(n||0)-3n)/4n,i))),s=c.i32_const(t.alloc(vt.bigInt2BytesLE((BigInt(n||0)-1n)/2n,i))),r=c.getLocal("a"),d=c.i32_const(t.alloc(2*i)),_=c.i32_const(t.alloc(2*i)),u=c.i32_const(t.alloc(2*i)),g=t.alloc(2*i),p=c.i32_const(g),f=c.i32_const(g),L=c.i32_const(g+i),h=c.i32_const(t.alloc(2*i)),m=c.i32_const(t.alloc(2*i));a.addCode(c.call(o+"_one",p),c.call(o+"_neg",p,p),c.call(o+"_exp",r,l,c.i32_const(i),d),c.call(o+"_square",d,_),c.call(o+"_mul",r,_,_),c.call(o+"_conjugate",_,u),c.call(o+"_mul",u,_,u),c.if(c.call(o+"_eq",u,p),c.unreachable()),c.call(o+"_mul",d,r,h),c.if(c.call(o+"_eq",_,p),[...c.call(e+"_zero",f),...c.call(e+"_one",L),...c.call(o+"_mul",p,h,c.getLocal("pr"))],[...c.call(o+"_one",m),...c.call(o+"_add",m,_,m),...c.call(o+"_exp",m,s,c.i32_const(i),m),...c.call(o+"_mul",m,h,c.getLocal("pr"))]))}(),function(){const a=t.addFunction(o+"_isSquare");a.addParam("a","i32"),a.setReturnType("i32");const e=a.getCodeBuilder(),c=e.i32_const(t.alloc(vt.bigInt2BytesLE((BigInt(n||0)-3n)/4n,i))),l=e.getLocal("a"),s=e.i32_const(t.alloc(2*i)),r=e.i32_const(t.alloc(2*i)),d=e.i32_const(t.alloc(2*i)),_=t.alloc(2*i),u=e.i32_const(_);a.addCode(e.call(o+"_one",u),e.call(o+"_neg",u,u),e.call(o+"_exp",l,c,e.i32_const(i),s),e.call(o+"_square",s,r),e.call(o+"_mul",l,r,r),e.call(o+"_conjugate",r,d),e.call(o+"_mul",d,r,d),e.if(e.call(o+"_eq",d,u),e.ret(e.i32_const(0))),e.ret(e.i32_const(1)))}(),t.exportFunction(o+"_exp"),t.exportFunction(o+"_timesScalar"),t.exportFunction(o+"_batchInverse"),t.exportFunction(o+"_sqrt"),t.exportFunction(o+"_isSquare"),t.exportFunction(o+"_isNegative"),o};const qt=V,Et=Q;var Ot=function(t,a,o,e){if(t.modules[o])return o;const i=8*t.modules[e].n64;return t.modules[o]={n64:3*t.modules[e].n64},function(){const a=t.addFunction(o+"_isZero");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i));a.addCode(n.i32_and(n.i32_and(n.call(e+"_isZero",c),n.call(e+"_isZero",l)),n.call(e+"_isZero",s)))}(),function(){const a=t.addFunction(o+"_isOne");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i));a.addCode(n.ret(n.i32_and(n.i32_and(n.call(e+"_isOne",c),n.call(e+"_isZero",l)),n.call(e+"_isZero",s))))}(),function(){const a=t.addFunction(o+"_zero");a.addParam("x","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i));a.addCode(n.call(e+"_zero",c),n.call(e+"_zero",l),n.call(e+"_zero",s))}(),function(){const a=t.addFunction(o+"_one");a.addParam("x","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i));a.addCode(n.call(e+"_one",c),n.call(e+"_zero",l),n.call(e+"_zero",s))}(),function(){const a=t.addFunction(o+"_copy");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i)),r=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(i)),_=n.i32_add(n.getLocal("r"),n.i32_const(2*i));a.addCode(n.call(e+"_copy",c,r),n.call(e+"_copy",l,d),n.call(e+"_copy",s,_))}(),function(){const n=t.addFunction(o+"_mul");n.addParam("x","i32"),n.addParam("y","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),l=c.getLocal("x"),s=c.i32_add(c.getLocal("x"),c.i32_const(i)),r=c.i32_add(c.getLocal("x"),c.i32_const(2*i)),d=c.getLocal("y"),_=c.i32_add(c.getLocal("y"),c.i32_const(i)),u=c.i32_add(c.getLocal("y"),c.i32_const(2*i)),g=c.getLocal("r"),p=c.i32_add(c.getLocal("r"),c.i32_const(i)),f=c.i32_add(c.getLocal("r"),c.i32_const(2*i)),L=c.i32_const(t.alloc(i)),h=c.i32_const(t.alloc(i)),m=c.i32_const(t.alloc(i)),b=c.i32_const(t.alloc(i)),y=c.i32_const(t.alloc(i)),x=c.i32_const(t.alloc(i)),F=c.i32_const(t.alloc(i)),C=c.i32_const(t.alloc(i)),w=c.i32_const(t.alloc(i)),B=c.i32_const(t.alloc(i)),A=c.i32_const(t.alloc(i)),P=c.i32_const(t.alloc(i)),v=c.i32_const(t.alloc(i));n.addCode(c.call(e+"_mul",l,d,L),c.call(e+"_mul",s,_,h),c.call(e+"_mul",r,u,m),c.call(e+"_add",l,s,b),c.call(e+"_add",d,_,y),c.call(e+"_add",l,r,x),c.call(e+"_add",d,u,F),c.call(e+"_add",s,r,C),c.call(e+"_add",_,u,w),c.call(e+"_add",L,h,B),c.call(e+"_add",L,m,A),c.call(e+"_add",h,m,P),c.call(e+"_mul",C,w,g),c.call(e+"_sub",g,P,g),c.call(a,g,g),c.call(e+"_add",L,g,g),c.call(e+"_mul",b,y,p),c.call(e+"_sub",p,B,p),c.call(a,m,v),c.call(e+"_add",p,v,p),c.call(e+"_mul",x,F,f),c.call(e+"_sub",f,A,f),c.call(e+"_add",f,h,f))}(),function(){const n=t.addFunction(o+"_square");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),l=c.getLocal("x"),s=c.i32_add(c.getLocal("x"),c.i32_const(i)),r=c.i32_add(c.getLocal("x"),c.i32_const(2*i)),d=c.getLocal("r"),_=c.i32_add(c.getLocal("r"),c.i32_const(i)),u=c.i32_add(c.getLocal("r"),c.i32_const(2*i)),g=c.i32_const(t.alloc(i)),p=c.i32_const(t.alloc(i)),f=c.i32_const(t.alloc(i)),L=c.i32_const(t.alloc(i)),h=c.i32_const(t.alloc(i)),m=c.i32_const(t.alloc(i)),b=c.i32_const(t.alloc(i));n.addCode(c.call(e+"_square",l,g),c.call(e+"_mul",l,s,p),c.call(e+"_add",p,p,f),c.call(e+"_sub",l,s,L),c.call(e+"_add",L,r,L),c.call(e+"_square",L,L),c.call(e+"_mul",s,r,h),c.call(e+"_add",h,h,m),c.call(e+"_square",r,b),c.call(a,m,d),c.call(e+"_add",g,d,d),c.call(a,b,_),c.call(e+"_add",f,_,_),c.call(e+"_add",g,b,u),c.call(e+"_sub",m,u,u),c.call(e+"_add",L,u,u),c.call(e+"_add",f,u,u))}(),function(){const a=t.addFunction(o+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i)),r=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(i)),_=n.i32_add(n.getLocal("y"),n.i32_const(2*i)),u=n.getLocal("r"),g=n.i32_add(n.getLocal("r"),n.i32_const(i)),p=n.i32_add(n.getLocal("r"),n.i32_const(2*i));a.addCode(n.call(e+"_add",c,r,u),n.call(e+"_add",l,d,g),n.call(e+"_add",s,_,p))}(),function(){const a=t.addFunction(o+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i)),r=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(i)),_=n.i32_add(n.getLocal("y"),n.i32_const(2*i)),u=n.getLocal("r"),g=n.i32_add(n.getLocal("r"),n.i32_const(i)),p=n.i32_add(n.getLocal("r"),n.i32_const(2*i));a.addCode(n.call(e+"_sub",c,r,u),n.call(e+"_sub",l,d,g),n.call(e+"_sub",s,_,p))}(),function(){const a=t.addFunction(o+"_neg");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i)),r=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(i)),_=n.i32_add(n.getLocal("r"),n.i32_const(2*i));a.addCode(n.call(e+"_neg",c,r),n.call(e+"_neg",l,d),n.call(e+"_neg",s,_))}(),function(){const a=t.addFunction(o+"_sign");a.addParam("x","i32"),a.addLocal("s","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i));a.addCode(n.setLocal("s",n.call(e+"_sign",s)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.setLocal("s",n.call(e+"_sign",l)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.ret(n.call(e+"_sign",c)))}(),function(){const a=t.addFunction(o+"_toMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i)),r=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(i)),_=n.i32_add(n.getLocal("r"),n.i32_const(2*i));a.addCode(n.call(e+"_toMontgomery",c,r),n.call(e+"_toMontgomery",l,d),n.call(e+"_toMontgomery",s,_))}(),function(){const a=t.addFunction(o+"_fromMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i)),r=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(i)),_=n.i32_add(n.getLocal("r"),n.i32_const(2*i));a.addCode(n.call(e+"_fromMontgomery",c,r),n.call(e+"_fromMontgomery",l,d),n.call(e+"_fromMontgomery",s,_))}(),function(){const a=t.addFunction(o+"_eq");a.addParam("x","i32"),a.addParam("y","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i)),r=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(i)),_=n.i32_add(n.getLocal("y"),n.i32_const(2*i));a.addCode(n.i32_and(n.i32_and(n.call(e+"_eq",c,r),n.call(e+"_eq",l,d)),n.call(e+"_eq",s,_)))}(),function(){const n=t.addFunction(o+"_inverse");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),l=c.getLocal("x"),s=c.i32_add(c.getLocal("x"),c.i32_const(i)),r=c.i32_add(c.getLocal("x"),c.i32_const(2*i)),d=c.getLocal("r"),_=c.i32_add(c.getLocal("r"),c.i32_const(i)),u=c.i32_add(c.getLocal("r"),c.i32_const(2*i)),g=c.i32_const(t.alloc(i)),p=c.i32_const(t.alloc(i)),f=c.i32_const(t.alloc(i)),L=c.i32_const(t.alloc(i)),h=c.i32_const(t.alloc(i)),m=c.i32_const(t.alloc(i)),b=c.i32_const(t.alloc(i)),y=c.i32_const(t.alloc(i)),x=c.i32_const(t.alloc(i)),F=c.i32_const(t.alloc(i)),C=c.i32_const(t.alloc(i));n.addCode(c.call(e+"_square",l,g),c.call(e+"_square",s,p),c.call(e+"_square",r,f),c.call(e+"_mul",l,s,L),c.call(e+"_mul",l,r,h),c.call(e+"_mul",s,r,m),c.call(a,m,b),c.call(e+"_sub",g,b,b),c.call(a,f,y),c.call(e+"_sub",y,L,y),c.call(e+"_sub",p,h,x),c.call(e+"_mul",r,y,F),c.call(e+"_mul",s,x,C),c.call(e+"_add",F,C,F),c.call(a,F,F),c.call(e+"_mul",l,b,C),c.call(e+"_add",C,F,F),c.call(e+"_inverse",F,F),c.call(e+"_mul",F,b,d),c.call(e+"_mul",F,y,_),c.call(e+"_mul",F,x,u))}(),function(){const a=t.addFunction(o+"_timesScalar");a.addParam("x","i32"),a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i)),r=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(i)),_=n.i32_add(n.getLocal("r"),n.i32_const(2*i));a.addCode(n.call(e+"_timesScalar",c,n.getLocal("scalar"),n.getLocal("scalarLen"),r),n.call(e+"_timesScalar",l,n.getLocal("scalar"),n.getLocal("scalarLen"),d),n.call(e+"_timesScalar",s,n.getLocal("scalar"),n.getLocal("scalarLen"),_))}(),function(){const a=t.addFunction(o+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),l=n.i32_add(n.getLocal("x"),n.i32_const(i)),s=n.i32_add(n.getLocal("x"),n.i32_const(2*i));a.addCode(n.if(n.call(e+"_isZero",s),n.if(n.call(e+"_isZero",l),n.ret(n.call(e+"_isNegative",c)),n.ret(n.call(e+"_isNegative",l)))),n.ret(n.call(e+"_isNegative",s)))}(),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_isOne"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_copy"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_square"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_neg"),t.exportFunction(o+"_sign"),t.exportFunction(o+"_fromMontgomery"),t.exportFunction(o+"_toMontgomery"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_inverse"),Et(t,o),qt(t,o+"_exp",3*i,o+"_mul",o+"_square",o+"_copy",o+"_one"),t.exportFunction(o+"_exp"),t.exportFunction(o+"_timesScalar"),t.exportFunction(o+"_batchInverse"),t.exportFunction(o+"_isNegative"),o};const St=function(t,a,o,e,i,n,c,l){const s=t.addFunction(a);s.addParam("base","i32"),s.addParam("scalar","i32"),s.addParam("scalarLength","i32"),s.addParam("r","i32"),s.addLocal("old0","i32"),s.addLocal("nbits","i32"),s.addLocal("i","i32"),s.addLocal("last","i32"),s.addLocal("cur","i32"),s.addLocal("carry","i32"),s.addLocal("p","i32");const r=s.getCodeBuilder(),d=r.i32_const(t.alloc(o));function _(t){return r.i32_and(r.i32_shr_u(r.i32_load(r.i32_add(r.getLocal("scalar"),r.i32_and(r.i32_shr_u(t,r.i32_const(3)),r.i32_const(4294967292)))),r.i32_and(t,r.i32_const(31))),r.i32_const(1))}function u(t){return[...r.i32_store8(r.getLocal("p"),r.i32_const(t)),...r.setLocal("p",r.i32_add(r.getLocal("p"),r.i32_const(1)))]}s.addCode(r.if(r.i32_eqz(r.getLocal("scalarLength")),[...r.call(l,r.getLocal("r")),...r.ret([])]),r.setLocal("nbits",r.i32_shl(r.getLocal("scalarLength"),r.i32_const(3))),r.setLocal("old0",r.i32_load(r.i32_const(0))),r.setLocal("p",r.getLocal("old0")),r.i32_store(r.i32_const(0),r.i32_and(r.i32_add(r.i32_add(r.getLocal("old0"),r.i32_const(32)),r.getLocal("nbits")),r.i32_const(4294967288))),r.setLocal("i",r.i32_const(1)),r.setLocal("last",_(r.i32_const(0))),r.setLocal("carry",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("nbits"))),r.setLocal("cur",_(r.getLocal("i"))),r.if(r.getLocal("last"),r.if(r.getLocal("cur"),r.if(r.getLocal("carry"),[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(1)),...u(1)],[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(1)),...u(255)]),r.if(r.getLocal("carry"),[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(1)),...u(255)],[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(0)),...u(1)])),r.if(r.getLocal("cur"),r.if(r.getLocal("carry"),[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(1)),...u(0)],[...r.setLocal("last",r.i32_const(1)),...r.setLocal("carry",r.i32_const(0)),...u(0)]),r.if(r.getLocal("carry"),[...r.setLocal("last",r.i32_const(1)),...r.setLocal("carry",r.i32_const(0)),...u(0)],[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(0)),...u(0)]))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))),r.if(r.getLocal("last"),r.if(r.getLocal("carry"),[...u(255),...u(0),...u(1)],[...u(1)]),r.if(r.getLocal("carry"),[...u(0),...u(1)])),r.setLocal("p",r.i32_sub(r.getLocal("p"),r.i32_const(1))),r.call(c,r.getLocal("base"),d),r.call(l,r.getLocal("r")),r.block(r.loop(r.call(i,r.getLocal("r"),r.getLocal("r")),r.setLocal("cur",r.i32_load8_u(r.getLocal("p"))),r.if(r.getLocal("cur"),r.if(r.i32_eq(r.getLocal("cur"),r.i32_const(1)),r.call(e,r.getLocal("r"),d,r.getLocal("r")),r.call(n,r.getLocal("r"),d,r.getLocal("r")))),r.br_if(1,r.i32_eq(r.getLocal("old0"),r.getLocal("p"))),r.setLocal("p",r.i32_sub(r.getLocal("p"),r.i32_const(1))),r.br(0))),r.i32_store(r.i32_const(0),r.getLocal("old0")))},zt=J,Mt=function(t,a,o,e,i){const n=8*t.modules[a].n64;function c(){const e=t.addFunction(o);e.addParam("pBases","i32"),e.addParam("pScalars","i32"),e.addParam("scalarSize","i32"),e.addParam("n","i32"),e.addParam("pr","i32"),e.addLocal("chunkSize","i32"),e.addLocal("nChunks","i32"),e.addLocal("itScalar","i32"),e.addLocal("endScalar","i32"),e.addLocal("itBase","i32"),e.addLocal("itBit","i32"),e.addLocal("i","i32"),e.addLocal("j","i32"),e.addLocal("nTable","i32"),e.addLocal("pTable","i32"),e.addLocal("idx","i32"),e.addLocal("pIdxTable","i32");const i=e.getCodeBuilder(),c=i.i32_const(t.alloc(n)),l=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);e.addCode(i.call(a+"_zero",i.getLocal("pr")),i.if(i.i32_eqz(i.getLocal("n")),i.ret([])),i.setLocal("chunkSize",i.i32_load8_u(i.i32_clz(i.getLocal("n")),l)),i.setLocal("nChunks",i.i32_add(i.i32_div_u(i.i32_sub(i.i32_shl(i.getLocal("scalarSize"),i.i32_const(3)),i.i32_const(1)),i.getLocal("chunkSize")),i.i32_const(1))),i.setLocal("itBit",i.i32_mul(i.i32_sub(i.getLocal("nChunks"),i.i32_const(1)),i.getLocal("chunkSize"))),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itBit"),i.i32_const(0))),i.if(i.i32_eqz(i.call(a+"_isZero",i.getLocal("pr"))),[...i.setLocal("j",i.i32_const(0)),...i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("j"),i.getLocal("chunkSize"))),i.call(a+"_double",i.getLocal("pr"),i.getLocal("pr")),i.setLocal("j",i.i32_add(i.getLocal("j"),i.i32_const(1))),i.br(0)))]),i.call(o+"_chunk",i.getLocal("pBases"),i.getLocal("pScalars"),i.getLocal("scalarSize"),i.getLocal("n"),i.getLocal("itBit"),i.getLocal("chunkSize"),c),i.call(a+"_add",i.getLocal("pr"),c,i.getLocal("pr")),i.setLocal("itBit",i.i32_sub(i.getLocal("itBit"),i.getLocal("chunkSize"))),i.br(0))))}!function(){const a=t.addFunction(o+"_getChunk");a.addParam("pScalar","i32"),a.addParam("scalarSize","i32"),a.addParam("startBit","i32"),a.addParam("chunkSize","i32"),a.addLocal("bitsToEnd","i32"),a.addLocal("mask","i32"),a.setReturnType("i32");const e=a.getCodeBuilder();a.addCode(e.setLocal("bitsToEnd",e.i32_sub(e.i32_mul(e.getLocal("scalarSize"),e.i32_const(8)),e.getLocal("startBit"))),e.if(e.i32_gt_s(e.getLocal("chunkSize"),e.getLocal("bitsToEnd")),e.setLocal("mask",e.i32_sub(e.i32_shl(e.i32_const(1),e.getLocal("bitsToEnd")),e.i32_const(1))),e.setLocal("mask",e.i32_sub(e.i32_shl(e.i32_const(1),e.getLocal("chunkSize")),e.i32_const(1)))),e.i32_and(e.i32_shr_u(e.i32_load(e.i32_add(e.getLocal("pScalar"),e.i32_shr_u(e.getLocal("startBit"),e.i32_const(3))),0,0),e.i32_and(e.getLocal("startBit"),e.i32_const(7))),e.getLocal("mask")))}(),function(){const e=t.addFunction(o+"_reduceTable");e.addParam("pTable","i32"),e.addParam("p","i32"),e.addLocal("half","i32"),e.addLocal("it1","i32"),e.addLocal("it2","i32"),e.addLocal("pAcc","i32");const i=e.getCodeBuilder();e.addCode(i.if(i.i32_eq(i.getLocal("p"),i.i32_const(1)),i.ret([])),i.setLocal("half",i.i32_shl(i.i32_const(1),i.i32_sub(i.getLocal("p"),i.i32_const(1)))),i.setLocal("it1",i.getLocal("pTable")),i.setLocal("it2",i.i32_add(i.getLocal("pTable"),i.i32_mul(i.getLocal("half"),i.i32_const(n)))),i.setLocal("pAcc",i.i32_sub(i.getLocal("it2"),i.i32_const(n))),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("it1"),i.getLocal("pAcc"))),i.call(a+"_add",i.getLocal("it1"),i.getLocal("it2"),i.getLocal("it1")),i.call(a+"_add",i.getLocal("pAcc"),i.getLocal("it2"),i.getLocal("pAcc")),i.setLocal("it1",i.i32_add(i.getLocal("it1"),i.i32_const(n))),i.setLocal("it2",i.i32_add(i.getLocal("it2"),i.i32_const(n))),i.br(0))),i.call(o+"_reduceTable",i.getLocal("pTable"),i.i32_sub(i.getLocal("p"),i.i32_const(1))),i.setLocal("p",i.i32_sub(i.getLocal("p"),i.i32_const(1))),i.block(i.loop(i.br_if(1,i.i32_eqz(i.getLocal("p"))),i.call(a+"_double",i.getLocal("pAcc"),i.getLocal("pAcc")),i.setLocal("p",i.i32_sub(i.getLocal("p"),i.i32_const(1))),i.br(0))),i.call(a+"_add",i.getLocal("pTable"),i.getLocal("pAcc"),i.getLocal("pTable")))}(),function(){const c=t.addFunction(o+"_chunk");c.addParam("pBases","i32"),c.addParam("pScalars","i32"),c.addParam("scalarSize","i32"),c.addParam("n","i32"),c.addParam("startBit","i32"),c.addParam("chunkSize","i32"),c.addParam("pr","i32"),c.addLocal("nChunks","i32"),c.addLocal("itScalar","i32"),c.addLocal("endScalar","i32"),c.addLocal("itBase","i32"),c.addLocal("i","i32"),c.addLocal("j","i32"),c.addLocal("nTable","i32"),c.addLocal("pTable","i32"),c.addLocal("idx","i32"),c.addLocal("pIdxTable","i32");const l=c.getCodeBuilder();c.addCode(l.if(l.i32_eqz(l.getLocal("n")),[...l.call(a+"_zero",l.getLocal("pr")),...l.ret([])]),l.setLocal("nTable",l.i32_shl(l.i32_const(1),l.getLocal("chunkSize"))),l.setLocal("pTable",l.i32_load(l.i32_const(0))),l.i32_store(l.i32_const(0),l.i32_add(l.getLocal("pTable"),l.i32_mul(l.getLocal("nTable"),l.i32_const(n)))),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("j"),l.getLocal("nTable"))),l.call(a+"_zero",l.i32_add(l.getLocal("pTable"),l.i32_mul(l.getLocal("j"),l.i32_const(n)))),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("itBase",l.getLocal("pBases")),l.setLocal("itScalar",l.getLocal("pScalars")),l.setLocal("endScalar",l.i32_add(l.getLocal("pScalars"),l.i32_mul(l.getLocal("n"),l.getLocal("scalarSize")))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("itScalar"),l.getLocal("endScalar"))),l.setLocal("idx",l.call(o+"_getChunk",l.getLocal("itScalar"),l.getLocal("scalarSize"),l.getLocal("startBit"),l.getLocal("chunkSize"))),l.if(l.getLocal("idx"),[...l.setLocal("pIdxTable",l.i32_add(l.getLocal("pTable"),l.i32_mul(l.i32_sub(l.getLocal("idx"),l.i32_const(1)),l.i32_const(n)))),...l.call(e,l.getLocal("pIdxTable"),l.getLocal("itBase"),l.getLocal("pIdxTable"))]),l.setLocal("itScalar",l.i32_add(l.getLocal("itScalar"),l.getLocal("scalarSize"))),l.setLocal("itBase",l.i32_add(l.getLocal("itBase"),l.i32_const(i))),l.br(0))),l.call(o+"_reduceTable",l.getLocal("pTable"),l.getLocal("chunkSize")),l.call(a+"_copy",l.getLocal("pTable"),l.getLocal("pr")),l.i32_store(l.i32_const(0),l.getLocal("pTable")))}(),c(),t.exportFunction(o),t.exportFunction(o+"_chunk")};var Tt=function(t,a,o,e){const i=t.modules[o].n64,n=8*i;if(t.modules[a])return a;return t.modules[a]={n64:3*i},function(){const e=t.addFunction(a+"_isZeroAffine");e.addParam("p1","i32"),e.setReturnType("i32");const i=e.getCodeBuilder();e.addCode(i.i32_and(i.call(o+"_isZero",i.getLocal("p1")),i.call(o+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(n)))))}(),function(){const e=t.addFunction(a+"_isZero");e.addParam("p1","i32"),e.setReturnType("i32");const i=e.getCodeBuilder();e.addCode(i.call(o+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(2*n))))}(),function(){const e=t.addFunction(a+"_zeroAffine");e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(o+"_zero",i.getLocal("pr"))),e.addCode(i.call(o+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(n))))}(),function(){const e=t.addFunction(a+"_zero");e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(o+"_zero",i.getLocal("pr"))),e.addCode(i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(n)))),e.addCode(i.call(o+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(2*n))))}(),function(){const o=t.addFunction(a+"_copyAffine");o.addParam("ps","i32"),o.addParam("pd","i32");const e=o.getCodeBuilder();for(let t=0;t<2*i;t++)o.addCode(e.i64_store(e.getLocal("pd"),8*t,e.i64_load(e.getLocal("ps"),8*t)))}(),function(){const o=t.addFunction(a+"_copy");o.addParam("ps","i32"),o.addParam("pd","i32");const e=o.getCodeBuilder();for(let t=0;t<3*i;t++)o.addCode(e.i64_store(e.getLocal("pd"),8*t,e.i64_load(e.getLocal("ps"),8*t)))}(),function(){const e=t.addFunction(a+"_toJacobian");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n)),s=i.getLocal("pr"),r=i.i32_add(i.getLocal("pr"),i.i32_const(n)),d=i.i32_add(i.getLocal("pr"),i.i32_const(2*n));e.addCode(i.if(i.call(a+"_isZeroAffine",i.getLocal("p1")),i.call(a+"_zero",i.getLocal("pr")),[...i.call(o+"_one",d),...i.call(o+"_copy",l,r),...i.call(o+"_copy",c,s)]))}(),function(){const e=t.addFunction(a+"_eqAffine");e.addParam("p1","i32"),e.addParam("p2","i32"),e.setReturnType("i32"),e.addLocal("z1","i32");const i=e.getCodeBuilder();e.addCode(i.ret(i.i32_and(i.call(o+"_eq",i.getLocal("p1"),i.getLocal("p2")),i.call(o+"_eq",i.i32_add(i.getLocal("p1"),i.i32_const(n)),i.i32_add(i.getLocal("p2"),i.i32_const(n))))))}(),function(){const e=t.addFunction(a+"_eqMixed");e.addParam("p1","i32"),e.addParam("p2","i32"),e.setReturnType("i32"),e.addLocal("z1","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n));e.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(2*n))));const s=i.getLocal("z1"),r=i.getLocal("p2"),d=i.i32_add(i.getLocal("p2"),i.i32_const(n)),_=i.i32_const(t.alloc(n)),u=i.i32_const(t.alloc(n)),g=i.i32_const(t.alloc(n)),p=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZero",i.getLocal("p1")),i.ret(i.call(a+"_isZeroAffine",i.getLocal("p2")))),i.if(i.call(a+"_isZeroAffine",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(o+"_isOne",s),i.ret(i.call(a+"_eqAffine",i.getLocal("p1"),i.getLocal("p2")))),i.call(o+"_square",s,_),i.call(o+"_mul",r,_,u),i.call(o+"_mul",s,_,g),i.call(o+"_mul",d,g,p),i.if(i.call(o+"_eq",c,u),i.if(i.call(o+"_eq",l,p),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}(),function(){const e=t.addFunction(a+"_eq");e.addParam("p1","i32"),e.addParam("p2","i32"),e.setReturnType("i32"),e.addLocal("z1","i32"),e.addLocal("z2","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n));e.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(2*n))));const s=i.getLocal("z1"),r=i.getLocal("p2"),d=i.i32_add(i.getLocal("p2"),i.i32_const(n));e.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(2*n))));const _=i.getLocal("z2"),u=i.i32_const(t.alloc(n)),g=i.i32_const(t.alloc(n)),p=i.i32_const(t.alloc(n)),f=i.i32_const(t.alloc(n)),L=i.i32_const(t.alloc(n)),h=i.i32_const(t.alloc(n)),m=i.i32_const(t.alloc(n)),b=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZero",i.getLocal("p1")),i.ret(i.call(a+"_isZero",i.getLocal("p2")))),i.if(i.call(a+"_isZero",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(o+"_isOne",s),i.ret(i.call(a+"_eqMixed",i.getLocal("p2"),i.getLocal("p1")))),i.if(i.call(o+"_isOne",_),i.ret(i.call(a+"_eqMixed",i.getLocal("p1"),i.getLocal("p2")))),i.call(o+"_square",s,u),i.call(o+"_square",_,g),i.call(o+"_mul",c,g,p),i.call(o+"_mul",r,u,f),i.call(o+"_mul",s,u,L),i.call(o+"_mul",_,g,h),i.call(o+"_mul",l,h,m),i.call(o+"_mul",d,L,b),i.if(i.call(o+"_eq",p,f),i.if(i.call(o+"_eq",m,b),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}(),function(){const e=t.addFunction(a+"_doubleAffine");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n)),s=i.getLocal("pr"),r=i.i32_add(i.getLocal("pr"),i.i32_const(n)),d=i.i32_add(i.getLocal("pr"),i.i32_const(2*n)),_=i.i32_const(t.alloc(n)),u=i.i32_const(t.alloc(n)),g=i.i32_const(t.alloc(n)),p=i.i32_const(t.alloc(n)),f=i.i32_const(t.alloc(n)),L=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZeroAffine",i.getLocal("p1")),[...i.call(a+"_toJacobian",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.call(o+"_square",c,_),i.call(o+"_square",l,u),i.call(o+"_square",u,g),i.call(o+"_add",c,u,p),i.call(o+"_square",p,p),i.call(o+"_sub",p,_,p),i.call(o+"_sub",p,g,p),i.call(o+"_add",p,p,p),i.call(o+"_add",_,_,f),i.call(o+"_add",f,_,f),i.call(o+"_add",l,l,d),i.call(o+"_square",f,s),i.call(o+"_sub",s,p,s),i.call(o+"_sub",s,p,s),i.call(o+"_add",g,g,L),i.call(o+"_add",L,L,L),i.call(o+"_add",L,L,L),i.call(o+"_sub",p,s,r),i.call(o+"_mul",r,f,r),i.call(o+"_sub",r,L,r))}(),function(){const e=t.addFunction(a+"_double");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n)),s=i.i32_add(i.getLocal("p1"),i.i32_const(2*n)),r=i.getLocal("pr"),d=i.i32_add(i.getLocal("pr"),i.i32_const(n)),_=i.i32_add(i.getLocal("pr"),i.i32_const(2*n)),u=i.i32_const(t.alloc(n)),g=i.i32_const(t.alloc(n)),p=i.i32_const(t.alloc(n)),f=i.i32_const(t.alloc(n)),L=i.i32_const(t.alloc(n)),h=i.i32_const(t.alloc(n)),m=i.i32_const(t.alloc(n)),b=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZero",i.getLocal("p1")),[...i.call(a+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(o+"_isOne",s),[...i.ret(i.call(a+"_doubleAffine",i.getLocal("p1"),i.getLocal("pr"))),...i.ret([])]),i.call(o+"_square",c,u),i.call(o+"_square",l,g),i.call(o+"_square",g,p),i.call(o+"_add",c,g,f),i.call(o+"_square",f,f),i.call(o+"_sub",f,u,f),i.call(o+"_sub",f,p,f),i.call(o+"_add",f,f,f),i.call(o+"_add",u,u,L),i.call(o+"_add",L,u,L),i.call(o+"_square",L,h),i.call(o+"_mul",l,s,m),i.call(o+"_add",f,f,r),i.call(o+"_sub",h,r,r),i.call(o+"_add",p,p,b),i.call(o+"_add",b,b,b),i.call(o+"_add",b,b,b),i.call(o+"_sub",f,r,d),i.call(o+"_mul",d,L,d),i.call(o+"_sub",d,b,d),i.call(o+"_add",m,m,_))}(),function(){const e=t.addFunction(a+"_addAffine");e.addParam("p1","i32"),e.addParam("p2","i32"),e.addParam("pr","i32"),e.addLocal("z1","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n));e.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(2*n))));const s=i.getLocal("p2"),r=i.i32_add(i.getLocal("p2"),i.i32_const(n)),d=i.getLocal("pr"),_=i.i32_add(i.getLocal("pr"),i.i32_const(n)),u=i.i32_add(i.getLocal("pr"),i.i32_const(2*n)),g=i.i32_const(t.alloc(n)),p=i.i32_const(t.alloc(n)),f=i.i32_const(t.alloc(n)),L=i.i32_const(t.alloc(n)),h=i.i32_const(t.alloc(n)),m=i.i32_const(t.alloc(n)),b=i.i32_const(t.alloc(n)),y=i.i32_const(t.alloc(n)),x=i.i32_const(t.alloc(n)),F=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZeroAffine",i.getLocal("p1")),[...i.call(a+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(2*n))),...i.ret([])]),i.if(i.call(a+"_isZeroAffine",i.getLocal("p2")),[...i.call(a+"_copyAffine",i.getLocal("p1"),i.getLocal("pr")),...i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(2*n))),...i.ret([])]),i.if(i.call(o+"_eq",c,s),i.if(i.call(o+"_eq",l,r),[...i.call(a+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(o+"_sub",s,c,g),i.call(o+"_sub",r,l,f),i.call(o+"_square",g,p),i.call(o+"_add",p,p,L),i.call(o+"_add",L,L,L),i.call(o+"_mul",g,L,h),i.call(o+"_add",f,f,m),i.call(o+"_mul",c,L,y),i.call(o+"_square",m,b),i.call(o+"_add",y,y,x),i.call(o+"_sub",b,h,d),i.call(o+"_sub",d,x,d),i.call(o+"_mul",l,h,F),i.call(o+"_add",F,F,F),i.call(o+"_sub",y,d,_),i.call(o+"_mul",_,m,_),i.call(o+"_sub",_,F,_),i.call(o+"_add",g,g,u))}(),function(){const e=t.addFunction(a+"_addMixed");e.addParam("p1","i32"),e.addParam("p2","i32"),e.addParam("pr","i32"),e.addLocal("z1","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n));e.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(2*n))));const s=i.getLocal("z1"),r=i.getLocal("p2"),d=i.i32_add(i.getLocal("p2"),i.i32_const(n)),_=i.getLocal("pr"),u=i.i32_add(i.getLocal("pr"),i.i32_const(n)),g=i.i32_add(i.getLocal("pr"),i.i32_const(2*n)),p=i.i32_const(t.alloc(n)),f=i.i32_const(t.alloc(n)),L=i.i32_const(t.alloc(n)),h=i.i32_const(t.alloc(n)),m=i.i32_const(t.alloc(n)),b=i.i32_const(t.alloc(n)),y=i.i32_const(t.alloc(n)),x=i.i32_const(t.alloc(n)),F=i.i32_const(t.alloc(n)),C=i.i32_const(t.alloc(n)),w=i.i32_const(t.alloc(n)),B=i.i32_const(t.alloc(n)),A=i.i32_const(t.alloc(n)),P=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZero",i.getLocal("p1")),[...i.call(a+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(2*n))),...i.ret([])]),i.if(i.call(a+"_isZeroAffine",i.getLocal("p2")),[...i.call(a+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(o+"_isOne",s),[...i.call(a+"_addAffine",c,r,_),...i.ret([])]),i.call(o+"_square",s,p),i.call(o+"_mul",r,p,f),i.call(o+"_mul",s,p,L),i.call(o+"_mul",d,L,h),i.if(i.call(o+"_eq",c,f),i.if(i.call(o+"_eq",l,h),[...i.call(a+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(o+"_sub",f,c,m),i.call(o+"_sub",h,l,y),i.call(o+"_square",m,b),i.call(o+"_add",b,b,x),i.call(o+"_add",x,x,x),i.call(o+"_mul",m,x,F),i.call(o+"_add",y,y,C),i.call(o+"_mul",c,x,B),i.call(o+"_square",C,w),i.call(o+"_add",B,B,A),i.call(o+"_sub",w,F,_),i.call(o+"_sub",_,A,_),i.call(o+"_mul",l,F,P),i.call(o+"_add",P,P,P),i.call(o+"_sub",B,_,u),i.call(o+"_mul",u,C,u),i.call(o+"_sub",u,P,u),i.call(o+"_add",s,m,g),i.call(o+"_square",g,g),i.call(o+"_sub",g,p,g),i.call(o+"_sub",g,b,g))}(),function(){const e=t.addFunction(a+"_add");e.addParam("p1","i32"),e.addParam("p2","i32"),e.addParam("pr","i32"),e.addLocal("z1","i32"),e.addLocal("z2","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n));e.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(2*n))));const s=i.getLocal("z1"),r=i.getLocal("p2"),d=i.i32_add(i.getLocal("p2"),i.i32_const(n));e.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(2*n))));const _=i.getLocal("z2"),u=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(n)),p=i.i32_add(i.getLocal("pr"),i.i32_const(2*n)),f=i.i32_const(t.alloc(n)),L=i.i32_const(t.alloc(n)),h=i.i32_const(t.alloc(n)),m=i.i32_const(t.alloc(n)),b=i.i32_const(t.alloc(n)),y=i.i32_const(t.alloc(n)),x=i.i32_const(t.alloc(n)),F=i.i32_const(t.alloc(n)),C=i.i32_const(t.alloc(n)),w=i.i32_const(t.alloc(n)),B=i.i32_const(t.alloc(n)),A=i.i32_const(t.alloc(n)),P=i.i32_const(t.alloc(n)),v=i.i32_const(t.alloc(n)),I=i.i32_const(t.alloc(n)),q=i.i32_const(t.alloc(n)),E=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZero",i.getLocal("p1")),[...i.call(a+"_copy",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isZero",i.getLocal("p2")),[...i.call(a+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(o+"_isOne",s),[...i.call(a+"_addMixed",r,c,u),...i.ret([])]),i.if(i.call(o+"_isOne",_),[...i.call(a+"_addMixed",c,r,u),...i.ret([])]),i.call(o+"_square",s,f),i.call(o+"_square",_,L),i.call(o+"_mul",c,L,h),i.call(o+"_mul",r,f,m),i.call(o+"_mul",s,f,b),i.call(o+"_mul",_,L,y),i.call(o+"_mul",l,y,x),i.call(o+"_mul",d,b,F),i.if(i.call(o+"_eq",h,m),i.if(i.call(o+"_eq",x,F),[...i.call(a+"_double",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])])),i.call(o+"_sub",m,h,C),i.call(o+"_sub",F,x,w),i.call(o+"_add",C,C,B),i.call(o+"_square",B,B),i.call(o+"_mul",C,B,A),i.call(o+"_add",w,w,P),i.call(o+"_mul",h,B,I),i.call(o+"_square",P,v),i.call(o+"_add",I,I,q),i.call(o+"_sub",v,A,u),i.call(o+"_sub",u,q,u),i.call(o+"_mul",x,A,E),i.call(o+"_add",E,E,E),i.call(o+"_sub",I,u,g),i.call(o+"_mul",g,P,g),i.call(o+"_sub",g,E,g),i.call(o+"_add",s,_,p),i.call(o+"_square",p,p),i.call(o+"_sub",p,f,p),i.call(o+"_sub",p,L,p),i.call(o+"_mul",p,C,p))}(),function(){const e=t.addFunction(a+"_negAffine");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n)),s=i.getLocal("pr"),r=i.i32_add(i.getLocal("pr"),i.i32_const(n));e.addCode(i.call(o+"_copy",c,s),i.call(o+"_neg",l,r))}(),function(){const e=t.addFunction(a+"_neg");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n)),s=i.i32_add(i.getLocal("p1"),i.i32_const(2*n)),r=i.getLocal("pr"),d=i.i32_add(i.getLocal("pr"),i.i32_const(n)),_=i.i32_add(i.getLocal("pr"),i.i32_const(2*n));e.addCode(i.call(o+"_copy",c,r),i.call(o+"_neg",l,d),i.call(o+"_copy",s,_))}(),function(){const o=t.addFunction(a+"_subAffine");o.addParam("p1","i32"),o.addParam("p2","i32"),o.addParam("pr","i32");const e=o.getCodeBuilder(),i=e.i32_const(t.alloc(3*n));o.addCode(e.call(a+"_negAffine",e.getLocal("p2"),i),e.call(a+"_addAffine",e.getLocal("p1"),i,e.getLocal("pr")))}(),function(){const o=t.addFunction(a+"_subMixed");o.addParam("p1","i32"),o.addParam("p2","i32"),o.addParam("pr","i32");const e=o.getCodeBuilder(),i=e.i32_const(t.alloc(3*n));o.addCode(e.call(a+"_negAffine",e.getLocal("p2"),i),e.call(a+"_addMixed",e.getLocal("p1"),i,e.getLocal("pr")))}(),function(){const o=t.addFunction(a+"_sub");o.addParam("p1","i32"),o.addParam("p2","i32"),o.addParam("pr","i32");const e=o.getCodeBuilder(),i=e.i32_const(t.alloc(3*n));o.addCode(e.call(a+"_neg",e.getLocal("p2"),i),e.call(a+"_add",e.getLocal("p1"),i,e.getLocal("pr")))}(),function(){const e=t.addFunction(a+"_fromMontgomeryAffine");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(o+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let t=1;t<2;t++)e.addCode(i.call(o+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(t*n)),i.i32_add(i.getLocal("pr"),i.i32_const(t*n))))}(),function(){const e=t.addFunction(a+"_fromMontgomery");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(o+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let t=1;t<3;t++)e.addCode(i.call(o+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(t*n)),i.i32_add(i.getLocal("pr"),i.i32_const(t*n))))}(),function(){const e=t.addFunction(a+"_toMontgomeryAffine");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(o+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let t=1;t<2;t++)e.addCode(i.call(o+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(t*n)),i.i32_add(i.getLocal("pr"),i.i32_const(t*n))))}(),function(){const e=t.addFunction(a+"_toMontgomery");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(o+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let t=1;t<3;t++)e.addCode(i.call(o+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(t*n)),i.i32_add(i.getLocal("pr"),i.i32_const(t*n))))}(),function(){const e=t.addFunction(a+"_toAffine");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n)),s=i.i32_add(i.getLocal("p1"),i.i32_const(2*n)),r=i.getLocal("pr"),d=i.i32_add(i.getLocal("pr"),i.i32_const(n)),_=i.i32_const(t.alloc(n)),u=i.i32_const(t.alloc(n)),g=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZero",i.getLocal("p1")),[...i.call(o+"_zero",r),...i.call(o+"_zero",d)],[...i.call(o+"_inverse",s,_),...i.call(o+"_square",_,u),...i.call(o+"_mul",_,u,g),...i.call(o+"_mul",c,u,r),...i.call(o+"_mul",l,g,d)]))}(),function(){const i=t.addFunction(a+"_inCurveAffine");i.addParam("pIn","i32"),i.setReturnType("i32");const c=i.getCodeBuilder(),l=c.getLocal("pIn"),s=c.i32_add(c.getLocal("pIn"),c.i32_const(n)),r=c.i32_const(t.alloc(n)),d=c.i32_const(t.alloc(n));i.addCode(c.call(o+"_square",s,r),c.call(o+"_square",l,d),c.call(o+"_mul",l,d,d),c.call(o+"_add",d,c.i32_const(e),d),c.ret(c.call(o+"_eq",r,d)))}(),function(){const o=t.addFunction(a+"_inCurve");o.addParam("pIn","i32"),o.setReturnType("i32");const e=o.getCodeBuilder(),i=e.i32_const(t.alloc(2*n));o.addCode(e.call(a+"_toAffine",e.getLocal("pIn"),i),e.ret(e.call(a+"_inCurveAffine",i)))}(),function(){const e=t.addFunction(a+"_batchToAffine");e.addParam("pIn","i32"),e.addParam("n","i32"),e.addParam("pOut","i32"),e.addLocal("pAux","i32"),e.addLocal("itIn","i32"),e.addLocal("itAux","i32"),e.addLocal("itOut","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),c=i.i32_const(t.alloc(n));e.addCode(i.setLocal("pAux",i.i32_load(i.i32_const(0))),i.i32_store(i.i32_const(0),i.i32_add(i.getLocal("pAux"),i.i32_mul(i.getLocal("n"),i.i32_const(n)))),i.call(o+"_batchInverse",i.i32_add(i.getLocal("pIn"),i.i32_const(2*n)),i.i32_const(3*n),i.getLocal("n"),i.getLocal("pAux"),i.i32_const(n)),i.setLocal("itIn",i.getLocal("pIn")),i.setLocal("itAux",i.getLocal("pAux")),i.setLocal("itOut",i.getLocal("pOut")),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("n"))),i.if(i.call(o+"_isZero",i.getLocal("itAux")),[...i.call(o+"_zero",i.getLocal("itOut")),...i.call(o+"_zero",i.i32_add(i.getLocal("itOut"),i.i32_const(n)))],[...i.call(o+"_mul",i.getLocal("itAux"),i.i32_add(i.getLocal("itIn"),i.i32_const(n)),c),...i.call(o+"_square",i.getLocal("itAux"),i.getLocal("itAux")),...i.call(o+"_mul",i.getLocal("itAux"),i.getLocal("itIn"),i.getLocal("itOut")),...i.call(o+"_mul",i.getLocal("itAux"),c,i.i32_add(i.getLocal("itOut"),i.i32_const(n)))]),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(3*n))),i.setLocal("itOut",i.i32_add(i.getLocal("itOut"),i.i32_const(2*n))),i.setLocal("itAux",i.i32_add(i.getLocal("itAux"),i.i32_const(n))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.i32_store(i.i32_const(0),i.getLocal("pAux")))}(),function(){const e=t.addFunction(a+"_normalize");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),c=i.getLocal("p1"),l=i.i32_add(i.getLocal("p1"),i.i32_const(n)),s=i.i32_add(i.getLocal("p1"),i.i32_const(2*n)),r=i.getLocal("pr"),d=i.i32_add(i.getLocal("pr"),i.i32_const(n)),_=i.i32_add(i.getLocal("pr"),i.i32_const(2*n)),u=i.i32_const(t.alloc(n)),g=i.i32_const(t.alloc(n)),p=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZero",i.getLocal("p1")),i.call(a+"_zero",i.getLocal("pr")),[...i.call(o+"_inverse",s,u),...i.call(o+"_square",u,g),...i.call(o+"_mul",u,g,p),...i.call(o+"_mul",c,g,r),...i.call(o+"_mul",l,p,d),...i.call(o+"_one",_)]))}(),function(){const o=t.addFunction(a+"__reverseBytes");o.addParam("pIn","i32"),o.addParam("n","i32"),o.addParam("pOut","i32"),o.addLocal("itOut","i32"),o.addLocal("itIn","i32");const e=o.getCodeBuilder();o.addCode(e.setLocal("itOut",e.i32_sub(e.i32_add(e.getLocal("pOut"),e.getLocal("n")),e.i32_const(1))),e.setLocal("itIn",e.getLocal("pIn")),e.block(e.loop(e.br_if(1,e.i32_lt_s(e.getLocal("itOut"),e.getLocal("pOut"))),e.i32_store8(e.getLocal("itOut"),e.i32_load8_u(e.getLocal("itIn"))),e.setLocal("itOut",e.i32_sub(e.getLocal("itOut"),e.i32_const(1))),e.setLocal("itIn",e.i32_add(e.getLocal("itIn"),e.i32_const(1))),e.br(0))))}(),function(){const o=t.addFunction(a+"_LEMtoU");o.addParam("pIn","i32"),o.addParam("pOut","i32");const e=o.getCodeBuilder(),i=t.alloc(2*n),c=e.i32_const(i),l=e.i32_const(i),s=e.i32_const(i+n);o.addCode(e.if(e.call(a+"_isZeroAffine",e.getLocal("pIn")),[...e.call(a+"_zeroAffine",e.getLocal("pOut")),...e.ret([])]),e.call(a+"_fromMontgomeryAffine",e.getLocal("pIn"),c),e.call(a+"__reverseBytes",l,e.i32_const(n),e.getLocal("pOut")),e.call(a+"__reverseBytes",s,e.i32_const(n),e.i32_add(e.getLocal("pOut"),e.i32_const(n))))}(),function(){const e=t.addFunction(a+"_LEMtoC");e.addParam("pIn","i32"),e.addParam("pOut","i32");const i=e.getCodeBuilder(),c=i.i32_const(t.alloc(n));e.addCode(i.if(i.call(a+"_isZero",i.getLocal("pIn")),[...i.call(o+"_zero",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(o+"_fromMontgomery",i.getLocal("pIn"),c),i.call(a+"__reverseBytes",c,i.i32_const(n),i.getLocal("pOut")),i.if(i.i32_eq(i.call(o+"_sign",i.i32_add(i.getLocal("pIn"),i.i32_const(n))),i.i32_const(-1)),i.i32_store8(i.getLocal("pOut"),i.i32_or(i.i32_load8_u(i.getLocal("pOut")),i.i32_const(128)))))}(),function(){const o=t.addFunction(a+"_UtoLEM");o.addParam("pIn","i32"),o.addParam("pOut","i32");const e=o.getCodeBuilder(),i=t.alloc(2*n),c=e.i32_const(i),l=e.i32_const(i),s=e.i32_const(i+n);o.addCode(e.if(e.i32_and(e.i32_load8_u(e.getLocal("pIn")),e.i32_const(64)),[...e.call(a+"_zeroAffine",e.getLocal("pOut")),...e.ret([])]),e.call(a+"__reverseBytes",e.getLocal("pIn"),e.i32_const(n),l),e.call(a+"__reverseBytes",e.i32_add(e.getLocal("pIn"),e.i32_const(n)),e.i32_const(n),s),e.call(a+"_toMontgomeryAffine",c,e.getLocal("pOut")))}(),function(){const i=t.addFunction(a+"_CtoLEM");i.addParam("pIn","i32"),i.addParam("pOut","i32"),i.addLocal("firstByte","i32"),i.addLocal("greatest","i32");const c=i.getCodeBuilder(),l=t.alloc(2*n),s=c.i32_const(l),r=c.i32_const(l+n);i.addCode(c.setLocal("firstByte",c.i32_load8_u(c.getLocal("pIn"))),c.if(c.i32_and(c.getLocal("firstByte"),c.i32_const(64)),[...c.call(a+"_zeroAffine",c.getLocal("pOut")),...c.ret([])]),c.setLocal("greatest",c.i32_and(c.getLocal("firstByte"),c.i32_const(128))),c.call(o+"_copy",c.getLocal("pIn"),r),c.i32_store8(r,c.i32_and(c.getLocal("firstByte"),c.i32_const(63))),c.call(a+"__reverseBytes",r,c.i32_const(n),s),c.call(o+"_toMontgomery",s,c.getLocal("pOut")),c.call(o+"_square",c.getLocal("pOut"),r),c.call(o+"_mul",c.getLocal("pOut"),r,r),c.call(o+"_add",r,c.i32_const(e),r),c.call(o+"_sqrt",r,r),c.call(o+"_neg",r,s),c.if(c.i32_eq(c.call(o+"_sign",r),c.i32_const(-1)),c.if(c.getLocal("greatest"),c.call(o+"_copy",r,c.i32_add(c.getLocal("pOut"),c.i32_const(n))),c.call(o+"_neg",r,c.i32_add(c.getLocal("pOut"),c.i32_const(n)))),c.if(c.getLocal("greatest"),c.call(o+"_neg",r,c.i32_add(c.getLocal("pOut"),c.i32_const(n))),c.call(o+"_copy",r,c.i32_add(c.getLocal("pOut"),c.i32_const(n))))))}(),zt(t,a+"_batchLEMtoU",a+"_LEMtoU",2*n,2*n),zt(t,a+"_batchLEMtoC",a+"_LEMtoC",2*n,n),zt(t,a+"_batchUtoLEM",a+"_UtoLEM",2*n,2*n),zt(t,a+"_batchCtoLEM",a+"_CtoLEM",n,2*n,!0),zt(t,a+"_batchToJacobian",a+"_toJacobian",2*n,3*n,!0),Mt(t,a,a+"_multiexp",a+"_add",3*n),Mt(t,a,a+"_multiexpAffine",a+"_addMixed",2*n),St(t,a+"_timesScalar",3*n,a+"_add",a+"_double",a+"_sub",a+"_copy",a+"_zero"),St(t,a+"_timesScalarAffine",2*n,a+"_addMixed",a+"_double",a+"_subMixed",a+"_copyAffine",a+"_zero"),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isZeroAffine"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_eqMixed"),t.exportFunction(a+"_eqAffine"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_copyAffine"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_zeroAffine"),t.exportFunction(a+"_double"),t.exportFunction(a+"_doubleAffine"),t.exportFunction(a+"_add"),t.exportFunction(a+"_addMixed"),t.exportFunction(a+"_addAffine"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_negAffine"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_subMixed"),t.exportFunction(a+"_subAffine"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_fromMontgomeryAffine"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_toMontgomeryAffine"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_timesScalarAffine"),t.exportFunction(a+"_normalize"),t.exportFunction(a+"_LEMtoU"),t.exportFunction(a+"_LEMtoC"),t.exportFunction(a+"_UtoLEM"),t.exportFunction(a+"_CtoLEM"),t.exportFunction(a+"_batchLEMtoU"),t.exportFunction(a+"_batchLEMtoC"),t.exportFunction(a+"_batchUtoLEM"),t.exportFunction(a+"_batchCtoLEM"),t.exportFunction(a+"_toAffine"),t.exportFunction(a+"_toJacobian"),t.exportFunction(a+"_batchToAffine"),t.exportFunction(a+"_batchToJacobian"),t.exportFunction(a+"_inCurve"),t.exportFunction(a+"_inCurveAffine"),a};const{isOdd:Gt,modInv:Rt,modPow:Nt}=K,kt=W;var Ut=function(t,a,o,e,i){const n=8*t.modules[e].n64,c=8*t.modules[o].n64,l=t.modules[e].q;let s=l-1n,r=0;for(;!Gt(s);)r++,s>>=1n;let d=2n;for(;1n===Nt(d,l>>1n,l);)d+=1n;const _=new Array(r+1);_[r]=Nt(d,s,l);let u=r-1;for(;u>=0;)_[u]=Nt(_[u+1],2n,l),u--;const g=[],p=(1n<<BigInt(8*n))%l;for(let t=0;t<_.length;t++){const a=_[t]*p%l;g.push(...kt.bigInt2BytesLE(a,n))}const f=t.alloc(g),L=new Array(r+1);L[0]=1n;for(let t=1;t<=r;t++)L[t]=2n*L[t-1];const h=[];for(let t=0;t<=r;t++){const a=Rt(L[t],l)*p%l;h.push(...kt.bigInt2BytesLE(a,n))}const m=t.alloc(h),b=Nt(d,2n,l),y=[],x=[];for(let t=0;t<=r;t++){const a=Nt(b,2n**BigInt(t),l),o=Rt(l+1n-a,l);y.push(...kt.bigInt2BytesLE(a*p%l,n)),x.push(...kt.bigInt2BytesLE(o*p%l,n))}const F=t.alloc(y),C=t.alloc(x);function w(t){let a=0;for(let o=0;o<8;o++)t&1<<o&&(a|=128>>o);return a}const B=Array(256);for(let t=0;t<256;t++)B[t]=w(t);const A=t.alloc(B);function P(){const o=t.addFunction(a+"_fft");o.addParam("px","i32"),o.addParam("n","i32"),o.addLocal("bits","i32");const i=o.getCodeBuilder(),c=i.i32_const(t.alloc(n));o.addCode(i.setLocal("bits",i.call(a+"__log2",i.getLocal("n"))),i.call(e+"_one",c),i.call(a+"_rawfft",i.getLocal("px"),i.getLocal("bits"),i.i32_const(0),c))}!function(){const o=t.addFunction(a+"__rev");o.addParam("x","i32"),o.addParam("bits","i32"),o.setReturnType("i32");const e=o.getCodeBuilder();o.addCode(e.i32_rotl(e.i32_add(e.i32_add(e.i32_shl(e.i32_load8_u(e.i32_and(e.getLocal("x"),e.i32_const(255)),A,0),e.i32_const(24)),e.i32_shl(e.i32_load8_u(e.i32_and(e.i32_shr_u(e.getLocal("x"),e.i32_const(8)),e.i32_const(255)),A,0),e.i32_const(16))),e.i32_add(e.i32_shl(e.i32_load8_u(e.i32_and(e.i32_shr_u(e.getLocal("x"),e.i32_const(16)),e.i32_const(255)),A,0),e.i32_const(8)),e.i32_load8_u(e.i32_and(e.i32_shr_u(e.getLocal("x"),e.i32_const(24)),e.i32_const(255)),A,0))),e.getLocal("bits")))}(),function(){const e=t.addFunction(a+"__reversePermutation");e.addParam("px","i32"),e.addParam("bits","i32"),e.addLocal("n","i32"),e.addLocal("i","i32"),e.addLocal("ri","i32"),e.addLocal("idx1","i32"),e.addLocal("idx2","i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(c));e.addCode(i.setLocal("n",i.i32_shl(i.i32_const(1),i.getLocal("bits"))),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("n"))),i.setLocal("idx1",i.i32_add(i.getLocal("px"),i.i32_mul(i.getLocal("i"),i.i32_const(c)))),i.setLocal("ri",i.call(a+"__rev",i.getLocal("i"),i.getLocal("bits"))),i.setLocal("idx2",i.i32_add(i.getLocal("px"),i.i32_mul(i.getLocal("ri"),i.i32_const(c)))),i.if(i.i32_lt_u(i.getLocal("i"),i.getLocal("ri")),[...i.call(o+"_copy",i.getLocal("idx1"),n),...i.call(o+"_copy",i.getLocal("idx2"),i.getLocal("idx1")),...i.call(o+"_copy",n,i.getLocal("idx2"))]),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))))}(),function(){const n=t.addFunction(a+"__fftFinal");n.addParam("px","i32"),n.addParam("bits","i32"),n.addParam("reverse","i32"),n.addParam("mulFactor","i32"),n.addLocal("n","i32"),n.addLocal("ndiv2","i32"),n.addLocal("pInv2","i32"),n.addLocal("i","i32"),n.addLocal("mask","i32"),n.addLocal("idx1","i32"),n.addLocal("idx2","i32");const l=n.getCodeBuilder(),s=l.i32_const(t.alloc(c));n.addCode(l.if(l.i32_and(l.i32_eqz(l.getLocal("reverse")),l.call(e+"_isOne",l.getLocal("mulFactor"))),l.ret([])),l.setLocal("n",l.i32_shl(l.i32_const(1),l.getLocal("bits"))),l.setLocal("mask",l.i32_sub(l.getLocal("n"),l.i32_const(1))),l.setLocal("i",l.i32_const(1)),l.setLocal("ndiv2",l.i32_shr_u(l.getLocal("n"),l.i32_const(1))),l.block(l.loop(l.br_if(1,l.i32_ge_u(l.getLocal("i"),l.getLocal("ndiv2"))),l.setLocal("idx1",l.i32_add(l.getLocal("px"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("px"),l.i32_mul(l.i32_sub(l.getLocal("n"),l.getLocal("i")),l.i32_const(c)))),l.if(l.getLocal("reverse"),l.if(l.call(e+"_isOne",l.getLocal("mulFactor")),[...l.call(o+"_copy",l.getLocal("idx1"),s),...l.call(o+"_copy",l.getLocal("idx2"),l.getLocal("idx1")),...l.call(o+"_copy",s,l.getLocal("idx2"))],[...l.call(o+"_copy",l.getLocal("idx1"),s),...l.call(i,l.getLocal("idx2"),l.getLocal("mulFactor"),l.getLocal("idx1")),...l.call(i,s,l.getLocal("mulFactor"),l.getLocal("idx2"))]),l.if(l.call(e+"_isOne",l.getLocal("mulFactor")),[],[...l.call(i,l.getLocal("idx1"),l.getLocal("mulFactor"),l.getLocal("idx1")),...l.call(i,l.getLocal("idx2"),l.getLocal("mulFactor"),l.getLocal("idx2"))])),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))),l.if(l.call(e+"_isOne",l.getLocal("mulFactor")),[],[...l.call(i,l.getLocal("px"),l.getLocal("mulFactor"),l.getLocal("px")),...l.setLocal("idx2",l.i32_add(l.getLocal("px"),l.i32_mul(l.getLocal("ndiv2"),l.i32_const(c)))),...l.call(i,l.getLocal("idx2"),l.getLocal("mulFactor"),l.getLocal("idx2"))]))}(),function(){const l=t.addFunction(a+"_rawfft");l.addParam("px","i32"),l.addParam("bits","i32"),l.addParam("reverse","i32"),l.addParam("mulFactor","i32"),l.addLocal("s","i32"),l.addLocal("k","i32"),l.addLocal("j","i32"),l.addLocal("m","i32"),l.addLocal("mdiv2","i32"),l.addLocal("n","i32"),l.addLocal("pwm","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32");const s=l.getCodeBuilder(),r=s.i32_const(t.alloc(n)),d=s.i32_const(t.alloc(c)),_=s.i32_const(t.alloc(c));l.addCode(s.call(a+"__reversePermutation",s.getLocal("px"),s.getLocal("bits")),s.setLocal("n",s.i32_shl(s.i32_const(1),s.getLocal("bits"))),s.setLocal("s",s.i32_const(1)),s.block(s.loop(s.br_if(1,s.i32_gt_u(s.getLocal("s"),s.getLocal("bits"))),s.setLocal("m",s.i32_shl(s.i32_const(1),s.getLocal("s"))),s.setLocal("pwm",s.i32_add(s.i32_const(f),s.i32_mul(s.getLocal("s"),s.i32_const(n)))),s.setLocal("k",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_ge_u(s.getLocal("k"),s.getLocal("n"))),s.call(e+"_one",r),s.setLocal("mdiv2",s.i32_shr_u(s.getLocal("m"),s.i32_const(1))),s.setLocal("j",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_ge_u(s.getLocal("j"),s.getLocal("mdiv2"))),s.setLocal("idx1",s.i32_add(s.getLocal("px"),s.i32_mul(s.i32_add(s.getLocal("k"),s.getLocal("j")),s.i32_const(c)))),s.setLocal("idx2",s.i32_add(s.getLocal("idx1"),s.i32_mul(s.getLocal("mdiv2"),s.i32_const(c)))),s.call(i,s.getLocal("idx2"),r,d),s.call(o+"_copy",s.getLocal("idx1"),_),s.call(o+"_add",_,d,s.getLocal("idx1")),s.call(o+"_sub",_,d,s.getLocal("idx2")),s.call(e+"_mul",r,s.getLocal("pwm"),r),s.setLocal("j",s.i32_add(s.getLocal("j"),s.i32_const(1))),s.br(0))),s.setLocal("k",s.i32_add(s.getLocal("k"),s.getLocal("m"))),s.br(0))),s.setLocal("s",s.i32_add(s.getLocal("s"),s.i32_const(1))),s.br(0))),s.call(a+"__fftFinal",s.getLocal("px"),s.getLocal("bits"),s.getLocal("reverse"),s.getLocal("mulFactor")))}(),function(){const o=t.addFunction(a+"__log2");o.addParam("n","i32"),o.setReturnType("i32"),o.addLocal("bits","i32"),o.addLocal("aux","i32");const e=o.getCodeBuilder();o.addCode(e.setLocal("aux",e.i32_shr_u(e.getLocal("n"),e.i32_const(1)))),o.addCode(e.setLocal("bits",e.i32_const(0))),o.addCode(e.block(e.loop(e.br_if(1,e.i32_eqz(e.getLocal("aux"))),e.setLocal("aux",e.i32_shr_u(e.getLocal("aux"),e.i32_const(1))),e.setLocal("bits",e.i32_add(e.getLocal("bits"),e.i32_const(1))),e.br(0)))),o.addCode(e.if(e.i32_ne(e.getLocal("n"),e.i32_shl(e.i32_const(1),e.getLocal("bits"))),e.unreachable())),o.addCode(e.if(e.i32_gt_u(e.getLocal("bits"),e.i32_const(r)),e.unreachable())),o.addCode(e.getLocal("bits"))}(),P(),function(){const o=t.addFunction(a+"_ifft");o.addParam("px","i32"),o.addParam("n","i32"),o.addLocal("bits","i32"),o.addLocal("pInv2","i32");const e=o.getCodeBuilder();o.addCode(e.setLocal("bits",e.call(a+"__log2",e.getLocal("n"))),e.setLocal("pInv2",e.i32_add(e.i32_const(m),e.i32_mul(e.getLocal("bits"),e.i32_const(n)))),e.call(a+"_rawfft",e.getLocal("px"),e.getLocal("bits"),e.i32_const(1),e.getLocal("pInv2")))}(),function(){const l=t.addFunction(a+"_fftJoin");l.addParam("pBuff1","i32"),l.addParam("pBuff2","i32"),l.addParam("n","i32"),l.addParam("first","i32"),l.addParam("inc","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32");const s=l.getCodeBuilder(),r=s.i32_const(t.alloc(n)),d=s.i32_const(t.alloc(c)),_=s.i32_const(t.alloc(c));l.addCode(s.call(e+"_copy",s.getLocal("first"),r),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.setLocal("idx1",s.i32_add(s.getLocal("pBuff1"),s.i32_mul(s.getLocal("i"),s.i32_const(c)))),s.setLocal("idx2",s.i32_add(s.getLocal("pBuff2"),s.i32_mul(s.getLocal("i"),s.i32_const(c)))),s.call(i,s.getLocal("idx2"),r,d),s.call(o+"_copy",s.getLocal("idx1"),_),s.call(o+"_add",_,d,s.getLocal("idx1")),s.call(o+"_sub",_,d,s.getLocal("idx2")),s.call(e+"_mul",r,s.getLocal("inc"),r),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))))}(),function(){const l=t.addFunction(a+"_fftJoinExt");l.addParam("pBuff1","i32"),l.addParam("pBuff2","i32"),l.addParam("n","i32"),l.addParam("first","i32"),l.addParam("inc","i32"),l.addParam("totalBits","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32"),l.addLocal("pShiftToM","i32");const s=l.getCodeBuilder(),r=s.i32_const(t.alloc(n)),d=s.i32_const(t.alloc(c));l.addCode(s.setLocal("pShiftToM",s.i32_add(s.i32_const(F),s.i32_mul(s.getLocal("totalBits"),s.i32_const(n)))),s.call(e+"_copy",s.getLocal("first"),r),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.setLocal("idx1",s.i32_add(s.getLocal("pBuff1"),s.i32_mul(s.getLocal("i"),s.i32_const(c)))),s.setLocal("idx2",s.i32_add(s.getLocal("pBuff2"),s.i32_mul(s.getLocal("i"),s.i32_const(c)))),s.call(o+"_add",s.getLocal("idx1"),s.getLocal("idx2"),d),s.call(i,s.getLocal("idx2"),s.getLocal("pShiftToM"),s.getLocal("idx2")),s.call(o+"_add",s.getLocal("idx1"),s.getLocal("idx2"),s.getLocal("idx2")),s.call(i,s.getLocal("idx2"),r,s.getLocal("idx2")),s.call(o+"_copy",d,s.getLocal("idx1")),s.call(e+"_mul",r,s.getLocal("inc"),r),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))))}(),function(){const l=t.addFunction(a+"_fftJoinExtInv");l.addParam("pBuff1","i32"),l.addParam("pBuff2","i32"),l.addParam("n","i32"),l.addParam("first","i32"),l.addParam("inc","i32"),l.addParam("totalBits","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32"),l.addLocal("pShiftToM","i32"),l.addLocal("pSConst","i32");const s=l.getCodeBuilder(),r=s.i32_const(t.alloc(n)),d=s.i32_const(t.alloc(c));l.addCode(s.setLocal("pShiftToM",s.i32_add(s.i32_const(F),s.i32_mul(s.getLocal("totalBits"),s.i32_const(n)))),s.setLocal("pSConst",s.i32_add(s.i32_const(C),s.i32_mul(s.getLocal("totalBits"),s.i32_const(n)))),s.call(e+"_copy",s.getLocal("first"),r),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.setLocal("idx1",s.i32_add(s.getLocal("pBuff1"),s.i32_mul(s.getLocal("i"),s.i32_const(c)))),s.setLocal("idx2",s.i32_add(s.getLocal("pBuff2"),s.i32_mul(s.getLocal("i"),s.i32_const(c)))),s.call(i,s.getLocal("idx2"),r,d),s.call(o+"_sub",s.getLocal("idx1"),d,s.getLocal("idx2")),s.call(i,s.getLocal("idx2"),s.getLocal("pSConst"),s.getLocal("idx2")),s.call(i,s.getLocal("idx1"),s.getLocal("pShiftToM"),s.getLocal("idx1")),s.call(o+"_sub",d,s.getLocal("idx1"),s.getLocal("idx1")),s.call(i,s.getLocal("idx1"),s.getLocal("pSConst"),s.getLocal("idx1")),s.call(e+"_mul",r,s.getLocal("inc"),r),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))))}(),function(){const l=t.addFunction(a+"_fftMix");l.addParam("pBuff","i32"),l.addParam("n","i32"),l.addParam("exp","i32"),l.addLocal("nGroups","i32"),l.addLocal("nPerGroup","i32"),l.addLocal("nPerGroupDiv2","i32"),l.addLocal("pairOffset","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32"),l.addLocal("j","i32"),l.addLocal("pwm","i32");const s=l.getCodeBuilder(),r=s.i32_const(t.alloc(n)),d=s.i32_const(t.alloc(c)),_=s.i32_const(t.alloc(c));l.addCode(s.setLocal("nPerGroup",s.i32_shl(s.i32_const(1),s.getLocal("exp"))),s.setLocal("nPerGroupDiv2",s.i32_shr_u(s.getLocal("nPerGroup"),s.i32_const(1))),s.setLocal("nGroups",s.i32_shr_u(s.getLocal("n"),s.getLocal("exp"))),s.setLocal("pairOffset",s.i32_mul(s.getLocal("nPerGroupDiv2"),s.i32_const(c))),s.setLocal("pwm",s.i32_add(s.i32_const(f),s.i32_mul(s.getLocal("exp"),s.i32_const(n)))),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nGroups"))),s.call(e+"_one",r),s.setLocal("j",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("j"),s.getLocal("nPerGroupDiv2"))),s.setLocal("idx1",s.i32_add(s.getLocal("pBuff"),s.i32_mul(s.i32_add(s.i32_mul(s.getLocal("i"),s.getLocal("nPerGroup")),s.getLocal("j")),s.i32_const(c)))),s.setLocal("idx2",s.i32_add(s.getLocal("idx1"),s.getLocal("pairOffset"))),s.call(i,s.getLocal("idx2"),r,d),s.call(o+"_copy",s.getLocal("idx1"),_),s.call(o+"_add",_,d,s.getLocal("idx1")),s.call(o+"_sub",_,d,s.getLocal("idx2")),s.call(e+"_mul",r,s.getLocal("pwm"),r),s.setLocal("j",s.i32_add(s.getLocal("j"),s.i32_const(1))),s.br(0))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))))}(),function(){const e=t.addFunction(a+"_fftFinal");e.addParam("pBuff","i32"),e.addParam("n","i32"),e.addParam("factor","i32"),e.addLocal("idx1","i32"),e.addLocal("idx2","i32"),e.addLocal("i","i32"),e.addLocal("ndiv2","i32");const n=e.getCodeBuilder(),l=n.i32_const(t.alloc(c));e.addCode(n.setLocal("ndiv2",n.i32_shr_u(n.getLocal("n"),n.i32_const(1))),n.if(n.i32_and(n.getLocal("n"),n.i32_const(1)),n.call(i,n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("ndiv2"),n.i32_const(c))),n.getLocal("factor"),n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("ndiv2"),n.i32_const(c))))),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_ge_u(n.getLocal("i"),n.getLocal("ndiv2"))),n.setLocal("idx1",n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("i"),n.i32_const(c)))),n.setLocal("idx2",n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.i32_sub(n.i32_sub(n.getLocal("n"),n.i32_const(1)),n.getLocal("i")),n.i32_const(c)))),n.call(i,n.getLocal("idx2"),n.getLocal("factor"),l),n.call(i,n.getLocal("idx1"),n.getLocal("factor"),n.getLocal("idx2")),n.call(o+"_copy",l,n.getLocal("idx1")),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),function(){const l=t.addFunction(a+"_prepareLagrangeEvaluation");l.addParam("pBuff1","i32"),l.addParam("pBuff2","i32"),l.addParam("n","i32"),l.addParam("first","i32"),l.addParam("inc","i32"),l.addParam("totalBits","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32"),l.addLocal("pShiftToM","i32"),l.addLocal("pSConst","i32");const s=l.getCodeBuilder(),r=s.i32_const(t.alloc(n)),d=s.i32_const(t.alloc(c));l.addCode(s.setLocal("pShiftToM",s.i32_add(s.i32_const(F),s.i32_mul(s.getLocal("totalBits"),s.i32_const(n)))),s.setLocal("pSConst",s.i32_add(s.i32_const(C),s.i32_mul(s.getLocal("totalBits"),s.i32_const(n)))),s.call(e+"_copy",s.getLocal("first"),r),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.setLocal("idx1",s.i32_add(s.getLocal("pBuff1"),s.i32_mul(s.getLocal("i"),s.i32_const(c)))),s.setLocal("idx2",s.i32_add(s.getLocal("pBuff2"),s.i32_mul(s.getLocal("i"),s.i32_const(c)))),s.call(i,s.getLocal("idx1"),s.getLocal("pShiftToM"),d),s.call(o+"_sub",s.getLocal("idx2"),d,d),s.call(o+"_sub",s.getLocal("idx1"),s.getLocal("idx2"),s.getLocal("idx2")),s.call(i,d,s.getLocal("pSConst"),s.getLocal("idx1")),s.call(i,s.getLocal("idx2"),r,s.getLocal("idx2")),s.call(e+"_mul",r,s.getLocal("inc"),r),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))))}(),t.exportFunction(a+"_fft"),t.exportFunction(a+"_ifft"),t.exportFunction(a+"_rawfft"),t.exportFunction(a+"_fftJoin"),t.exportFunction(a+"_fftJoinExt"),t.exportFunction(a+"_fftJoinExtInv"),t.exportFunction(a+"_fftMix"),t.exportFunction(a+"_fftFinal"),t.exportFunction(a+"_prepareLagrangeEvaluation")},jt=function(t,a,o){const e=8*t.modules[o].n64;return function(){const i=t.addFunction(a+"_zero");i.addParam("px","i32"),i.addParam("n","i32"),i.addLocal("lastp","i32"),i.addLocal("p","i32");const n=i.getCodeBuilder();i.addCode(n.setLocal("p",n.getLocal("px")),n.setLocal("lastp",n.i32_add(n.getLocal("px"),n.i32_mul(n.getLocal("n"),n.i32_const(e)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("p"),n.getLocal("lastp"))),n.call(o+"_zero",n.getLocal("p")),n.setLocal("p",n.i32_add(n.getLocal("p"),n.i32_const(e))),n.br(0))))}(),function(){const i=t.addFunction(a+"_constructLC");i.addParam("ppolynomials","i32"),i.addParam("psignals","i32"),i.addParam("nSignals","i32"),i.addParam("pres","i32"),i.addLocal("i","i32"),i.addLocal("j","i32"),i.addLocal("pp","i32"),i.addLocal("ps","i32"),i.addLocal("pd","i32"),i.addLocal("ncoefs","i32");const n=i.getCodeBuilder(),c=n.i32_const(t.alloc(e));i.addCode(n.setLocal("i",n.i32_const(0)),n.setLocal("pp",n.getLocal("ppolynomials")),n.setLocal("ps",n.getLocal("psignals")),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("nSignals"))),n.setLocal("ncoefs",n.i32_load(n.getLocal("pp"))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.setLocal("j",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("j"),n.getLocal("ncoefs"))),n.setLocal("pd",n.i32_add(n.getLocal("pres"),n.i32_mul(n.i32_load(n.getLocal("pp")),n.i32_const(e)))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.call(o+"_mul",n.getLocal("ps"),n.getLocal("pp"),c),n.call(o+"_add",c,n.getLocal("pd"),n.getLocal("pd")),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(e))),n.setLocal("j",n.i32_add(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.setLocal("ps",n.i32_add(n.getLocal("ps"),n.i32_const(e))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),t.exportFunction(a+"_zero"),t.exportFunction(a+"_constructLC"),a},Zt=function(t,a,o){const e=8*t.modules[o].n64;return function(){const i=t.addFunction(a+"_buildABC");i.addParam("pCoefs","i32"),i.addParam("nCoefs","i32"),i.addParam("pWitness","i32"),i.addParam("pA","i32"),i.addParam("pB","i32"),i.addParam("pC","i32"),i.addParam("offsetOut","i32"),i.addParam("nOut","i32"),i.addParam("offsetWitness","i32"),i.addParam("nWitness","i32"),i.addLocal("it","i32"),i.addLocal("ita","i32"),i.addLocal("itb","i32"),i.addLocal("last","i32"),i.addLocal("m","i32"),i.addLocal("c","i32"),i.addLocal("s","i32"),i.addLocal("pOut","i32");const n=i.getCodeBuilder(),c=n.i32_const(t.alloc(e));i.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(e)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(o+"_zero",n.getLocal("ita")),n.call(o+"_zero",n.getLocal("itb")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(e))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(e))),n.br(0))),n.setLocal("it",n.getLocal("pCoefs")),n.setLocal("last",n.i32_add(n.getLocal("pCoefs"),n.i32_mul(n.getLocal("nCoefs"),n.i32_const(e+12)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("it"),n.getLocal("last"))),n.setLocal("s",n.i32_load(n.getLocal("it"),8)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_ge_u(n.getLocal("s"),n.i32_add(n.getLocal("offsetWitness"),n.getLocal("nWitness")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(e+12))),...n.br(1)]),n.setLocal("m",n.i32_load(n.getLocal("it"))),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(0)),n.setLocal("pOut",n.getLocal("pA")),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(1)),n.setLocal("pOut",n.getLocal("pB")),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(e+12))),...n.br(1)])),n.setLocal("c",n.i32_load(n.getLocal("it"),4)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_ge_u(n.getLocal("c"),n.i32_add(n.getLocal("offsetOut"),n.getLocal("nOut")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(e+12))),...n.br(1)]),n.setLocal("pOut",n.i32_add(n.getLocal("pOut"),n.i32_mul(n.i32_sub(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_const(e)))),n.call(o+"_mul",n.i32_add(n.getLocal("pWitness"),n.i32_mul(n.i32_sub(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_const(e))),n.i32_add(n.getLocal("it"),n.i32_const(12)),c),n.call(o+"_add",n.getLocal("pOut"),c,n.getLocal("pOut")),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(e+12))),n.br(0))),n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("it",n.getLocal("pC")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(e)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(o+"_mul",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("it")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(e))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(e))),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(e))),n.br(0))))}(),function(){const i=t.addFunction(a+"_joinABC");i.addParam("pA","i32"),i.addParam("pB","i32"),i.addParam("pC","i32"),i.addParam("n","i32"),i.addParam("pP","i32"),i.addLocal("ita","i32"),i.addLocal("itb","i32"),i.addLocal("itc","i32"),i.addLocal("itp","i32"),i.addLocal("last","i32");const n=i.getCodeBuilder(),c=n.i32_const(t.alloc(e));i.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("itc",n.getLocal("pC")),n.setLocal("itp",n.getLocal("pP")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("n"),n.i32_const(e)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(o+"_mul",n.getLocal("ita"),n.getLocal("itb"),c),n.call(o+"_sub",c,n.getLocal("itc"),n.getLocal("itp")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(e))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(e))),n.setLocal("itc",n.i32_add(n.getLocal("itc"),n.i32_const(e))),n.setLocal("itp",n.i32_add(n.getLocal("itp"),n.i32_const(e))),n.br(0))))}(),function(){const i=t.addFunction(a+"_batchAdd");i.addParam("pa","i32"),i.addParam("pb","i32"),i.addParam("n","i32"),i.addParam("pr","i32"),i.addLocal("ita","i32"),i.addLocal("itb","i32"),i.addLocal("itr","i32"),i.addLocal("last","i32");const n=i.getCodeBuilder();i.addCode(n.setLocal("ita",n.getLocal("pa")),n.setLocal("itb",n.getLocal("pb")),n.setLocal("itr",n.getLocal("pr")),n.setLocal("last",n.i32_add(n.getLocal("pa"),n.i32_mul(n.getLocal("n"),n.i32_const(e)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(o+"_add",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("itr")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(e))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(e))),n.setLocal("itr",n.i32_add(n.getLocal("itr"),n.i32_const(e))),n.br(0))))}(),t.exportFunction(a+"_buildABC"),t.exportFunction(a+"_joinABC"),t.exportFunction(a+"_batchAdd"),a},$t=function(t,a,o,e,i,n,c,l){const s=t.addFunction(a);s.addParam("pIn","i32"),s.addParam("n","i32"),s.addParam("pFirst","i32"),s.addParam("pInc","i32"),s.addParam("pOut","i32"),s.addLocal("pOldFree","i32"),s.addLocal("i","i32"),s.addLocal("pFrom","i32"),s.addLocal("pTo","i32");const r=s.getCodeBuilder(),d=r.i32_const(t.alloc(c));s.addCode(r.setLocal("pFrom",r.getLocal("pIn")),r.setLocal("pTo",r.getLocal("pOut"))),s.addCode(r.call(e+"_copy",r.getLocal("pFirst"),d)),s.addCode(r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(l,r.getLocal("pFrom"),d,r.getLocal("pTo")),r.setLocal("pFrom",r.i32_add(r.getLocal("pFrom"),r.i32_const(i))),r.setLocal("pTo",r.i32_add(r.getLocal("pTo"),r.i32_const(n))),r.call(e+"_mul",d,r.getLocal("pInc"),d),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))),t.exportFunction(a)};const Wt=W,Vt=Ft,Qt=Bt,Jt=It,Dt=Ot,Kt=Tt,Xt=Ut,Yt=jt,Ht=Zt,ta=$t,{bitLength:aa,modInv:oa,isOdd:ea,isNegative:ia}=K;const na=W,ca=Ft,la=Bt,sa=It,ra=Ot,da=Tt,_a=Ut,ua=jt,ga=Zt,pa=$t,{bitLength:fa,isOdd:La,isNegative:ha}=K;var ma=function(t,a){const o=a||"bn128";if(t.modules[o])return o;const e=21888242871839275222246405745257275088696311157297823662689037894645226208583n,i=21888242871839275222246405745257275088548364400416034343698204186575808495617n,n=Math.floor((aa(e-1n)-1)/64)+1,c=8*n,l=c,s=c,r=2*s,d=12*s,_=t.alloc(Wt.bigInt2BytesLE(i,l)),u=Vt(t,e,"f1m");Qt(t,i,"fr","frm");const g=t.alloc(Wt.bigInt2BytesLE(b(3n),s)),p=Kt(t,"g1m","f1m",g);Xt(t,"frm","frm","frm","frm_mul"),Yt(t,"pol","frm"),Ht(t,"qap","frm");const f=Jt(t,"f1m_neg","f2m","f1m"),L=t.alloc([...Wt.bigInt2BytesLE(b(19485874751759354771024239261021720505790618469301721065564631296452457478373n),s),...Wt.bigInt2BytesLE(b(266929791119991161246907387137283842545076965332900288569378510910307636690n),s)]),h=Kt(t,"g2m","f2m",L);function m(a,o){const e=t.addFunction(a);e.addParam("pG","i32"),e.addParam("pFr","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(c));e.addCode(i.call("frm_fromMontgomery",i.getLocal("pFr"),n),i.call(o,i.getLocal("pG"),n,i.i32_const(c),i.getLocal("pr"))),t.exportFunction(a)}function b(t){return BigInt(t)*(1n<<BigInt(8*s))%e}m("g1m_timesFr","g1m_timesScalar"),Xt(t,"g1m","g1m","frm","g1m_timesFr"),m("g2m_timesFr","g2m_timesScalar"),Xt(t,"g2m","g2m","frm","g2m_timesFr"),m("g1m_timesFrAffine","g1m_timesScalarAffine"),m("g2m_timesFrAffine","g2m_timesScalarAffine"),ta(t,"frm_batchApplyKey","fmr","frm",c,c,c,"frm_mul"),ta(t,"g1m_batchApplyKey","g1m","frm",3*c,3*c,c,"g1m_timesFr"),ta(t,"g1m_batchApplyKeyMixed","g1m","frm",2*c,3*c,c,"g1m_timesFrAffine"),ta(t,"g2m_batchApplyKey","g2m","frm",2*c*3,3*c*2,c,"g2m_timesFr"),ta(t,"g2m_batchApplyKeyMixed","g2m","frm",2*c*2,3*c*2,c,"g2m_timesFrAffine");const y=[1n,2n,1n],x=t.alloc([...Wt.bigInt2BytesLE(b(y[0]),s),...Wt.bigInt2BytesLE(b(y[1]),s),...Wt.bigInt2BytesLE(b(y[2]),s)]),F=[0n,1n,0n],C=t.alloc([...Wt.bigInt2BytesLE(b(F[0]),s),...Wt.bigInt2BytesLE(b(F[1]),s),...Wt.bigInt2BytesLE(b(F[2]),s)]),w=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],B=t.alloc([...Wt.bigInt2BytesLE(b(w[0][0]),s),...Wt.bigInt2BytesLE(b(w[0][1]),s),...Wt.bigInt2BytesLE(b(w[1][0]),s),...Wt.bigInt2BytesLE(b(w[1][1]),s),...Wt.bigInt2BytesLE(b(w[2][0]),s),...Wt.bigInt2BytesLE(b(w[2][1]),s)]),A=[[0n,0n],[1n,0n],[0n,0n]],P=t.alloc([...Wt.bigInt2BytesLE(b(A[0][0]),s),...Wt.bigInt2BytesLE(b(A[0][1]),s),...Wt.bigInt2BytesLE(b(A[1][0]),s),...Wt.bigInt2BytesLE(b(A[1][1]),s),...Wt.bigInt2BytesLE(b(A[2][0]),s),...Wt.bigInt2BytesLE(b(A[2][1]),s)]),v=t.alloc([...Wt.bigInt2BytesLE(b(1),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s),...Wt.bigInt2BytesLE(b(0),s)]),I=t.alloc([...Wt.bigInt2BytesLE(b(9),s),...Wt.bigInt2BytesLE(b(1),s)]),q=t.alloc([...Wt.bigInt2BytesLE(b(oa(2n,e)),s),...Wt.bigInt2BytesLE(0n,s)]),E=I,O=t.alloc([...Wt.bigInt2BytesLE(b(19485874751759354771024239261021720505790618469301721065564631296452457478373n),s),...Wt.bigInt2BytesLE(b(266929791119991161246907387137283842545076965332900288569378510910307636690n),s)]);!function(){const a=t.addFunction(o+"_mulNR6");a.addParam("x","i32"),a.addParam("pr","i32");const e=a.getCodeBuilder();a.addCode(e.call(f+"_mul",e.i32_const(I),e.getLocal("x"),e.getLocal("pr")))}();const S=Dt(t,o+"_mulNR6","f6m","f2m");!function(){const a=t.addFunction(o+"_mulNR12");a.addParam("x","i32"),a.addParam("pr","i32");const e=a.getCodeBuilder();a.addCode(e.call(f+"_mul",e.i32_const(I),e.i32_add(e.getLocal("x"),e.i32_const(4*c)),e.getLocal("pr")),e.call(f+"_copy",e.getLocal("x"),e.i32_add(e.getLocal("pr"),e.i32_const(2*c))),e.call(f+"_copy",e.i32_add(e.getLocal("x"),e.i32_const(2*c)),e.i32_add(e.getLocal("pr"),e.i32_const(4*c))))}();const z=Jt(t,o+"_mulNR12","ftm",S),M=function(t){let a=t;const o=[];for(;a>0n;)ea(a)?o.push(1):o.push(0),a>>=1n;return o}(29793968203157093288n),T=t.alloc(M),G=3*r,R=M.length-1,N=M.reduce(((t,a)=>t+(0!=a?1:0)),0),k=6*c,U=3*c*2+(N+R+1)*G;t.modules[o]={n64:n,pG1gen:x,pG1zero:C,pG1b:g,pG2gen:B,pG2zero:P,pG2b:L,pq:t.modules.f1m.pq,pr:_,pOneT:v,prePSize:k,preQSize:U,r:i.toString(),q:e.toString()};const j=4965661367192848881n;function Z(a){const i=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],n=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],c=t.addFunction(o+"__frobeniusMap"+a);c.addParam("x","i32"),c.addParam("r","i32");const l=c.getCodeBuilder();for(let o=0;o<6;o++){const e=0==o?l.getLocal("x"):l.i32_add(l.getLocal("x"),l.i32_const(o*r)),_=e,g=l.i32_add(l.getLocal("x"),l.i32_const(o*r+s)),p=0==o?l.getLocal("r"):l.i32_add(l.getLocal("r"),l.i32_const(o*r)),L=p,h=l.i32_add(l.getLocal("r"),l.i32_const(o*r+s)),m=d(i[Math.floor(o/3)][a%12],n[o%3][a%6]),y=t.alloc([...Wt.bigInt2BytesLE(b(m[0]),32),...Wt.bigInt2BytesLE(b(m[1]),32)]);a%2==1?c.addCode(l.call(u+"_copy",_,L),l.call(u+"_neg",g,h),l.call(f+"_mul",p,l.i32_const(y),p)):c.addCode(l.call(f+"_mul",e,l.i32_const(y),p))}function d(t,a){const o=BigInt(t[0]),i=BigInt(t[1]),n=BigInt(a[0]),c=BigInt(a[1]),l=[(o*n-i*c)%e,(o*c+i*n)%e];return ia(l[0])&&(l[0]=l[0]+e),l}}function $(a,e){const i=function(t){let a=t;const o=[];for(;a>0n;){if(ea(a)){const t=2-Number(a%4n);o.push(t),a-=BigInt(t)}else o.push(0);a>>=1n}return o}(a).map((t=>-1==t?255:t)),n=t.alloc(i),c=t.addFunction(o+"__cyclotomicExp_"+e);c.addParam("x","i32"),c.addParam("r","i32"),c.addLocal("bit","i32"),c.addLocal("i","i32");const l=c.getCodeBuilder(),s=l.getLocal("x"),r=l.getLocal("r"),_=l.i32_const(t.alloc(d));c.addCode(l.call(z+"_conjugate",s,_),l.call(z+"_one",r),l.if(l.teeLocal("bit",l.i32_load8_s(l.i32_const(i.length-1),n)),l.if(l.i32_eq(l.getLocal("bit"),l.i32_const(1)),l.call(z+"_mul",r,s,r),l.call(z+"_mul",r,_,r))),l.setLocal("i",l.i32_const(i.length-2)),l.block(l.loop(l.call(o+"__cyclotomicSquare",r,r),l.if(l.teeLocal("bit",l.i32_load8_s(l.getLocal("i"),n)),l.if(l.i32_eq(l.getLocal("bit"),l.i32_const(1)),l.call(z+"_mul",r,s,r),l.call(z+"_mul",r,_,r))),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0))))}function W(){!function(){const a=t.addFunction(o+"__cyclotomicSquare");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.getLocal("x"),n=e.i32_add(e.getLocal("x"),e.i32_const(r)),c=e.i32_add(e.getLocal("x"),e.i32_const(2*r)),l=e.i32_add(e.getLocal("x"),e.i32_const(3*r)),s=e.i32_add(e.getLocal("x"),e.i32_const(4*r)),d=e.i32_add(e.getLocal("x"),e.i32_const(5*r)),_=e.getLocal("r"),u=e.i32_add(e.getLocal("r"),e.i32_const(r)),g=e.i32_add(e.getLocal("r"),e.i32_const(2*r)),p=e.i32_add(e.getLocal("r"),e.i32_const(3*r)),L=e.i32_add(e.getLocal("r"),e.i32_const(4*r)),h=e.i32_add(e.getLocal("r"),e.i32_const(5*r)),m=e.i32_const(t.alloc(r)),b=e.i32_const(t.alloc(r)),y=e.i32_const(t.alloc(r)),x=e.i32_const(t.alloc(r)),F=e.i32_const(t.alloc(r)),C=e.i32_const(t.alloc(r)),w=e.i32_const(t.alloc(r)),B=e.i32_const(t.alloc(r));a.addCode(e.call(f+"_mul",i,s,w),e.call(f+"_mul",s,e.i32_const(I),m),e.call(f+"_add",i,m,m),e.call(f+"_add",i,s,B),e.call(f+"_mul",B,m,m),e.call(f+"_mul",e.i32_const(I),w,B),e.call(f+"_add",w,B,B),e.call(f+"_sub",m,B,m),e.call(f+"_add",w,w,b),e.call(f+"_mul",l,c,w),e.call(f+"_mul",c,e.i32_const(I),y),e.call(f+"_add",l,y,y),e.call(f+"_add",l,c,B),e.call(f+"_mul",B,y,y),e.call(f+"_mul",e.i32_const(I),w,B),e.call(f+"_add",w,B,B),e.call(f+"_sub",y,B,y),e.call(f+"_add",w,w,x),e.call(f+"_mul",n,d,w),e.call(f+"_mul",d,e.i32_const(I),F),e.call(f+"_add",n,F,F),e.call(f+"_add",n,d,B),e.call(f+"_mul",B,F,F),e.call(f+"_mul",e.i32_const(I),w,B),e.call(f+"_add",w,B,B),e.call(f+"_sub",F,B,F),e.call(f+"_add",w,w,C),e.call(f+"_sub",m,i,_),e.call(f+"_add",_,_,_),e.call(f+"_add",m,_,_),e.call(f+"_add",b,s,L),e.call(f+"_add",L,L,L),e.call(f+"_add",b,L,L),e.call(f+"_mul",C,e.i32_const(E),B),e.call(f+"_add",B,l,p),e.call(f+"_add",p,p,p),e.call(f+"_add",B,p,p),e.call(f+"_sub",F,c,g),e.call(f+"_add",g,g,g),e.call(f+"_add",F,g,g),e.call(f+"_sub",y,n,u),e.call(f+"_add",u,u,u),e.call(f+"_add",y,u,u),e.call(f+"_add",x,d,h),e.call(f+"_add",h,h,h),e.call(f+"_add",x,h,h))}(),$(j,"w0");const a=t.addFunction(o+"__finalExponentiationLastChunk");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.getLocal("x"),n=e.getLocal("r"),c=e.i32_const(t.alloc(d)),l=e.i32_const(t.alloc(d)),s=e.i32_const(t.alloc(d)),_=e.i32_const(t.alloc(d)),u=e.i32_const(t.alloc(d)),g=e.i32_const(t.alloc(d)),p=e.i32_const(t.alloc(d)),L=e.i32_const(t.alloc(d)),h=e.i32_const(t.alloc(d)),m=e.i32_const(t.alloc(d)),b=e.i32_const(t.alloc(d)),y=e.i32_const(t.alloc(d)),x=e.i32_const(t.alloc(d)),F=e.i32_const(t.alloc(d)),C=e.i32_const(t.alloc(d)),w=e.i32_const(t.alloc(d)),B=e.i32_const(t.alloc(d)),A=e.i32_const(t.alloc(d)),P=e.i32_const(t.alloc(d)),v=e.i32_const(t.alloc(d)),q=e.i32_const(t.alloc(d));a.addCode(e.call(o+"__cyclotomicExp_w0",i,c),e.call(z+"_conjugate",c,c),e.call(o+"__cyclotomicSquare",c,l),e.call(o+"__cyclotomicSquare",l,s),e.call(z+"_mul",s,l,_),e.call(o+"__cyclotomicExp_w0",_,u),e.call(z+"_conjugate",u,u),e.call(o+"__cyclotomicSquare",u,g),e.call(o+"__cyclotomicExp_w0",g,p),e.call(z+"_conjugate",p,p),e.call(z+"_conjugate",_,L),e.call(z+"_conjugate",p,h),e.call(z+"_mul",h,u,m),e.call(z+"_mul",m,L,b),e.call(z+"_mul",b,l,y),e.call(z+"_mul",b,u,x),e.call(z+"_mul",x,i,F),e.call(o+"__frobeniusMap1",y,C),e.call(z+"_mul",C,F,w),e.call(o+"__frobeniusMap2",b,B),e.call(z+"_mul",B,w,A),e.call(z+"_conjugate",i,P),e.call(z+"_mul",P,y,v),e.call(o+"__frobeniusMap3",v,q),e.call(z+"_mul",q,A,n))}const V=t.alloc(k),Q=t.alloc(U);function J(a){const e=t.addFunction(o+"_pairingEq"+a);for(let t=0;t<a;t++)e.addParam("p_"+t,"i32"),e.addParam("q_"+t,"i32");e.addParam("c","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(d)),c=i.i32_const(t.alloc(d));e.addCode(i.call(z+"_one",n));for(let t=0;t<a;t++)e.addCode(i.call(o+"_prepareG1",i.getLocal("p_"+t),i.i32_const(V))),e.addCode(i.call(o+"_prepareG2",i.getLocal("q_"+t),i.i32_const(Q))),e.addCode(i.call(o+"_millerLoop",i.i32_const(V),i.i32_const(Q),c)),e.addCode(i.call(z+"_mul",n,c,n));e.addCode(i.call(o+"_finalExponentiation",n,n)),e.addCode(i.call(z+"_eq",n,i.getLocal("c")))}!function(){const a=t.addFunction(o+"_prepAddStep");a.addParam("pQ","i32"),a.addParam("pR","i32"),a.addParam("pCoef","i32");const e=a.getCodeBuilder(),i=e.getLocal("pQ"),n=e.i32_add(e.getLocal("pQ"),e.i32_const(r)),c=e.getLocal("pR"),l=e.i32_add(e.getLocal("pR"),e.i32_const(r)),s=e.i32_add(e.getLocal("pR"),e.i32_const(2*r)),d=e.getLocal("pCoef"),_=e.i32_add(e.getLocal("pCoef"),e.i32_const(r)),u=e.i32_add(e.getLocal("pCoef"),e.i32_const(2*r)),g=_,p=e.i32_const(t.alloc(r)),L=e.i32_const(t.alloc(r)),h=e.i32_const(t.alloc(r)),m=e.i32_const(t.alloc(r)),b=e.i32_const(t.alloc(r)),y=e.i32_const(t.alloc(r)),x=e.i32_const(t.alloc(r));a.addCode(e.call(f+"_mul",i,s,g),e.call(f+"_sub",c,g,g),e.call(f+"_mul",n,s,p),e.call(f+"_sub",l,p,p),e.call(f+"_square",g,L),e.call(f+"_square",p,h),e.call(f+"_mul",g,L,m),e.call(f+"_mul",c,L,b),e.call(f+"_add",b,b,x),e.call(f+"_mul",s,h,y),e.call(f+"_add",m,y,y),e.call(f+"_sub",y,x,y),e.call(f+"_mul",g,y,c),e.call(f+"_mul",m,l,l),e.call(f+"_sub",b,y,x),e.call(f+"_mul",p,x,x),e.call(f+"_sub",x,l,l),e.call(f+"_mul",s,m,s),e.call(f+"_mul",g,n,x),e.call(f+"_mul",p,i,d),e.call(f+"_sub",d,x,d),e.call(f+"_mul",d,e.i32_const(E),d),e.call(f+"_neg",p,u))}(),function(){const a=t.addFunction(o+"_prepDblStep");a.addParam("pR","i32"),a.addParam("pCoef","i32");const e=a.getCodeBuilder(),i=e.getLocal("pR"),n=e.i32_add(e.getLocal("pR"),e.i32_const(r)),c=e.i32_add(e.getLocal("pR"),e.i32_const(2*r)),l=e.getLocal("pCoef"),s=e.i32_add(e.getLocal("pCoef"),e.i32_const(r)),d=e.i32_add(e.getLocal("pCoef"),e.i32_const(2*r)),_=e.i32_const(t.alloc(r)),u=e.i32_const(t.alloc(r)),g=e.i32_const(t.alloc(r)),p=e.i32_const(t.alloc(r)),L=e.i32_const(t.alloc(r)),h=e.i32_const(t.alloc(r)),m=e.i32_const(t.alloc(r)),b=e.i32_const(t.alloc(r)),y=e.i32_const(t.alloc(r)),x=e.i32_const(t.alloc(r)),F=e.i32_const(t.alloc(r)),C=e.i32_const(t.alloc(r));a.addCode(e.call(f+"_mul",n,e.i32_const(q),_),e.call(f+"_mul",i,_,_),e.call(f+"_square",n,u),e.call(f+"_square",c,g),e.call(f+"_add",g,g,p),e.call(f+"_add",p,g,p),e.call(f+"_mul",e.i32_const(O),p,L),e.call(f+"_add",L,L,h),e.call(f+"_add",L,h,h),e.call(f+"_add",u,h,m),e.call(f+"_mul",m,e.i32_const(q),m),e.call(f+"_add",u,g,C),e.call(f+"_add",n,c,b),e.call(f+"_square",b,b),e.call(f+"_sub",b,C,b),e.call(f+"_sub",L,u,y),e.call(f+"_square",i,x),e.call(f+"_square",L,F),e.call(f+"_sub",u,h,C),e.call(f+"_mul",_,C,i),e.call(f+"_add",F,F,C),e.call(f+"_add",F,C,C),e.call(f+"_square",m,n),e.call(f+"_sub",n,C,n),e.call(f+"_mul",u,b,c),e.call(f+"_mul",e.i32_const(E),y,l),e.call(f+"_neg",b,s),e.call(f+"_add",x,x,d),e.call(f+"_add",x,d,d))}(),function(){const a=t.addFunction(o+"_prepareG1");a.addParam("pP","i32"),a.addParam("ppreP","i32");const e=a.getCodeBuilder();a.addCode(e.call(p+"_normalize",e.getLocal("pP"),e.getLocal("ppreP")))}(),function(){!function(){const a=t.addFunction(o+"_mulByQ");a.addParam("p1","i32"),a.addParam("pr","i32");const e=a.getCodeBuilder(),i=e.getLocal("p1"),n=e.i32_add(e.getLocal("p1"),e.i32_const(r)),c=e.i32_add(e.getLocal("p1"),e.i32_const(2*r)),l=e.getLocal("pr"),d=e.i32_add(e.getLocal("pr"),e.i32_const(r)),_=e.i32_add(e.getLocal("pr"),e.i32_const(2*r)),u=e.i32_const(t.alloc([...Wt.bigInt2BytesLE(b("21575463638280843010398324269430826099269044274347216827212613867836435027261"),s),...Wt.bigInt2BytesLE(b("10307601595873709700152284273816112264069230130616436755625194854815875713954"),s)])),g=e.i32_const(t.alloc([...Wt.bigInt2BytesLE(b("2821565182194536844548159561693502659359617185244120367078079554186484126554"),s),...Wt.bigInt2BytesLE(b("3505843767911556378687030309984248845540243509899259641013678093033130930403"),s)]));a.addCode(e.call(f+"_conjugate",i,l),e.call(f+"_mul",u,l,l),e.call(f+"_conjugate",n,d),e.call(f+"_mul",g,d,d),e.call(f+"_conjugate",c,_))}();const a=t.addFunction(o+"_prepareG2");a.addParam("pQ","i32"),a.addParam("ppreQ","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");const e=a.getCodeBuilder(),i=e.getLocal("pQ"),n=t.alloc(3*r),c=e.i32_const(n),l=e.i32_const(n),d=e.i32_const(n+r),_=e.i32_const(n+2*r),u=e.i32_add(e.getLocal("ppreQ"),e.i32_const(0)),g=e.i32_add(e.getLocal("ppreQ"),e.i32_const(r)),p=t.alloc(3*r),L=e.i32_const(p),m=t.alloc(3*r),y=e.i32_const(m),x=e.i32_const(m+r);a.addCode(e.call(h+"_normalize",i,u),e.call(f+"_copy",u,l),e.call(f+"_copy",g,d),e.call(f+"_one",_)),a.addCode(e.setLocal("pCoef",e.i32_add(e.getLocal("ppreQ"),e.i32_const(3*r))),e.setLocal("i",e.i32_const(M.length-2)),e.block(e.loop(e.call(o+"_prepDblStep",c,e.getLocal("pCoef")),e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(G))),e.if(e.i32_load8_s(e.getLocal("i"),T),[...e.call(o+"_prepAddStep",u,c,e.getLocal("pCoef")),...e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(G)))]),e.br_if(1,e.i32_eqz(e.getLocal("i"))),e.setLocal("i",e.i32_sub(e.getLocal("i"),e.i32_const(1))),e.br(0)))),a.addCode(e.call(o+"_mulByQ",u,L),e.call(o+"_mulByQ",L,y)),a.addCode(e.call(f+"_neg",x,x),e.call(o+"_prepAddStep",L,c,e.getLocal("pCoef")),e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(G))),e.call(o+"_prepAddStep",y,c,e.getLocal("pCoef")),e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(G))))}(),function(){const a=t.addFunction(o+"__mulBy024");a.addParam("pEll0","i32"),a.addParam("pEllVW","i32"),a.addParam("pEllVV","i32"),a.addParam("pR","i32");const e=a.getCodeBuilder(),i=e.getLocal("pEll0"),n=e.getLocal("pEllVV"),l=e.getLocal("pEllVW"),s=e.getLocal("pR"),d=e.i32_add(e.getLocal("pR"),e.i32_const(2*c)),_=e.i32_add(e.getLocal("pR"),e.i32_const(4*c)),u=e.i32_add(e.getLocal("pR"),e.i32_const(6*c)),g=e.i32_add(e.getLocal("pR"),e.i32_const(8*c)),p=e.i32_add(e.getLocal("pR"),e.i32_const(10*c)),L=e.i32_const(t.alloc(r)),h=e.i32_const(t.alloc(r)),m=e.i32_const(t.alloc(r)),b=e.i32_const(t.alloc(r)),y=e.i32_const(t.alloc(r)),x=e.i32_const(t.alloc(r)),F=e.i32_const(t.alloc(r)),C=e.i32_const(t.alloc(r)),w=e.i32_const(t.alloc(r)),B=e.i32_const(t.alloc(r)),A=e.i32_const(t.alloc(r));a.addCode(e.call(f+"_mul",s,i,F),e.call(f+"_mul",_,n,C),e.call(f+"_mul",g,l,w),e.call(f+"_add",s,g,m),e.call(f+"_add",s,_,h),e.call(f+"_add",d,u,b),e.call(f+"_add",b,p,b),e.call(f+"_mul",d,n,B),e.call(f+"_add",B,w,y),e.call(f+"_mul",e.i32_const(I),y,x),e.call(f+"_add",x,F,s),e.call(f+"_mul",p,l,y),e.call(f+"_add",B,y,B),e.call(f+"_add",y,C,y),e.call(f+"_mul",e.i32_const(I),y,x),e.call(f+"_mul",d,i,y),e.call(f+"_add",B,y,B),e.call(f+"_add",x,y,d),e.call(f+"_add",i,n,L),e.call(f+"_mul",h,L,y),e.call(f+"_add",F,C,A),e.call(f+"_sub",y,A,y),e.call(f+"_mul",u,l,x),e.call(f+"_add",B,x,B),e.call(f+"_add",_,g,L),e.call(f+"_add",y,x,_),e.call(f+"_add",n,l,h),e.call(f+"_mul",h,L,y),e.call(f+"_add",C,w,A),e.call(f+"_sub",y,A,y),e.call(f+"_mul",e.i32_const(I),y,x),e.call(f+"_mul",u,i,y),e.call(f+"_add",B,y,B),e.call(f+"_add",x,y,u),e.call(f+"_mul",p,n,y),e.call(f+"_add",B,y,B),e.call(f+"_mul",e.i32_const(I),y,x),e.call(f+"_add",i,l,L),e.call(f+"_mul",m,L,y),e.call(f+"_add",F,w,A),e.call(f+"_sub",y,A,y),e.call(f+"_add",x,y,g),e.call(f+"_add",i,n,L),e.call(f+"_add",L,l,L),e.call(f+"_mul",b,L,y),e.call(f+"_sub",y,B,p))}(),function(){const a=t.addFunction(o+"__mulBy024Old");a.addParam("pEll0","i32"),a.addParam("pEllVW","i32"),a.addParam("pEllVV","i32"),a.addParam("pR","i32");const e=a.getCodeBuilder(),i=e.getLocal("pEll0"),n=e.getLocal("pEllVV"),c=e.getLocal("pEllVW"),l=e.getLocal("pR"),s=t.alloc(d),_=e.i32_const(s),u=e.i32_const(s),g=e.i32_const(s+r),p=e.i32_const(s+2*r),L=e.i32_const(s+3*r),h=e.i32_const(s+4*r),m=e.i32_const(s+5*r);a.addCode(e.call(f+"_copy",i,u),e.call(f+"_zero",g),e.call(f+"_copy",n,p),e.call(f+"_zero",L),e.call(f+"_copy",c,h),e.call(f+"_zero",m),e.call(z+"_mul",_,l,l))}(),function(){const a=t.addFunction(o+"_millerLoop");a.addParam("ppreP","i32"),a.addParam("ppreQ","i32"),a.addParam("r","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");const e=a.getCodeBuilder(),i=e.getLocal("ppreP"),n=e.i32_add(e.getLocal("ppreP"),e.i32_const(s)),c=e.getLocal("pCoef"),l=e.i32_add(e.getLocal("pCoef"),e.i32_const(r)),d=e.i32_add(e.getLocal("pCoef"),e.i32_const(2*r)),_=t.alloc(r),u=e.i32_const(_),g=t.alloc(r),p=e.i32_const(g),L=e.getLocal("r");a.addCode(e.call(z+"_one",L),e.setLocal("pCoef",e.i32_add(e.getLocal("ppreQ"),e.i32_const(3*r))),e.setLocal("i",e.i32_const(M.length-2)),e.block(e.loop(e.call(z+"_square",L,L),e.call(f+"_mul1",l,n,u),e.call(f+"_mul1",d,i,p),e.call(o+"__mulBy024",c,u,p,L),e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(G))),e.if(e.i32_load8_s(e.getLocal("i"),T),[...e.call(f+"_mul1",l,n,u),...e.call(f+"_mul1",d,i,p),...e.call(o+"__mulBy024",c,u,p,L),...e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(G)))]),e.br_if(1,e.i32_eqz(e.getLocal("i"))),e.setLocal("i",e.i32_sub(e.getLocal("i"),e.i32_const(1))),e.br(0)))),a.addCode(e.call(f+"_mul1",l,n,u),e.call(f+"_mul1",d,i,p),e.call(o+"__mulBy024",c,u,p,L),e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(G))),e.call(f+"_mul1",l,n,u),e.call(f+"_mul1",d,i,p),e.call(o+"__mulBy024",c,u,p,L),e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(G))))}();for(let a=0;a<10;a++)Z(a),t.exportFunction(o+"__frobeniusMap"+a);!function(){const a=t.addFunction(o+"_finalExponentiationOld");a.addParam("x","i32"),a.addParam("r","i32");const e=t.alloc(Wt.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),i=a.getCodeBuilder();a.addCode(i.call(z+"_exp",i.getLocal("x"),i.i32_const(e),i.i32_const(352),i.getLocal("r")))}(),function(){!function(){const a=t.addFunction(o+"__finalExponentiationFirstChunk");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.getLocal("x"),n=i,l=e.i32_add(i,e.i32_const(6*c)),s=e.getLocal("r"),r=t.alloc(d),_=e.i32_const(r),u=_,g=e.i32_const(r+6*c),p=e.i32_const(t.alloc(d)),f=e.i32_const(t.alloc(d)),L=e.i32_const(t.alloc(d));a.addCode(e.call(S+"_copy",n,u),e.call(S+"_neg",l,g),e.call(z+"_inverse",i,p),e.call(z+"_mul",_,p,f),e.call(o+"__frobeniusMap2",f,L),e.call(z+"_mul",f,L,s))}(),W();const a=t.addFunction(o+"_finalExponentiation");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.getLocal("x"),n=e.getLocal("r"),l=e.i32_const(t.alloc(d));a.addCode(e.call(o+"__finalExponentiationFirstChunk",i,l),e.call(o+"__finalExponentiationLastChunk",l,n))}();for(let a=1;a<=5;a++)J(a),t.exportFunction(o+"_pairingEq"+a);!function(){const a=t.addFunction(o+"_pairing");a.addParam("p","i32"),a.addParam("q","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.i32_const(t.alloc(d));a.addCode(e.call(o+"_prepareG1",e.getLocal("p"),e.i32_const(V))),a.addCode(e.call(o+"_prepareG2",e.getLocal("q"),e.i32_const(Q))),a.addCode(e.call(o+"_millerLoop",e.i32_const(V),e.i32_const(Q),i)),a.addCode(e.call(o+"_finalExponentiation",i,e.getLocal("r")))}(),t.exportFunction(o+"_pairing"),t.exportFunction(o+"_prepareG1"),t.exportFunction(o+"_prepareG2"),t.exportFunction(o+"_millerLoop"),t.exportFunction(o+"_finalExponentiation"),t.exportFunction(o+"_finalExponentiationOld"),t.exportFunction(o+"__mulBy024"),t.exportFunction(o+"__mulBy024Old"),t.exportFunction(o+"__cyclotomicSquare"),t.exportFunction(o+"__cyclotomicExp_w0")},ba=function(t,a){const o=a||"bls12381";if(t.modules[o])return o;const e=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,i=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,n=Math.floor((fa(e-1n)-1)/64)+1,c=8*n,l=c,s=2*l,r=12*l,d=Math.floor((fa(i-1n)-1)/64)+1,_=8*d,u=_,g=t.alloc(na.bigInt2BytesLE(i,u)),p=ca(t,e,"f1m","intq");la(t,i,"fr","frm","intr");const f=t.alloc(na.bigInt2BytesLE(x(4n),l)),L=da(t,"g1m","f1m",f);_a(t,"frm","frm","frm","frm_mul"),ua(t,"pol","frm"),ga(t,"qap","frm");const h=sa(t,"f1m_neg","f2m","f1m"),m=t.alloc([...na.bigInt2BytesLE(x(4n),l),...na.bigInt2BytesLE(x(4n),l)]),b=da(t,"g2m","f2m",m);function y(a,o){const e=t.addFunction(a);e.addParam("pG","i32"),e.addParam("pFr","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(_));e.addCode(i.call("frm_fromMontgomery",i.getLocal("pFr"),n),i.call(o,i.getLocal("pG"),n,i.i32_const(_),i.getLocal("pr"))),t.exportFunction(a)}function x(t){return BigInt(t)*(1n<<BigInt(8*l))%e}y("g1m_timesFr","g1m_timesScalar"),_a(t,"g1m","g1m","frm","g1m_timesFr"),y("g2m_timesFr","g2m_timesScalar"),_a(t,"g2m","g2m","frm","g2m_timesFr"),y("g1m_timesFrAffine","g1m_timesScalarAffine"),y("g2m_timesFrAffine","g2m_timesScalarAffine"),pa(t,"frm_batchApplyKey","fmr","frm",_,_,_,"frm_mul"),pa(t,"g1m_batchApplyKey","g1m","frm",3*c,3*c,_,"g1m_timesFr"),pa(t,"g1m_batchApplyKeyMixed","g1m","frm",2*c,3*c,_,"g1m_timesFrAffine"),pa(t,"g2m_batchApplyKey","g2m","frm",2*c*3,3*c*2,_,"g2m_timesFr"),pa(t,"g2m_batchApplyKeyMixed","g2m","frm",2*c*2,3*c*2,_,"g2m_timesFrAffine");const F=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],C=t.alloc([...na.bigInt2BytesLE(x(F[0]),l),...na.bigInt2BytesLE(x(F[1]),l),...na.bigInt2BytesLE(x(F[2]),l)]),w=[0n,1n,0n],B=t.alloc([...na.bigInt2BytesLE(x(w[0]),l),...na.bigInt2BytesLE(x(w[1]),l),...na.bigInt2BytesLE(x(w[2]),l)]),A=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],P=t.alloc([...na.bigInt2BytesLE(x(A[0][0]),l),...na.bigInt2BytesLE(x(A[0][1]),l),...na.bigInt2BytesLE(x(A[1][0]),l),...na.bigInt2BytesLE(x(A[1][1]),l),...na.bigInt2BytesLE(x(A[2][0]),l),...na.bigInt2BytesLE(x(A[2][1]),l)]),v=[[0n,0n],[1n,0n],[0n,0n]],I=t.alloc([...na.bigInt2BytesLE(x(v[0][0]),l),...na.bigInt2BytesLE(x(v[0][1]),l),...na.bigInt2BytesLE(x(v[1][0]),l),...na.bigInt2BytesLE(x(v[1][1]),l),...na.bigInt2BytesLE(x(v[2][0]),l),...na.bigInt2BytesLE(x(v[2][1]),l)]),q=t.alloc([...na.bigInt2BytesLE(x(1n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l),...na.bigInt2BytesLE(x(0n),l)]),E=t.alloc([...na.bigInt2BytesLE(x(1n),l),...na.bigInt2BytesLE(x(1n),l)]);!function(){const a=t.addFunction(h+"_mulNR");a.addParam("x","i32"),a.addParam("pr","i32");const o=a.getCodeBuilder(),e=o.i32_const(t.alloc(l)),i=o.getLocal("x"),n=o.i32_add(o.getLocal("x"),o.i32_const(l)),c=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(l));a.addCode(o.call(p+"_copy",i,e),o.call(p+"_sub",i,n,c),o.call(p+"_add",e,n,s))}();const O=ra(t,h+"_mulNR","f6m","f2m");!function(){const a=t.addFunction(O+"_mulNR");a.addParam("x","i32"),a.addParam("pr","i32");const o=a.getCodeBuilder(),e=o.i32_const(t.alloc(2*l));a.addCode(o.call(h+"_copy",o.getLocal("x"),e),o.call(h+"_mulNR",o.i32_add(o.getLocal("x"),o.i32_const(4*c)),o.getLocal("pr")),o.call(h+"_copy",o.i32_add(o.getLocal("x"),o.i32_const(2*c)),o.i32_add(o.getLocal("pr"),o.i32_const(4*c))),o.call(h+"_copy",e,o.i32_add(o.getLocal("pr"),o.i32_const(2*c))))}();const S=sa(t,O+"_mulNR","ftm",O),z=function(t){let a=t;const o=[];for(;a>0n;)La(a)?o.push(1):o.push(0),a>>=1n;return o}(0xd201000000010000n),M=t.alloc(z),T=3*s,G=z.length-1,R=z.reduce(((t,a)=>t+(0!=a?1:0)),0),N=6*c,k=3*c*2+(R+G+1)*T,U=15132376222941642752n;function j(a){const o=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],i=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],n=t.addFunction(S+"_frobeniusMap"+a);n.addParam("x","i32"),n.addParam("r","i32");const r=n.getCodeBuilder();for(let e=0;e<6;e++){const _=0==e?r.getLocal("x"):r.i32_add(r.getLocal("x"),r.i32_const(e*s)),u=_,g=r.i32_add(r.getLocal("x"),r.i32_const(e*s+l)),f=0==e?r.getLocal("r"):r.i32_add(r.getLocal("r"),r.i32_const(e*s)),L=f,m=r.i32_add(r.getLocal("r"),r.i32_const(e*s+l)),b=d(o[Math.floor(e/3)][a%12],i[e%3][a%6]),y=t.alloc([...na.bigInt2BytesLE(x(b[0]),c),...na.bigInt2BytesLE(x(b[1]),c)]);a%2==1?n.addCode(r.call(p+"_copy",u,L),r.call(p+"_neg",g,m),r.call(h+"_mul",f,r.i32_const(y),f)):n.addCode(r.call(h+"_mul",_,r.i32_const(y),f))}function d(t,a){const o=t[0],i=t[1],n=a[0],c=a[1],l=[(o*n-i*c)%e,(o*c+i*n)%e];return ha(l[0])&&(l[0]=l[0]+e),l}}function Z(a,e,i){const n=function(t){let a=t;const o=[];for(;a>0n;){if(La(a)){const t=2-Number(a%4n);o.push(t),a-=BigInt(t)}else o.push(0);a>>=1n}return o}(a).map((t=>-1==t?255:t)),c=t.alloc(n),l=t.addFunction(o+"__cyclotomicExp_"+i);l.addParam("x","i32"),l.addParam("r","i32"),l.addLocal("bit","i32"),l.addLocal("i","i32");const s=l.getCodeBuilder(),d=s.getLocal("x"),_=s.getLocal("r"),u=s.i32_const(t.alloc(r));l.addCode(s.call(S+"_conjugate",d,u),s.call(S+"_one",_),s.if(s.teeLocal("bit",s.i32_load8_s(s.i32_const(n.length-1),c)),s.if(s.i32_eq(s.getLocal("bit"),s.i32_const(1)),s.call(S+"_mul",_,d,_),s.call(S+"_mul",_,u,_))),s.setLocal("i",s.i32_const(n.length-2)),s.block(s.loop(s.call(o+"__cyclotomicSquare",_,_),s.if(s.teeLocal("bit",s.i32_load8_s(s.getLocal("i"),c)),s.if(s.i32_eq(s.getLocal("bit"),s.i32_const(1)),s.call(S+"_mul",_,d,_),s.call(S+"_mul",_,u,_))),s.br_if(1,s.i32_eqz(s.getLocal("i"))),s.setLocal("i",s.i32_sub(s.getLocal("i"),s.i32_const(1))),s.br(0)))),e&&l.addCode(s.call(S+"_conjugate",_,_))}t.modules[o]={n64q:n,n64r:d,n8q:c,n8r:_,pG1gen:C,pG1zero:B,pG1b:f,pG2gen:P,pG2zero:I,pG2b:m,pq:t.modules.f1m.pq,pr:g,pOneT:q,r:i,q:e,prePSize:N,preQSize:k},function(){const a=t.addFunction(O+"_mul1");a.addParam("pA","i32"),a.addParam("pC1","i32"),a.addParam("pR","i32");const o=a.getCodeBuilder(),e=o.getLocal("pA"),i=o.i32_add(o.getLocal("pA"),o.i32_const(2*l)),n=o.i32_add(o.getLocal("pA"),o.i32_const(4*l)),c=o.getLocal("pC1"),s=o.getLocal("pR"),r=o.i32_add(o.getLocal("pR"),o.i32_const(2*l)),d=o.i32_add(o.getLocal("pR"),o.i32_const(4*l)),_=o.i32_const(t.alloc(2*l)),u=o.i32_const(t.alloc(2*l));a.addCode(o.call(h+"_add",e,i,_),o.call(h+"_add",i,n,u),o.call(h+"_mul",i,c,d),o.call(h+"_mul",u,c,s),o.call(h+"_sub",s,d,s),o.call(h+"_mulNR",s,s),o.call(h+"_mul",_,c,r),o.call(h+"_sub",r,d,r))}(),function(){const a=t.addFunction(O+"_mul01");a.addParam("pA","i32"),a.addParam("pC0","i32"),a.addParam("pC1","i32"),a.addParam("pR","i32");const o=a.getCodeBuilder(),e=o.getLocal("pA"),i=o.i32_add(o.getLocal("pA"),o.i32_const(2*l)),n=o.i32_add(o.getLocal("pA"),o.i32_const(4*l)),c=o.getLocal("pC0"),s=o.getLocal("pC1"),r=o.getLocal("pR"),d=o.i32_add(o.getLocal("pR"),o.i32_const(2*l)),_=o.i32_add(o.getLocal("pR"),o.i32_const(4*l)),u=o.i32_const(t.alloc(2*l)),g=o.i32_const(t.alloc(2*l)),p=o.i32_const(t.alloc(2*l)),f=o.i32_const(t.alloc(2*l));a.addCode(o.call(h+"_mul",e,c,u),o.call(h+"_mul",i,s,g),o.call(h+"_add",e,i,p),o.call(h+"_add",e,n,f),o.call(h+"_add",i,n,r),o.call(h+"_mul",r,s,r),o.call(h+"_sub",r,g,r),o.call(h+"_mulNR",r,r),o.call(h+"_add",r,u,r),o.call(h+"_add",c,s,d),o.call(h+"_mul",d,p,d),o.call(h+"_sub",d,u,d),o.call(h+"_sub",d,g,d),o.call(h+"_mul",f,c,_),o.call(h+"_sub",_,u,_),o.call(h+"_add",_,g,_))}(),function(){const a=t.addFunction(S+"_mul014");a.addParam("pA","i32"),a.addParam("pC0","i32"),a.addParam("pC1","i32"),a.addParam("pC4","i32"),a.addParam("pR","i32");const o=a.getCodeBuilder(),e=o.getLocal("pA"),i=o.i32_add(o.getLocal("pA"),o.i32_const(6*l)),n=o.getLocal("pC0"),c=o.getLocal("pC1"),s=o.getLocal("pC4"),r=o.i32_const(t.alloc(6*l)),d=o.i32_const(t.alloc(6*l)),_=o.i32_const(t.alloc(2*l)),u=o.getLocal("pR"),g=o.i32_add(o.getLocal("pR"),o.i32_const(6*l));a.addCode(o.call(O+"_mul01",e,n,c,r),o.call(O+"_mul1",i,s,d),o.call(h+"_add",c,s,_),o.call(O+"_add",i,e,g),o.call(O+"_mul01",g,n,_,g),o.call(O+"_sub",g,r,g),o.call(O+"_sub",g,d,g),o.call(O+"_copy",d,u),o.call(O+"_mulNR",u,u),o.call(O+"_add",u,r,u))}(),function(){const a=t.addFunction(o+"_ell");a.addParam("pP","i32"),a.addParam("pCoefs","i32"),a.addParam("pF","i32");const e=a.getCodeBuilder(),i=e.getLocal("pP"),n=e.i32_add(e.getLocal("pP"),e.i32_const(c)),s=e.getLocal("pF"),r=e.getLocal("pCoefs"),d=e.i32_add(e.getLocal("pCoefs"),e.i32_const(l)),_=e.i32_add(e.getLocal("pCoefs"),e.i32_const(2*l)),u=e.i32_add(e.getLocal("pCoefs"),e.i32_const(3*l)),g=e.i32_add(e.getLocal("pCoefs"),e.i32_const(4*l)),f=t.alloc(2*l),L=e.i32_const(f),h=e.i32_const(f),m=e.i32_const(f+l),b=t.alloc(2*l),y=e.i32_const(b),x=e.i32_const(b),F=e.i32_const(b+l);a.addCode(e.call(p+"_mul",r,n,h),e.call(p+"_mul",d,n,m),e.call(p+"_mul",_,i,x),e.call(p+"_mul",u,i,F),e.call(S+"_mul014",s,g,y,L,s))}();const $=t.alloc(N),W=t.alloc(k);function V(a){const e=t.addFunction(o+"_pairingEq"+a);for(let t=0;t<a;t++)e.addParam("p_"+t,"i32"),e.addParam("q_"+t,"i32");e.addParam("c","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),n=i.i32_const(t.alloc(r)),c=i.i32_const(t.alloc(r));e.addCode(i.call(S+"_one",n));for(let t=0;t<a;t++)e.addCode(i.call(o+"_prepareG1",i.getLocal("p_"+t),i.i32_const($))),e.addCode(i.call(o+"_prepareG2",i.getLocal("q_"+t),i.i32_const(W))),e.addCode(i.if(i.i32_eqz(i.call(L+"_inGroupAffine",i.i32_const($))),i.ret(i.i32_const(0))),i.if(i.i32_eqz(i.call(b+"_inGroupAffine",i.i32_const(W))),i.ret(i.i32_const(0)))),e.addCode(i.call(o+"_millerLoop",i.i32_const($),i.i32_const(W),c)),e.addCode(i.call(S+"_mul",n,c,n));e.addCode(i.call(o+"_finalExponentiation",n,n)),e.addCode(i.call(S+"_eq",n,i.getLocal("c")))}for(let a=0;a<10;a++)j(a),t.exportFunction(S+"_frobeniusMap"+a);!function(){const a=t.addFunction(L+"_inGroupAffine");a.addParam("p","i32"),a.setReturnType("i32");const o=a.getCodeBuilder(),e=(U*U-1n)/3n,i=o.i32_const(t.alloc(na.bigInt2BytesLE(x(4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n),c))),n=o.i32_const(t.alloc(na.bigInt2BytesLE(x(793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n),c))),s=o.i32_const(t.alloc(na.bigInt2BytesLE(e,16))),r=o.getLocal("p"),d=o.i32_add(o.getLocal("p"),o.i32_const(l)),_=t.alloc(3*l),u=o.i32_const(_),g=o.i32_const(_),f=o.i32_const(_+l),h=t.alloc(2*l),m=o.i32_const(h),b=o.i32_const(h),y=o.i32_const(h+l);a.addCode(o.if(o.call(L+"_isZeroAffine",o.getLocal("p")),o.ret(o.i32_const(1))),o.if(o.i32_eqz(o.call(L+"_inCurveAffine",o.getLocal("p"))),o.ret(o.i32_const(0))),o.call(p+"_mul",r,i,g),o.call(p+"_copy",d,f),o.call(p+"_mul",r,n,b),o.call(p+"_copy",d,y),o.call(L+"_doubleAffine",u,u),o.call(L+"_subMixed",u,o.getLocal("p"),u),o.call(L+"_subMixed",u,m,u),o.call(L+"_timesScalar",u,s,o.i32_const(16),u),o.ret(o.call(L+"_eqMixed",u,m)));const F=t.addFunction(L+"_inGroup");F.addParam("pIn","i32"),F.setReturnType("i32");const C=F.getCodeBuilder(),w=C.i32_const(t.alloc(2*l));F.addCode(C.call(L+"_toAffine",C.getLocal("pIn"),w),C.ret(C.call(L+"_inGroupAffine",w)))}(),function(){const a=t.addFunction(b+"_inGroupAffine");a.addParam("p","i32"),a.setReturnType("i32");const o=a.getCodeBuilder(),e=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],i=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],n=o.i32_const(t.alloc([...na.bigInt2BytesLE(x(e[0]),c),...na.bigInt2BytesLE(x(e[1]),c)])),r=o.i32_const(t.alloc(na.bigInt2BytesLE(x(4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n),c))),d=o.i32_const(t.alloc([...na.bigInt2BytesLE(x(i[0]),c),...na.bigInt2BytesLE(x(i[1]),c)])),_=o.i32_const(t.alloc(na.bigInt2BytesLE(U,8))),u=o.getLocal("p"),g=o.i32_add(o.getLocal("p"),o.i32_const(s)),f=o.i32_const(t.alloc(l)),L=o.i32_const(t.alloc(s)),m=o.i32_const(t.alloc(s)),y=t.alloc(2*s),F=o.i32_const(y),C=o.i32_const(y),w=o.i32_const(y),B=o.i32_const(y+l),A=o.i32_const(y+s),P=o.i32_const(y+s),v=o.i32_const(y+s+l),I=t.alloc(3*s),q=o.i32_const(I),E=o.i32_const(I),O=o.i32_const(I),S=o.i32_const(I+l),z=o.i32_const(I+s),M=o.i32_const(I+s),T=o.i32_const(I+s+l),G=o.i32_const(I+2*s);a.addCode(o.if(o.call(b+"_isZeroAffine",o.getLocal("p")),o.ret(o.i32_const(1))),o.if(o.i32_eqz(o.call(b+"_inCurveAffine",o.getLocal("p"))),o.ret(o.i32_const(0))),o.call(h+"_mul",u,n,L),o.call(h+"_mul",g,n,m),o.call(h+"_mul1",L,r,C),o.call(h+"_neg",m,A),o.call(h+"_neg",L,E),o.call(h+"_mul",m,d,z),o.call(p+"_sub",w,B,f),o.call(p+"_add",w,B,B),o.call(p+"_copy",f,w),o.call(p+"_sub",P,v,f),o.call(p+"_add",P,v,v),o.call(p+"_copy",f,P),o.call(p+"_add",O,S,f),o.call(p+"_sub",O,S,S),o.call(p+"_copy",f,O),o.call(p+"_sub",T,M,f),o.call(p+"_add",M,T,T),o.call(p+"_copy",f,M),o.call(h+"_one",G),o.call(b+"_timesScalar",q,_,o.i32_const(8),q),o.call(b+"_addMixed",q,F,q),o.ret(o.call(b+"_eqMixed",q,o.getLocal("p"))));const R=t.addFunction(b+"_inGroup");R.addParam("pIn","i32"),R.setReturnType("i32");const N=R.getCodeBuilder(),k=N.i32_const(t.alloc(2*s));R.addCode(N.call(b+"_toAffine",N.getLocal("pIn"),k),N.ret(N.call(b+"_inGroupAffine",k)))}(),function(){const a=t.addFunction(o+"_prepAddStep");a.addParam("R","i32"),a.addParam("Q","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.getLocal("R"),n=e.i32_add(e.getLocal("R"),e.i32_const(2*c)),l=e.i32_add(e.getLocal("R"),e.i32_const(4*c)),r=e.getLocal("Q"),d=e.i32_add(e.getLocal("Q"),e.i32_const(2*c)),_=e.getLocal("r"),u=e.i32_add(e.getLocal("r"),e.i32_const(2*c)),g=e.i32_add(e.getLocal("r"),e.i32_const(4*c)),p=e.i32_const(t.alloc(s)),f=e.i32_const(t.alloc(s)),L=e.i32_const(t.alloc(s)),m=e.i32_const(t.alloc(s)),b=e.i32_const(t.alloc(s)),y=e.i32_const(t.alloc(s)),x=e.i32_const(t.alloc(s)),F=e.i32_const(t.alloc(s)),C=e.i32_const(t.alloc(s)),w=e.i32_const(t.alloc(s)),B=e.i32_const(t.alloc(s));a.addCode(e.call(h+"_square",l,p),e.call(h+"_square",d,f),e.call(h+"_mul",p,r,m),e.call(h+"_add",d,l,u),e.call(h+"_square",u,u),e.call(h+"_sub",u,f,u),e.call(h+"_sub",u,p,u),e.call(h+"_mul",u,p,u),e.call(h+"_sub",m,i,b),e.call(h+"_square",b,y),e.call(h+"_add",y,y,x),e.call(h+"_add",x,x,x),e.call(h+"_mul",x,b,F),e.call(h+"_sub",u,n,C),e.call(h+"_sub",C,n,C),e.call(h+"_mul",C,r,g),e.call(h+"_mul",x,i,w),e.call(h+"_square",C,i),e.call(h+"_sub",i,F,i),e.call(h+"_sub",i,w,i),e.call(h+"_sub",i,w,i),e.call(h+"_add",l,b,l),e.call(h+"_square",l,l),e.call(h+"_sub",l,p,l),e.call(h+"_sub",l,y,l),e.call(h+"_add",d,l,_),e.call(h+"_sub",w,i,B),e.call(h+"_mul",B,C,B),e.call(h+"_mul",n,F,m),e.call(h+"_add",m,m,m),e.call(h+"_sub",B,m,n),e.call(h+"_square",_,_),e.call(h+"_sub",_,f,_),e.call(h+"_square",l,L),e.call(h+"_sub",_,L,_),e.call(h+"_add",g,g,g),e.call(h+"_sub",g,_,g),e.call(h+"_add",l,l,_),e.call(h+"_neg",C,C),e.call(h+"_add",C,C,u))}(),function(){const a=t.addFunction(o+"_prepDblStep");a.addParam("R","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.getLocal("R"),n=e.i32_add(e.getLocal("R"),e.i32_const(2*c)),l=e.i32_add(e.getLocal("R"),e.i32_const(4*c)),r=e.getLocal("r"),d=e.i32_add(e.getLocal("r"),e.i32_const(2*c)),_=e.i32_add(e.getLocal("r"),e.i32_const(4*c)),u=e.i32_const(t.alloc(s)),g=e.i32_const(t.alloc(s)),p=e.i32_const(t.alloc(s)),f=e.i32_const(t.alloc(s)),L=e.i32_const(t.alloc(s));a.addCode(e.call(h+"_square",i,r),e.call(h+"_square",n,g),e.call(h+"_square",g,p),e.call(h+"_add",g,i,d),e.call(h+"_square",d,d),e.call(h+"_sub",d,r,d),e.call(h+"_sub",d,p,d),e.call(h+"_add",d,d,d),e.call(h+"_add",r,r,f),e.call(h+"_add",f,r,f),e.call(h+"_add",i,f,_),e.call(h+"_square",f,L),e.call(h+"_square",l,u),e.call(h+"_sub",L,d,i),e.call(h+"_sub",i,d,i),e.call(h+"_add",l,n,l),e.call(h+"_square",l,l),e.call(h+"_sub",l,g,l),e.call(h+"_sub",l,u,l),e.call(h+"_sub",d,i,n),e.call(h+"_mul",n,f,n),e.call(h+"_add",p,p,p),e.call(h+"_add",p,p,p),e.call(h+"_add",p,p,p),e.call(h+"_sub",n,p,n),e.call(h+"_mul",f,u,d),e.call(h+"_add",d,d,d),e.call(h+"_neg",d,d),e.call(h+"_square",_,_),e.call(h+"_sub",_,r,_),e.call(h+"_sub",_,L,_),e.call(h+"_add",g,g,g),e.call(h+"_add",g,g,g),e.call(h+"_sub",_,g,_),e.call(h+"_mul",l,u,r),e.call(h+"_add",r,r,r))}(),function(){const a=t.addFunction(o+"_prepareG1");a.addParam("pP","i32"),a.addParam("ppreP","i32");const e=a.getCodeBuilder();a.addCode(e.call(L+"_normalize",e.getLocal("pP"),e.getLocal("ppreP")))}(),function(){const a=t.addFunction(o+"_prepareG2");a.addParam("pQ","i32"),a.addParam("ppreQ","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");const e=a.getCodeBuilder(),i=e.getLocal("pQ"),n=t.alloc(3*s),c=e.i32_const(n),l=e.getLocal("ppreQ");a.addCode(e.call(b+"_normalize",i,l),e.if(e.call(b+"_isZero",l),e.ret([])),e.call(b+"_copy",l,c),e.setLocal("pCoef",e.i32_add(e.getLocal("ppreQ"),e.i32_const(3*s)))),a.addCode(e.setLocal("i",e.i32_const(z.length-2)),e.block(e.loop(e.call(o+"_prepDblStep",c,e.getLocal("pCoef")),e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(T))),e.if(e.i32_load8_s(e.getLocal("i"),M),[...e.call(o+"_prepAddStep",c,l,e.getLocal("pCoef")),...e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(T)))]),e.br_if(1,e.i32_eqz(e.getLocal("i"))),e.setLocal("i",e.i32_sub(e.getLocal("i"),e.i32_const(1))),e.br(0))))}(),function(){const a=t.addFunction(o+"_millerLoop");a.addParam("ppreP","i32"),a.addParam("ppreQ","i32"),a.addParam("r","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");const e=a.getCodeBuilder(),i=e.getLocal("ppreP"),n=e.getLocal("pCoef"),c=e.getLocal("r");a.addCode(e.call(S+"_one",c),e.if(e.call(L+"_isZero",i),e.ret([])),e.if(e.call(L+"_isZero",e.getLocal("ppreQ")),e.ret([])),e.setLocal("pCoef",e.i32_add(e.getLocal("ppreQ"),e.i32_const(3*s))),e.setLocal("i",e.i32_const(z.length-2)),e.block(e.loop(e.call(o+"_ell",i,n,c),e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(T))),e.if(e.i32_load8_s(e.getLocal("i"),M),[...e.call(o+"_ell",i,n,c),...e.setLocal("pCoef",e.i32_add(e.getLocal("pCoef"),e.i32_const(T)))]),e.call(S+"_square",c,c),e.br_if(1,e.i32_eq(e.getLocal("i"),e.i32_const(1))),e.setLocal("i",e.i32_sub(e.getLocal("i"),e.i32_const(1))),e.br(0))),e.call(o+"_ell",i,n,c)),a.addCode(e.call(S+"_conjugate",c,c))}(),function(){const a=t.addFunction(o+"_finalExponentiationOld");a.addParam("x","i32"),a.addParam("r","i32");const e=t.alloc(na.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),i=a.getCodeBuilder();a.addCode(i.call(S+"_exp",i.getLocal("x"),i.i32_const(e),i.i32_const(544),i.getLocal("r")))}(),function(){!function(){const a=t.addFunction(o+"__cyclotomicSquare");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.getLocal("x"),n=e.i32_add(e.getLocal("x"),e.i32_const(s)),c=e.i32_add(e.getLocal("x"),e.i32_const(2*s)),l=e.i32_add(e.getLocal("x"),e.i32_const(3*s)),r=e.i32_add(e.getLocal("x"),e.i32_const(4*s)),d=e.i32_add(e.getLocal("x"),e.i32_const(5*s)),_=e.getLocal("r"),u=e.i32_add(e.getLocal("r"),e.i32_const(s)),g=e.i32_add(e.getLocal("r"),e.i32_const(2*s)),p=e.i32_add(e.getLocal("r"),e.i32_const(3*s)),f=e.i32_add(e.getLocal("r"),e.i32_const(4*s)),L=e.i32_add(e.getLocal("r"),e.i32_const(5*s)),m=e.i32_const(t.alloc(s)),b=e.i32_const(t.alloc(s)),y=e.i32_const(t.alloc(s)),x=e.i32_const(t.alloc(s)),F=e.i32_const(t.alloc(s)),C=e.i32_const(t.alloc(s)),w=e.i32_const(t.alloc(s)),B=e.i32_const(t.alloc(s));a.addCode(e.call(h+"_mul",i,r,w),e.call(h+"_mulNR",r,m),e.call(h+"_add",i,m,m),e.call(h+"_add",i,r,B),e.call(h+"_mul",B,m,m),e.call(h+"_mulNR",w,B),e.call(h+"_add",w,B,B),e.call(h+"_sub",m,B,m),e.call(h+"_add",w,w,b),e.call(h+"_mul",l,c,w),e.call(h+"_mulNR",c,y),e.call(h+"_add",l,y,y),e.call(h+"_add",l,c,B),e.call(h+"_mul",B,y,y),e.call(h+"_mulNR",w,B),e.call(h+"_add",w,B,B),e.call(h+"_sub",y,B,y),e.call(h+"_add",w,w,x),e.call(h+"_mul",n,d,w),e.call(h+"_mulNR",d,F),e.call(h+"_add",n,F,F),e.call(h+"_add",n,d,B),e.call(h+"_mul",B,F,F),e.call(h+"_mulNR",w,B),e.call(h+"_add",w,B,B),e.call(h+"_sub",F,B,F),e.call(h+"_add",w,w,C),e.call(h+"_sub",m,i,_),e.call(h+"_add",_,_,_),e.call(h+"_add",m,_,_),e.call(h+"_add",b,r,f),e.call(h+"_add",f,f,f),e.call(h+"_add",b,f,f),e.call(h+"_mul",C,e.i32_const(E),B),e.call(h+"_add",B,l,p),e.call(h+"_add",p,p,p),e.call(h+"_add",B,p,p),e.call(h+"_sub",F,c,g),e.call(h+"_add",g,g,g),e.call(h+"_add",F,g,g),e.call(h+"_sub",y,n,u),e.call(h+"_add",u,u,u),e.call(h+"_add",y,u,u),e.call(h+"_add",x,d,L),e.call(h+"_add",L,L,L),e.call(h+"_add",x,L,L))}(),Z(U,true,"w0");const a=t.addFunction(o+"_finalExponentiation");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.getLocal("x"),n=e.getLocal("r"),c=e.i32_const(t.alloc(r)),l=e.i32_const(t.alloc(r)),d=e.i32_const(t.alloc(r)),_=e.i32_const(t.alloc(r)),u=e.i32_const(t.alloc(r)),g=e.i32_const(t.alloc(r)),p=e.i32_const(t.alloc(r));a.addCode(e.call(S+"_frobeniusMap6",i,c),e.call(S+"_inverse",i,l),e.call(S+"_mul",c,l,d),e.call(S+"_copy",d,l),e.call(S+"_frobeniusMap2",d,d),e.call(S+"_mul",d,l,d),e.call(o+"__cyclotomicSquare",d,l),e.call(S+"_conjugate",l,l),e.call(o+"__cyclotomicExp_w0",d,_),e.call(o+"__cyclotomicSquare",_,u),e.call(S+"_mul",l,_,g),e.call(o+"__cyclotomicExp_w0",g,l),e.call(o+"__cyclotomicExp_w0",l,c),e.call(o+"__cyclotomicExp_w0",c,p),e.call(S+"_mul",p,u,p),e.call(o+"__cyclotomicExp_w0",p,u),e.call(S+"_conjugate",g,g),e.call(S+"_mul",u,g,u),e.call(S+"_mul",u,d,u),e.call(S+"_conjugate",d,g),e.call(S+"_mul",l,d,l),e.call(S+"_frobeniusMap3",l,l),e.call(S+"_mul",p,g,p),e.call(S+"_frobeniusMap1",p,p),e.call(S+"_mul",_,c,_),e.call(S+"_frobeniusMap2",_,_),e.call(S+"_mul",_,l,_),e.call(S+"_mul",_,p,_),e.call(S+"_mul",_,u,n))}();for(let a=1;a<=5;a++)V(a),t.exportFunction(o+"_pairingEq"+a);!function(){const a=t.addFunction(o+"_pairing");a.addParam("p","i32"),a.addParam("q","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.i32_const(t.alloc(r));a.addCode(e.call(o+"_prepareG1",e.getLocal("p"),e.i32_const($))),a.addCode(e.call(o+"_prepareG2",e.getLocal("q"),e.i32_const(W))),a.addCode(e.call(o+"_millerLoop",e.i32_const($),e.i32_const(W),i)),a.addCode(e.call(o+"_finalExponentiation",i,e.getLocal("r")))}(),t.exportFunction(o+"_pairing"),t.exportFunction(o+"_prepareG1"),t.exportFunction(o+"_prepareG2"),t.exportFunction(o+"_millerLoop"),t.exportFunction(o+"_finalExponentiation"),t.exportFunction(o+"_finalExponentiationOld"),t.exportFunction(o+"__cyclotomicSquare"),t.exportFunction(o+"__cyclotomicExp_w0"),t.exportFunction(O+"_mul1"),t.exportFunction(O+"_mul01"),t.exportFunction(S+"_mul014"),t.exportFunction(L+"_inGroupAffine"),t.exportFunction(L+"_inGroup"),t.exportFunction(b+"_inGroupAffine"),t.exportFunction(b+"_inGroup")};function ya(t,a){let o=t;void 0===a&&0==(a=Math.floor((i(t)-1)/8)+1)&&(a=1);const e=new Uint8Array(a),n=new DataView(e.buffer);let c=0;for(;c<a;)c+4<=a?(n.setUint32(c,Number(o&BigInt(4294967295)),!0),c+=4,o>>=BigInt(32)):c+2<=a?(n.setUint16(c,Number(o&BigInt(65535)),!0),c+=2,o>>=BigInt(16)):(n.setUint8(c,Number(o&BigInt(255)),!0),c+=1,o>>=BigInt(8));if(o)throw new Error("Number does not fit in this length");return e}const xa=[];for(let t=0;t<256;t++)xa[t]=Fa(t,8);function Fa(t,a){let o=0,e=t;for(let t=0;t<a;t++)o<<=1,o|=1&e,e>>=1;return o}function Ca(t,a){return(xa[t>>>24]|xa[t>>>16&255]<<8|xa[t>>>8&255]<<16|xa[255&t]<<24)>>>32-a}function wa(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function Ba(t,a){const o=t.byteLength/a,e=wa(o);if(o!=1<<e)throw new Error("Invalid number of pointers");for(let i=0;i<o;i++){const o=Ca(i,e);if(i>o){const e=t.slice(i*a,(i+1)*a);t.set(t.slice(o*a,(o+1)*a),i*a),t.set(e,o*a)}}}function Aa(t,a){const o=new Uint8Array(a*t.length);for(let e=0;e<t.length;e++)o.set(t[e],e*a);return o}function Pa(t,a){const o=t.byteLength/a,e=new Array(o);for(let i=0;i<o;i++)e[i]=t.slice(i*a,i*a+a);return e}var va=Object.freeze({__proto__:null,stringifyBigInts:function t(a){if("bigint"==typeof a||void 0!==a.eq)return a.toString(10);if(a instanceof Uint8Array)return P(a,0);if(Array.isArray(a))return a.map(t);if("object"==typeof a){const o={};return Object.keys(a).forEach((e=>{o[e]=t(a[e])})),o}return a},unstringifyBigInts:function t(a){if("string"==typeof a&&/^[0-9]+$/.test(a))return BigInt(a);if("string"==typeof a&&/^0x[0-9a-fA-F]+$/.test(a))return BigInt(a);if(Array.isArray(a))return a.map(t);if("object"==typeof a){if(null===a)return null;const o={};return Object.keys(a).forEach((e=>{o[e]=t(a[e])})),o}return a},beBuff2int:function(t){let a=BigInt(0),o=t.length,e=0;const i=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;o>0;)o>=4?(o-=4,a+=BigInt(i.getUint32(o))<<BigInt(8*e),e+=4):o>=2?(o-=2,a+=BigInt(i.getUint16(o))<<BigInt(8*e),e+=2):(o-=1,a+=BigInt(i.getUint8(o))<<BigInt(8*e),e+=1);return a},beInt2Buff:function(t,a){let o=t;const e=new Uint8Array(a),i=new DataView(e.buffer);let n=a;for(;n>0;)n-4>=0?(n-=4,i.setUint32(n,Number(o&BigInt(4294967295))),o>>=BigInt(32)):n-2>=0?(n-=2,i.setUint16(n,Number(o&BigInt(65535))),o>>=BigInt(16)):(n-=1,i.setUint8(n,Number(o&BigInt(255))),o>>=BigInt(8));if(o)throw new Error("Number does not fit in this length");return e},leBuff2int:function(t){let a=BigInt(0),o=0;const e=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;o<t.length;)o+4<=t.length?(a+=BigInt(e.getUint32(o,!0))<<BigInt(8*o),o+=4):o+2<=t.length?(a+=BigInt(e.getUint16(o,!0))<<BigInt(8*o),o+=2):(a+=BigInt(e.getUint8(o,!0))<<BigInt(8*o),o+=1);return a},leInt2Buff:ya,stringifyFElements:function t(a,o){if("bigint"==typeof o||void 0!==o.eq)return o.toString(10);if(o instanceof Uint8Array)return a.toString(a.e(o));if(Array.isArray(o))return o.map(t.bind(this,a));if("object"==typeof o){const e={};return Object.keys(o).forEach((i=>{e[i]=t(a,o[i])})),e}return o},unstringifyFElements:function t(a,o){if("string"==typeof o&&/^[0-9]+$/.test(o))return a.e(o);if("string"==typeof o&&/^0x[0-9a-fA-F]+$/.test(o))return a.e(o);if(Array.isArray(o))return o.map(t.bind(this,a));if("object"==typeof o){if(null===o)return null;const e={};return Object.keys(o).forEach((i=>{e[i]=t(a,o[i])})),e}return o},bitReverse:Ca,log2:wa,buffReverseBits:Ba,array2buffer:Aa,buffer2array:Pa});const Ia=1<<30;class qa{constructor(t){this.buffers=[],this.byteLength=t;for(let a=0;a<t;a+=Ia){const o=Math.min(t-a,Ia);this.buffers.push(new Uint8Array(o))}}slice(t,a){void 0===a&&(a=this.byteLength),void 0===t&&(t=0);const o=a-t,e=Math.floor(t/Ia);if(e==Math.floor((t+o-1)/Ia)||0==o)return this.buffers[e].slice(t%Ia,t%Ia+o);let i,n=e,c=t%Ia,l=o;for(;l>0;){const t=c+l>Ia?Ia-c:l,a=new Uint8Array(this.buffers[n].buffer,this.buffers[n].byteOffset+c,t);if(t==o)return a.slice();i||(i=o<=Ia?new Uint8Array(o):new qa(o)),i.set(a,o-l),l-=t,n++,c=0}return i}set(t,a){void 0===a&&(a=0);const o=t.byteLength;if(0==o)return;const e=Math.floor(a/Ia);if(e==Math.floor((a+o-1)/Ia))return t instanceof qa&&1==t.buffers.length?this.buffers[e].set(t.buffers[0],a%Ia):this.buffers[e].set(t,a%Ia);let i=e,n=a%Ia,c=o;for(;c>0;){const a=n+c>Ia?Ia-n:c,e=t.slice(o-c,o-c+a);new Uint8Array(this.buffers[i].buffer,this.buffers[i].byteOffset+n,a).set(e),c-=a,i++,n=0}}}function Ea(t,a,o,e){return async function(i){const n=Math.floor(i.byteLength/o);if(n*o!==i.byteLength)throw new Error("Invalid buffer size");const c=Math.floor(n/t.concurrency),l=[];for(let s=0;s<t.concurrency;s++){let r;if(r=s<t.concurrency-1?c:n-s*c,0==r)continue;const d=[{cmd:"ALLOCSET",var:0,buff:i.slice(s*c*o,s*c*o+r*o)},{cmd:"ALLOC",var:1,len:e*r},{cmd:"CALL",fnName:a,params:[{var:0},{val:r},{var:1}]},{cmd:"GET",out:0,var:1,len:e*r}];l.push(t.queueAction(d))}const s=await Promise.all(l);let r;r=i instanceof qa?new qa(n*e):new Uint8Array(n*e);let d=0;for(let t=0;t<s.length;t++)r.set(s[t][0],d),d+=s[t][0].byteLength;return r}}class Oa{constructor(t,a,o,e){if(this.tm=t,this.prefix=a,this.p=e,this.n8=o,this.type="F1",this.m=1,this.half=s(e,O),this.bitLength=i(e),this.mask=f(l(O,this.bitLength),O),this.pOp1=t.alloc(o),this.pOp2=t.alloc(o),this.pOp3=t.alloc(o),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[a+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(o/8),this.n32=Math.floor(o/4),8*this.n64!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=s(this.p,O),this.nqr=this.two;let n=this.exp(this.nqr,this.half);for(;!this.eq(n,this.negone);)this.nqr=this.add(this.nqr,this.one),n=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let c=f(this.p,O);for(;!_(c);)this.s=this.s+1,c=s(c,O);this.w=[],this.w[this.s]=this.exp(this.nqr,c);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Ea(t,a+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Ea(t,a+"_batchFromMontgomery",this.n8,this.n8)}op2(t,a,o){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,a,o){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,a){return this.op2("_add",t,a)}eq(t,a){return this.op2Bool("_eq",t,a)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,a){return this.op2("_sub",t,a)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,a){return this.op2("_mul",t,a)}div(t,a){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,a){return a instanceof Uint8Array||(a=q(e(a))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,a){if(t instanceof Uint8Array)return t;let o=e(t,a);n(o)?(o=L(o),F(o,this.p)&&(o=y(o,this.p)),o=f(this.p,o)):F(o,this.p)&&(o=y(o,this.p));const i=ya(o,this.n8);return this.toMontgomery(i)}toString(t,a){return I(P(this.fromMontgomery(t),0),a)}fromRng(t){let a;const o=new Uint8Array(this.n8);do{a=E;for(let o=0;o<this.n64;o++)a=p(a,l(t.nextU64(),64*o));a=w(a,this.mask)}while(C(a,this.p));return B(o,0,a,this.n8),o}random(){return this.fromRng(k())}toObject(t){return P(this.fromMontgomery(t),0)}fromObject(t){const a=new Uint8Array(this.n8);return B(a,0,t,this.n8),this.toMontgomery(a)}toRprLE(t,a,o){t.set(this.fromMontgomery(o),a)}toRprBE(t,a,o){const e=this.fromMontgomery(o);for(let t=0;t<this.n8/2;t++){const a=e[t];e[t]=e[this.n8-1-t],e[this.n8-1-t]=a}t.set(e,a)}fromRprLE(t,a){a=a||0;const o=t.slice(a,a+this.n8);return this.toMontgomery(o)}async batchInverse(t){let a=!1;const o=this.n8,e=this.n8;Array.isArray(t)?(t=Aa(t,o),a=!0):t=t.slice(0,t.byteLength);const i=Math.floor(t.byteLength/o);if(i*o!==t.byteLength)throw new Error("Invalid buffer size");const n=Math.floor(i/this.tm.concurrency),c=[];for(let a=0;a<this.tm.concurrency;a++){let l;if(l=a<this.tm.concurrency-1?n:i-a*n,0==l)continue;const s=[{cmd:"ALLOCSET",var:0,buff:t.slice(a*n*o,a*n*o+l*o)},{cmd:"ALLOC",var:1,len:e*l},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:o},{val:l},{var:1},{val:e}]},{cmd:"GET",out:0,var:1,len:e*l}];c.push(this.tm.queueAction(s))}const l=await Promise.all(c);let s;s=t instanceof qa?new qa(i*e):new Uint8Array(i*e);let r=0;for(let t=0;t<l.length;t++)s.set(l[t][0],r),r+=l[t][0].byteLength;return a?Pa(s,e):s}}class Sa{constructor(t,a,o){this.tm=t,this.prefix=a,this.F=o,this.type="F2",this.m=2*o.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*o.n8),this.pOp2=t.alloc(2*o.n8),this.pOp3=t.alloc(2*o.n8),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[a+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,a,o){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,a,o){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,a){return this.op2("_add",t,a)}eq(t,a){return this.op2Bool("_eq",t,a)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,a){return this.op2("_sub",t,a)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,a){return this.op2("_mul",t,a)}mul1(t,a){return this.op2("_mul1",t,a)}div(t,a){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,a){return a instanceof Uint8Array||(a=q(e(a))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,a){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){const o=this.F.e(t[0],a),e=this.F.e(t[1],a),i=new Uint8Array(2*this.F.n8);return i.set(o),i.set(e,2*this.F.n8),i}throw new Error("invalid F2")}toString(t,a){return`[${this.F.toString(t.slice(0,this.F.n8),a)}, ${this.F.toString(t.slice(this.F.n8),a)}]`}fromRng(t){const a=this.F.fromRng(t),o=this.F.fromRng(t),e=new Uint8Array(2*this.F.n8);return e.set(a),e.set(o,this.F.n8),e}random(){return this.fromRng(k())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){const a=new Uint8Array(2*this.F.n8),o=this.F.fromObject(t[0]),e=this.F.fromObject(t[1]);return a.set(o),a.set(e,this.F.n8),a}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class za{constructor(t,a,o){this.tm=t,this.prefix=a,this.F=o,this.type="F3",this.m=3*o.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*o.n8),this.pOp2=t.alloc(3*o.n8),this.pOp3=t.alloc(3*o.n8),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[a+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,a,o){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,a,o){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,a){return this.op2Bool("_eq",t,a)}isZero(t){return this.op1Bool("_isZero",t)}add(t,a){return this.op2("_add",t,a)}sub(t,a){return this.op2("_sub",t,a)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,a){return this.op2("_mul",t,a)}div(t,a){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,a){return a instanceof Uint8Array||(a=q(e(a))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,a){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){const o=this.F.e(t[0],a),e=this.F.e(t[1],a),i=this.F.e(t[2],a),n=new Uint8Array(3*this.F.n8);return n.set(o),n.set(e,this.F.n8),n.set(i,2*this.F.n8),n}throw new Error("invalid F3")}toString(t,a){return`[${this.F.toString(t.slice(0,this.F.n8),a)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),a)}, ${this.F.toString(t.slice(2*this.F.n8),a)}]`}fromRng(t){const a=this.F.fromRng(t),o=this.F.fromRng(t),e=this.F.fromRng(t),i=new Uint8Array(3*this.F.n8);return i.set(a),i.set(o,this.F.n8),i.set(e,2*this.F.n8),i}random(){return this.fromRng(k())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){const a=new Uint8Array(3*this.F.n8),o=this.F.fromObject(t[0]),e=this.F.fromObject(t[1]),i=this.F.fromObject(t[2]);return a.set(o),a.set(e,this.F.n8),a.set(i,2*this.F.n8),a}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class Ma{constructor(t,a,o,e,i,n){this.tm=t,this.prefix=a,this.F=o,this.pOp1=t.alloc(3*o.n8),this.pOp2=t.alloc(3*o.n8),this.pOp3=t.alloc(3*o.n8),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*o.n8),this.tm.instance.exports[a+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*o.n8),this.one=this.tm.getBuff(e,3*o.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(e,2*o.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(i,o.n8),n&&(this.cofactor=q(n)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Ea(t,a+"_batchLEMtoC",2*o.n8,o.n8),this.batchLEMtoU=Ea(t,a+"_batchLEMtoU",2*o.n8,2*o.n8),this.batchCtoLEM=Ea(t,a+"_batchCtoLEM",o.n8,2*o.n8),this.batchUtoLEM=Ea(t,a+"_batchUtoLEM",2*o.n8,2*o.n8),this.batchToJacobian=Ea(t,a+"_batchToJacobian",2*o.n8,3*o.n8),this.batchToAffine=Ea(t,a+"_batchToAffine",3*o.n8,2*o.n8)}op2(t,a,o){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,a,o){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,a){if(t.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_add",t,a);if(a.byteLength==2*this.F.n8)return this.op2("_addMixed",t,a);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_addMixed",a,t);if(a.byteLength==2*this.F.n8)return this.op2("_addAffine",t,a);throw new Error("invalid point size")}throw new Error("invalid point size")}sub(t,a){if(t.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_sub",t,a);if(a.byteLength==2*this.F.n8)return this.op2("_subMixed",t,a);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_subMixed",a,t);if(a.byteLength==2*this.F.n8)return this.op2("_subAffine",t,a);throw new Error("invalid point size")}throw new Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,a){let o;if(a instanceof Uint8Array||(a=q(e(a))),t.byteLength==3*this.F.n8)o=this.prefix+"_timesScalar";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");o=this.prefix+"_timesScalarAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[o](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,a){let o;if(t.byteLength==3*this.F.n8)o=this.prefix+"_timesFr";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");o=this.prefix+"_timesFrAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[o](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,a){if(t.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2bool("_eq",t,a);if(a.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,a);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",a,t);if(a.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,a);throw new Error("invalid point size")}throw new Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,a,o){if(this.tm.setBuff(this.pOp1,o),o.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(o.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const e=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(e,a)}fromRprUncompressed(t,a){const o=t.slice(a,a+2*this.F.n8);return this.tm.setBuff(this.pOp1,o),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,a,o){if(this.tm.setBuff(this.pOp1,o),o.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(o.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const e=this.tm.getBuff(this.pOp1,this.F.n8);t.set(e,a)}fromRprCompressed(t,a){const o=t.slice(a,a+this.F.n8);return this.tm.setBuff(this.pOp1,o),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){const a=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(a,0,t),a}toRprLEM(t,a,o){if(o.byteLength!=2*this.F.n8){if(o.byteLength!=3*this.F.n8)throw new Error("invalid point size");{this.tm.setBuff(this.pOp1,o),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const e=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(e,a)}}else t.set(o,a)}fromRprLEM(t,a){return a=a||0,t.slice(a,a+2*this.F.n8)}toString(t,a){if(t.byteLength==3*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),a)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),a)}, ${this.F.toString(t.slice(2*this.F.n8),a)} ]`}if(t.byteLength==2*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),a)}, ${this.F.toString(t.slice(this.F.n8),a)} ]`}throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const a=this.F,o=this.toAffine(t),e=o.slice(0,this.F.n8),i=o.slice(this.F.n8,2*this.F.n8),n=a.add(a.mul(a.square(e),e),this.b),c=a.square(i);return a.eq(n,c)}fromRng(t){const a=this.F;let o,e,i=[];do{i[0]=a.fromRng(t),o=t.nextBool(),e=a.add(a.mul(a.square(i[0]),i[0]),this.b)}while(!a.isSquare(e));i[1]=a.sqrt(e);o^a.isNegative(i[1])&&(i[1]=a.neg(i[1]));let n=new Uint8Array(2*this.F.n8);return n.set(i[0]),n.set(i[1],this.F.n8),this.cofactor&&(n=this.timesScalar(n,this.cofactor)),n}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const a=this.F.toObject(t.slice(0,this.F.n8)),o=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));let e;return e=t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one),[a,o,e]}fromObject(t){const a=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]);let e;if(e=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(e,this.F.one))return this.zeroAffine;if(this.F.eq(e,this.F.one)){const t=new Uint8Array(2*this.F.n8);return t.set(a),t.set(o,this.F.n8),t}{const t=new Uint8Array(3*this.F.n8);return t.set(a),t.set(o,this.F.n8),t.set(e,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function Ta(t){const a=32767;let o,e;async function i(t){const i=new Uint8Array(t.code),n=await WebAssembly.compile(i);e=new WebAssembly.Memory({initial:t.init,maximum:a}),o=await WebAssembly.instantiate(n,{env:{memory:e}})}function n(t){const o=new Uint32Array(e.buffer,0,1);for(;3&o[0];)o[0]++;const i=o[0];if(o[0]+=t,o[0]+t>e.buffer.byteLength){const i=e.buffer.byteLength/65536;let n=Math.floor((o[0]+t)/65536)+1;n>a&&(n=a),e.grow(n-i)}return i}function c(t){const a=n(t.byteLength);return s(a,t),a}function l(t,a){const o=new Uint8Array(e.buffer);return new Uint8Array(o.buffer,o.byteOffset+t,a)}function s(t,a){new Uint8Array(e.buffer).set(new Uint8Array(a),t)}function r(t){if("INIT"==t[0].cmd)return i(t[0]);const a={vars:[],out:[]},r=new Uint32Array(e.buffer,0,1)[0];for(let e=0;e<t.length;e++)switch(t[e].cmd){case"ALLOCSET":a.vars[t[e].var]=c(t[e].buff);break;case"ALLOC":a.vars[t[e].var]=n(t[e].len);break;case"SET":s(a.vars[t[e].var],t[e].buff);break;case"CALL":{const i=[];for(let o=0;o<t[e].params.length;o++){const n=t[e].params[o];void 0!==n.var?i.push(a.vars[n.var]+(n.offset||0)):void 0!==n.val&&i.push(n.val)}o.exports[t[e].fnName](...i);break}case"GET":a.out[t[e].out]=l(a.vars[t[e].var],t[e].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(e.buffer,0,1)[0]=r,a.out}return t&&(t.onmessage=function(a){let o;if(o=a.data?a.data:a,"INIT"==o[0].cmd)i(o[0]).then((function(){t.postMessage(o.result)}));else if("TERMINATE"==o[0].cmd)t.close();else{const a=r(o);t.postMessage(a)}}),r}var Ga={},Ra=Worker;const Na=25;class ka{constructor(){this.promise=new Promise(((t,a)=>{this.reject=a,this.resolve=t}))}}var Ua;const ja="data:application/javascript;base64,"+(Ua="("+Ta.toString()+")(self)",globalThis.btoa(Ua));class Za{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,a,o,e){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=e||new ka,this.workers[t].postMessage(a,o),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(0==this.working[t]){const a=this.actionQueue.shift();this.postAction(t,a.data,a.transfers,a.deferred)}}queueAction(t,a){const o=new ka;if(this.singleThread){const a=this.taskManager(t);o.resolve(a)}else this.actionQueue.push({data:t,transfers:a,deferred:o}),this.processWorks();return o.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const a=this.alloc(t.byteLength);return this.setBuff(a,t),a}getBuff(t,a){return this.u8.slice(t,t+a)}setBuff(t,a){this.u8.set(new Uint8Array(a),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;const a=this.u32[0];return this.u32[0]+=t,a}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);var t;await(t=200,new Promise((a=>setTimeout(a,t))))}}function $a(t,a){const o=t[a],e=t.Fr,i=t.tm;t[a].batchApplyKey=async function(t,n,c,l,s){let r,d,_,u,g;if(l=l||"affine",s=s||"affine","G1"==a)"jacobian"==l?(_=3*o.F.n8,r="g1m_batchApplyKey"):(_=2*o.F.n8,r="g1m_batchApplyKeyMixed"),u=3*o.F.n8,"jacobian"==s?g=3*o.F.n8:(d="g1m_batchToAffine",g=2*o.F.n8);else if("G2"==a)"jacobian"==l?(_=3*o.F.n8,r="g2m_batchApplyKey"):(_=2*o.F.n8,r="g2m_batchApplyKeyMixed"),u=3*o.F.n8,"jacobian"==s?g=3*o.F.n8:(d="g2m_batchToAffine",g=2*o.F.n8);else{if("Fr"!=a)throw new Error("Invalid group: "+a);r="frm_batchApplyKey",_=o.n8,u=o.n8,g=o.n8}const p=Math.floor(t.byteLength/_),f=Math.floor(p/i.concurrency),L=[];c=e.e(c);let h=e.e(n);for(let a=0;a<i.concurrency;a++){let o;if(o=a<i.concurrency-1?f:p-a*f,0==o)continue;const n=[];n.push({cmd:"ALLOCSET",var:0,buff:t.slice(a*f*_,a*f*_+o*_)}),n.push({cmd:"ALLOCSET",var:1,buff:h}),n.push({cmd:"ALLOCSET",var:2,buff:c}),n.push({cmd:"ALLOC",var:3,len:o*Math.max(u,g)}),n.push({cmd:"CALL",fnName:r,params:[{var:0},{val:o},{var:1},{var:2},{var:3}]}),d&&n.push({cmd:"CALL",fnName:d,params:[{var:3},{val:o},{var:3}]}),n.push({cmd:"GET",out:0,var:3,len:o*g}),L.push(i.queueAction(n)),h=e.mul(h,e.exp(c,o))}const m=await Promise.all(L);let b;b=t instanceof qa?new qa(p*g):new Uint8Array(p*g);let y=0;for(let t=0;t<m.length;t++)b.set(m[t][0],y),y+=m[t][0].byteLength;return b}}const Wa=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function Va(t,a){const o=t[a],e=o.tm;async function i(t,e,i,n,c){if(!(t instanceof Uint8Array))throw n&&n.error(`${c} _multiExpChunk buffBases is not Uint8Array`),new Error(`${c} _multiExpChunk buffBases is not Uint8Array`);if(!(e instanceof Uint8Array))throw n&&n.error(`${c} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${c} _multiExpChunk buffScalars is not Uint8Array`);let l,s;if(i=i||"affine","G1"==a)"affine"==i?(s="g1m_multiexpAffine_chunk",l=2*o.F.n8):(s="g1m_multiexp_chunk",l=3*o.F.n8);else{if("G2"!=a)throw new Error("Invalid group");"affine"==i?(s="g2m_multiexpAffine_chunk",l=2*o.F.n8):(s="g2m_multiexp_chunk",l=3*o.F.n8)}const r=Math.floor(t.byteLength/l);if(0==r)return o.zero;const d=Math.floor(e.byteLength/r);if(d*r!=e.byteLength)throw new Error("Scalar size does not match");const _=Wa[wa(r)],u=Math.floor((8*d-1)/_)+1,g=[];for(let a=0;a<u;a++){const i=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:e},{cmd:"ALLOC",var:2,len:3*o.F.n8},{cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:d},{val:r},{val:a*_},{val:Math.min(8*d-a*_,_)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*o.F.n8}];g.push(o.tm.queueAction(i))}const p=await Promise.all(g);let f=o.zero;for(let t=p.length-1;t>=0;t--){if(!o.isZero(f))for(let t=0;t<_;t++)f=o.double(f);f=o.add(f,p[t][0])}return f}async function n(t,n,c,l,s){const r=1<<22;let d;if("G1"==a)d="affine"==c?2*o.F.n8:3*o.F.n8;else{if("G2"!=a)throw new Error("Invalid group");d="affine"==c?2*o.F.n8:3*o.F.n8}const _=Math.floor(t.byteLength/d),u=Math.floor(n.byteLength/_);if(u*_!=n.byteLength)throw new Error("Scalar size does not match");const g=Wa[wa(_)],p=Math.floor((8*u-1)/g)+1;let f;f=Math.floor(_/(e.concurrency/p)),f>r&&(f=r),f<1024&&(f=1024);const L=[];for(let a=0;a<_;a+=f){l&&l.debug(`Multiexp start: ${s}: ${a}/${_}`);const o=Math.min(_-a,f),e=t.slice(a*d,(a+o)*d),r=n.slice(a*u,(a+o)*u);L.push(i(e,r,c,l,s).then((t=>(l&&l.debug(`Multiexp end: ${s}: ${a}/${_}`),t))))}const h=await Promise.all(L);let m=o.zero;for(let t=h.length-1;t>=0;t--)m=o.add(m,h[t]);return m}o.multiExp=async function(t,a,o,e){return await n(t,a,"jacobian",o,e)},o.multiExpAffine=async function(t,a,o,e){return await n(t,a,"affine",o,e)}}function Qa(t,a){const o=t[a],e=t.Fr,i=o.tm;async function n(t,l,s,r,d,_){s=s||"affine",r=r||"affine";let u,g,p,f,L,h,m,b;"G1"==a?("affine"==s?(u=2*o.F.n8,f="g1m_batchToJacobian"):u=3*o.F.n8,g=3*o.F.n8,l&&(b="g1m_fftFinal"),m="g1m_fftJoin",h="g1m_fftMix","affine"==r?(p=2*o.F.n8,L="g1m_batchToAffine"):p=3*o.F.n8):"G2"==a?("affine"==s?(u=2*o.F.n8,f="g2m_batchToJacobian"):u=3*o.F.n8,g=3*o.F.n8,l&&(b="g2m_fftFinal"),m="g2m_fftJoin",h="g2m_fftMix","affine"==r?(p=2*o.F.n8,L="g2m_batchToAffine"):p=3*o.F.n8):"Fr"==a&&(u=o.n8,g=o.n8,p=o.n8,l&&(b="frm_fftFinal"),h="frm_fftMix",m="frm_fftJoin");let y=!1;Array.isArray(t)?(t=Aa(t,u),y=!0):t=t.slice(0,t.byteLength);const x=t.byteLength/u,F=wa(x);if(1<<F!=x)throw new Error("fft must be multiple of 2");if(F==e.s+1){let a;return a=l?await async function(t,a,o,i,l){let s,r;s=t.slice(0,t.byteLength/2),r=t.slice(t.byteLength/2,t.byteLength);const d=[];d.push(n(s,!0,a,"jacobian",i,l)),d.push(n(r,!0,a,"jacobian",i,l)),[s,r]=await Promise.all(d);const _=await c(s,r,"fftJoinExtInv",e.one,e.shiftInv,"jacobian",o,i,l);let u;u=_[0].byteLength>1<<28?new qa(2*_[0].byteLength):new Uint8Array(2*_[0].byteLength);return u.set(_[0]),u.set(_[1],_[0].byteLength),u}(t,s,r,d,_):await async function(t,a,o,i,l){let s,r;s=t.slice(0,t.byteLength/2),r=t.slice(t.byteLength/2,t.byteLength);const d=[];[s,r]=await c(s,r,"fftJoinExt",e.one,e.shift,a,"jacobian",i,l),d.push(n(s,!1,"jacobian",o,i,l)),d.push(n(r,!1,"jacobian",o,i,l));const _=await Promise.all(d);let u;u=_[0].byteLength>1<<28?new qa(2*_[0].byteLength):new Uint8Array(2*_[0].byteLength);return u.set(_[0]),u.set(_[1],_[0].byteLength),u}(t,s,r,d,_),y?Pa(a,p):a}let C,w,B;l&&(C=e.inv(e.e(x))),Ba(t,u);let A=Math.min(16384,x),P=x/A;for(;P<i.concurrency&&A>=16;)P*=2,A/=2;const v=wa(A),I=[];for(let a=0;a<P;a++){d&&d.debug(`${_}: fft ${F} mix start: ${a}/${P}`);const o=[];o.push({cmd:"ALLOC",var:0,len:g*A});const e=t.slice(A*a*u,A*(a+1)*u);o.push({cmd:"SET",var:0,buff:e}),f&&o.push({cmd:"CALL",fnName:f,params:[{var:0},{val:A},{var:0}]});for(let t=1;t<=v;t++)o.push({cmd:"CALL",fnName:h,params:[{var:0},{val:A},{val:t}]});v==F?(b&&(o.push({cmd:"ALLOCSET",var:1,buff:C}),o.push({cmd:"CALL",fnName:b,params:[{var:0},{val:A},{var:1}]})),L&&o.push({cmd:"CALL",fnName:L,params:[{var:0},{val:A},{var:0}]}),o.push({cmd:"GET",out:0,var:0,len:A*p})):o.push({cmd:"GET",out:0,var:0,len:g*A}),I.push(i.queueAction(o).then((t=>(d&&d.debug(`${_}: fft ${F} mix end: ${a}/${P}`),t))))}B=await Promise.all(I);for(let t=0;t<P;t++)B[t]=B[t][0];for(let t=v+1;t<=F;t++){d&&d.debug(`${_}: fft  ${F}  join: ${t}/${F}`);const a=1<<F-t,o=P/a,n=[];for(let c=0;c<a;c++)for(let l=0;l<o/2;l++){const s=e.exp(e.w[t],l*A),r=e.w[t],u=c*o+l,f=c*o+l+o/2,h=[];h.push({cmd:"ALLOCSET",var:0,buff:B[u]}),h.push({cmd:"ALLOCSET",var:1,buff:B[f]}),h.push({cmd:"ALLOCSET",var:2,buff:s}),h.push({cmd:"ALLOCSET",var:3,buff:r}),h.push({cmd:"CALL",fnName:m,params:[{var:0},{var:1},{val:A},{var:2},{var:3}]}),t==F?(b&&(h.push({cmd:"ALLOCSET",var:4,buff:C}),h.push({cmd:"CALL",fnName:b,params:[{var:0},{val:A},{var:4}]}),h.push({cmd:"CALL",fnName:b,params:[{var:1},{val:A},{var:4}]})),L&&(h.push({cmd:"CALL",fnName:L,params:[{var:0},{val:A},{var:0}]}),h.push({cmd:"CALL",fnName:L,params:[{var:1},{val:A},{var:1}]})),h.push({cmd:"GET",out:0,var:0,len:A*p}),h.push({cmd:"GET",out:1,var:1,len:A*p})):(h.push({cmd:"GET",out:0,var:0,len:A*g}),h.push({cmd:"GET",out:1,var:1,len:A*g})),n.push(i.queueAction(h).then((e=>(d&&d.debug(`${_}: fft ${F} join  ${t}/${F}  ${c+1}/${a} ${l}/${o/2}`),e))))}const c=await Promise.all(n);for(let t=0;t<a;t++)for(let a=0;a<o/2;a++){const e=t*o+a,i=t*o+a+o/2,n=c.shift();B[e]=n[0],B[i]=n[1]}}if(w=t instanceof qa?new qa(x*p):new Uint8Array(x*p),l){w.set(B[0].slice((A-1)*p));let t=p;for(let a=P-1;a>0;a--)w.set(B[a],t),t+=A*p,delete B[a];w.set(B[0].slice(0,(A-1)*p),t),delete B[0]}else for(let t=0;t<P;t++)w.set(B[t],A*p*t),delete B[t];return y?Pa(w,p):w}async function c(t,n,c,l,s,r,d,_,u){let g,p,f,L,h,m;if("G1"==a)"affine"==r?(h=2*o.F.n8,p="g1m_batchToJacobian"):h=3*o.F.n8,m=3*o.F.n8,g="g1m_"+c,"affine"==d?(f="g1m_batchToAffine",L=2*o.F.n8):L=3*o.F.n8;else if("G2"==a)"affine"==r?(h=2*o.F.n8,p="g2m_batchToJacobian"):h=3*o.F.n8,g="g2m_"+c,m=3*o.F.n8,"affine"==d?(f="g2m_batchToAffine",L=2*o.F.n8):L=3*o.F.n8;else{if("Fr"!=a)throw new Error("Invalid group");h=e.n8,L=e.n8,m=e.n8,g="frm_"+c}if(t.byteLength!=n.byteLength)throw new Error("Invalid buffer size");const b=Math.floor(t.byteLength/h);if(b!=1<<wa(b))throw new Error("Invalid number of points");let y=Math.floor(b/i.concurrency);y<16&&(y=16),y>65536&&(y=65536);const x=[];for(let a=0;a<b;a+=y){_&&_.debug(`${u}: fftJoinExt Start: ${a}/${b}`);const o=Math.min(b-a,y),c=e.mul(l,e.exp(s,a)),r=[],d=t.slice(a*h,(a+o)*h),F=n.slice(a*h,(a+o)*h);r.push({cmd:"ALLOC",var:0,len:m*o}),r.push({cmd:"SET",var:0,buff:d}),r.push({cmd:"ALLOC",var:1,len:m*o}),r.push({cmd:"SET",var:1,buff:F}),r.push({cmd:"ALLOCSET",var:2,buff:c}),r.push({cmd:"ALLOCSET",var:3,buff:s}),p&&(r.push({cmd:"CALL",fnName:p,params:[{var:0},{val:o},{var:0}]}),r.push({cmd:"CALL",fnName:p,params:[{var:1},{val:o},{var:1}]})),r.push({cmd:"CALL",fnName:g,params:[{var:0},{var:1},{val:o},{var:2},{var:3},{val:e.s}]}),f&&(r.push({cmd:"CALL",fnName:f,params:[{var:0},{val:o},{var:0}]}),r.push({cmd:"CALL",fnName:f,params:[{var:1},{val:o},{var:1}]})),r.push({cmd:"GET",out:0,var:0,len:o*L}),r.push({cmd:"GET",out:1,var:1,len:o*L}),x.push(i.queueAction(r).then((t=>(_&&_.debug(`${u}: fftJoinExt End: ${a}/${b}`),t))))}const F=await Promise.all(x);let C,w;b*L>1<<28?(C=new qa(b*L),w=new qa(b*L)):(C=new Uint8Array(b*L),w=new Uint8Array(b*L));let B=0;for(let t=0;t<F.length;t++)C.set(F[t][0],B),w.set(F[t][1],B),B+=F[t][0].byteLength;return[C,w]}o.fft=async function(t,a,o,e,i){return await n(t,!1,a,o,e,i)},o.ifft=async function(t,a,o,e,i){return await n(t,!0,a,o,e,i)},o.lagrangeEvaluations=async function(t,i,l,s,r){let d;if(i=i||"affine",l=l||"affine","G1"==a)d="affine"==i?2*o.F.n8:3*o.F.n8;else if("G2"==a)d="affine"==i?2*o.F.n8:3*o.F.n8;else{if("Fr"!=a)throw new Error("Invalid group");d=e.n8}const _=t.byteLength/d,u=wa(_);if(2**u*d!=t.byteLength)throw s&&s.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(u<=e.s)return await o.ifft(t,i,l,s,r);if(u>e.s+1)throw s&&s.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let g=t.slice(0,t.byteLength/2),p=t.slice(t.byteLength/2,t.byteLength);const f=e.exp(e.shift,_/2),L=e.inv(e.sub(e.one,f));[g,p]=await c(g,p,"prepareLagrangeEvaluation",L,e.shiftInv,i,"jacobian",s,r+" prep");const h=[];let m;return h.push(n(g,!0,"jacobian",l,s,r+" t0")),h.push(n(p,!0,"jacobian",l,s,r+" t1")),[g,p]=await Promise.all(h),m=g.byteLength>1<<28?new qa(2*g.byteLength):new Uint8Array(2*g.byteLength),m.set(g),m.set(p,g.byteLength),m},o.fftMix=async function(t){const n=3*o.F.n8;let c,l;if("G1"==a)c="g1m_fftMix",l="g1m_fftJoin";else if("G2"==a)c="g2m_fftMix",l="g2m_fftJoin";else{if("Fr"!=a)throw new Error("Invalid group");c="frm_fftMix",l="frm_fftJoin"}const s=Math.floor(t.byteLength/n),r=wa(s);let d=1<<wa(i.concurrency);s<=2*d&&(d=1);const _=s/d,u=wa(_),g=[];for(let a=0;a<d;a++){const o=[],e=t.slice(a*_*n,(a+1)*_*n);o.push({cmd:"ALLOCSET",var:0,buff:e});for(let t=1;t<=u;t++)o.push({cmd:"CALL",fnName:c,params:[{var:0},{val:_},{val:t}]});o.push({cmd:"GET",out:0,var:0,len:_*n}),g.push(i.queueAction(o))}const p=await Promise.all(g),f=[];for(let t=0;t<p.length;t++)f[t]=p[t][0];for(let t=u+1;t<=r;t++){const a=1<<r-t,o=d/a,c=[];for(let s=0;s<a;s++)for(let a=0;a<o/2;a++){const r=e.exp(e.w[t],a*_),d=e.w[t],u=s*o+a,g=s*o+a+o/2,p=[];p.push({cmd:"ALLOCSET",var:0,buff:f[u]}),p.push({cmd:"ALLOCSET",var:1,buff:f[g]}),p.push({cmd:"ALLOCSET",var:2,buff:r}),p.push({cmd:"ALLOCSET",var:3,buff:d}),p.push({cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:_},{var:2},{var:3}]}),p.push({cmd:"GET",out:0,var:0,len:_*n}),p.push({cmd:"GET",out:1,var:1,len:_*n}),c.push(i.queueAction(p))}const s=await Promise.all(c);for(let t=0;t<a;t++)for(let a=0;a<o/2;a++){const e=t*o+a,i=t*o+a+o/2,n=s.shift();f[e]=n[0],f[i]=n[1]}}let L;L=t instanceof qa?new qa(s*n):new Uint8Array(s*n);let h=0;for(let t=0;t<d;t++)L.set(f[t],h),h+=f[t].byteLength;return L},o.fftJoin=async function(t,n,c,l){const s=3*o.F.n8;let r;if("G1"==a)r="g1m_fftJoin";else if("G2"==a)r="g2m_fftJoin";else{if("Fr"!=a)throw new Error("Invalid group");r="frm_fftJoin"}if(t.byteLength!=n.byteLength)throw new Error("Invalid buffer size");const d=Math.floor(t.byteLength/s);if(d!=1<<wa(d))throw new Error("Invalid number of points");let _=1<<wa(i.concurrency);d<=2*_&&(_=1);const u=d/_,g=[];for(let a=0;a<_;a++){const o=[],d=e.mul(c,e.exp(l,a*u)),_=t.slice(a*u*s,(a+1)*u*s),p=n.slice(a*u*s,(a+1)*u*s);o.push({cmd:"ALLOCSET",var:0,buff:_}),o.push({cmd:"ALLOCSET",var:1,buff:p}),o.push({cmd:"ALLOCSET",var:2,buff:d}),o.push({cmd:"ALLOCSET",var:3,buff:l}),o.push({cmd:"CALL",fnName:r,params:[{var:0},{var:1},{val:u},{var:2},{var:3}]}),o.push({cmd:"GET",out:0,var:0,len:u*s}),o.push({cmd:"GET",out:1,var:1,len:u*s}),g.push(i.queueAction(o))}const p=await Promise.all(g);let f,L;t instanceof qa?(f=new qa(d*s),L=new qa(d*s)):(f=new Uint8Array(d*s),L=new Uint8Array(d*s));let h=0;for(let t=0;t<p.length;t++)f.set(p[t][0],h),L.set(p[t][1],h),h+=p[t][0].byteLength;return[f,L]},o.fftFinal=async function(t,e){const n=3*o.F.n8,c=2*o.F.n8;let l,s;if("G1"==a)l="g1m_fftFinal",s="g1m_batchToAffine";else{if("G2"!=a)throw new Error("Invalid group");l="g2m_fftFinal",s="g2m_batchToAffine"}const r=Math.floor(t.byteLength/n);if(r!=1<<wa(r))throw new Error("Invalid number of points");const d=Math.floor(r/i.concurrency),_=[];for(let a=0;a<i.concurrency;a++){let o;if(o=a<i.concurrency-1?d:r-a*d,0==o)continue;const u=[],g=t.slice(a*d*n,(a*d+o)*n);u.push({cmd:"ALLOCSET",var:0,buff:g}),u.push({cmd:"ALLOCSET",var:1,buff:e}),u.push({cmd:"CALL",fnName:l,params:[{var:0},{val:o},{var:1}]}),u.push({cmd:"CALL",fnName:s,params:[{var:0},{val:o},{var:0}]}),u.push({cmd:"GET",out:0,var:0,len:o*c}),_.push(i.queueAction(u))}const u=await Promise.all(_);let g;g=t instanceof qa?new qa(r*c):new Uint8Array(r*c);let p=0;for(let t=u.length-1;t>=0;t--)g.set(u[t][0],p),p+=u[t][0].byteLength;return g}}async function Ja(t){const a=await async function(t,a){const o=new Za;o.memory=new WebAssembly.Memory({initial:Na}),o.u8=new Uint8Array(o.memory.buffer),o.u32=new Uint32Array(o.memory.buffer);const e=await WebAssembly.compile(t.code);if(o.instance=await WebAssembly.instantiate(e,{env:{memory:o.memory}}),o.singleThread=a,o.initalPFree=o.u32[0],o.pq=t.pq,o.pr=t.pr,o.pG1gen=t.pG1gen,o.pG1zero=t.pG1zero,o.pG2gen=t.pG2gen,o.pG2zero=t.pG2zero,o.pOneT=t.pOneT,a)o.code=t.code,o.taskManager=Ta(),await o.taskManager([{cmd:"INIT",init:Na,code:o.code.slice()}]),o.concurrency=1;else{let a;o.workers=[],o.pendingDeferreds=[],o.working=[],a="object"==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:Ga.cpus().length,0==a&&(a=2),a>64&&(a=64),o.concurrency=a;for(let t=0;t<a;t++)o.workers[t]=new Ra(ja),o.workers[t].addEventListener("message",i(t)),o.working[t]=!1;const e=[];for(let a=0;a<o.workers.length;a++){const i=t.code.slice();e.push(o.postAction(a,[{cmd:"INIT",init:Na,code:i}],[i.buffer]))}await Promise.all(e)}return o;function i(t){return function(a){let e;e=a&&a.data?a.data:a,o.working[t]=!1,o.pendingDeferreds[t].resolve(e),o.processWorks()}}}(t.wasm,t.singleThread),o={};return o.q=e(t.wasm.q.toString()),o.r=e(t.wasm.r.toString()),o.name=t.name,o.tm=a,o.prePSize=t.wasm.prePSize,o.preQSize=t.wasm.preQSize,o.Fr=new Oa(a,"frm",t.n8r,t.r),o.F1=new Oa(a,"f1m",t.n8q,t.q),o.F2=new Sa(a,"f2m",o.F1),o.G1=new Ma(a,"g1m",o.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),o.G2=new Ma(a,"g2m",o.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),o.F6=new za(a,"f6m",o.F2),o.F12=new Sa(a,"ftm",o.F6),o.Gt=o.F12,$a(o,"G1"),$a(o,"G2"),$a(o,"Fr"),Va(o,"G1"),Va(o,"G2"),Qa(o,"G1"),Qa(o,"G2"),Qa(o,"Fr"),function(t){const a=t.tm;t.pairing=function(o,e){a.startSyncOp();const i=a.allocBuff(t.G1.toJacobian(o)),n=a.allocBuff(t.G2.toJacobian(e)),c=a.alloc(t.Gt.n8);a.instance.exports[t.name+"_pairing"](i,n,c);const l=a.getBuff(c,t.Gt.n8);return a.endSyncOp(),l},t.pairingEq=async function(){let o,e;arguments.length%2==1?(o=arguments[arguments.length-1],e=(arguments.length-1)/2):(o=t.Gt.one,e=arguments.length/2);const i=[];for(let o=0;o<e;o++){const e=[],n=t.G1.toJacobian(arguments[2*o]);e.push({cmd:"ALLOCSET",var:0,buff:n}),e.push({cmd:"ALLOC",var:1,len:t.prePSize});const c=t.G2.toJacobian(arguments[2*o+1]);e.push({cmd:"ALLOCSET",var:2,buff:c}),e.push({cmd:"ALLOC",var:3,len:t.preQSize}),e.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),e.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),e.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),e.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),e.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),i.push(a.queueAction(e))}const n=await Promise.all(i);a.startSyncOp();const c=a.alloc(t.Gt.n8);a.instance.exports.ftm_one(c);for(let t=0;t<n.length;t++){const o=a.allocBuff(n[t][0]);a.instance.exports.ftm_mul(c,o,c)}a.instance.exports[t.name+"_finalExponentiation"](c,c);const l=a.allocBuff(o),s=!!a.instance.exports.ftm_eq(c,l);return a.endSyncOp(),s},t.prepareG1=function(t){this.tm.startSyncOp();const a=this.tm.allocBuff(t),o=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](a,o);const e=this.tm.getBuff(o,this.prePSize);return this.tm.endSyncOp(),e},t.prepareG2=function(t){this.tm.startSyncOp();const a=this.tm.allocBuff(t),o=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](a,o);const e=this.tm.getBuff(o,this.preQSize);return this.tm.endSyncOp(),e},t.millerLoop=function(t,a){this.tm.startSyncOp();const o=this.tm.allocBuff(t),e=this.tm.allocBuff(a),i=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](o,e,i);const n=this.tm.getBuff(i,this.Gt.n8);return this.tm.endSyncOp(),n},t.finalExponentiation=function(t){this.tm.startSyncOp();const a=this.tm.allocBuff(t),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](a,o);const e=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),e}}(o),o.array2buffer=function(t,a){const o=new Uint8Array(a*t.length);for(let e=0;e<t.length;e++)o.set(t[e],e*a);return o},o.buffer2array=function(t,a){const o=t.byteLength/a,e=new Array(o);for(let i=0;i<o;i++)e[i]=t.slice(i*a,i*a+a);return e},o}function Da(t){return BigInt(t)}function Ka(t){return t<0n}function Xa(t){return 0n===t}function Ya(t){const a=[],o=Da(t);return a.push(Number(0xFFn&o)),a.push(Number(o>>8n&0xFFn)),a.push(Number(o>>16n&0xFFn)),a.push(Number(o>>24n&0xFFn)),a}function Ha(t){const a=function(t){for(var a=[],o=0;o<t.length;o++){var e=t.charCodeAt(o);e<128?a.push(e):e<2048?a.push(192|e>>6,128|63&e):e<55296||e>=57344?a.push(224|e>>12,128|e>>6&63,128|63&e):(o++,e=65536+((1023&e)<<10|1023&t.charCodeAt(o)),a.push(240|e>>18,128|e>>12&63,128|e>>6&63,128|63&e))}return a}(t);return[...io(a.length),...a]}function to(t){const a=[];let o=Da(t);if(Ka(o))throw new Error("Number cannot be negative");for(;!Xa(o);)a.push(Number(0x7Fn&o)),o>>=7n;0==a.length&&a.push(0);for(let t=0;t<a.length-1;t++)a[t]=128|a[t];return a}function ao(t){let a,o;const e=function(t){return Ka(t)?t.toString(2).length-1:t.toString(2).length}(t);t<0?(o=!0,a=(1n<<BigInt(e))+t):(o=!1,a=Da(t));const i=7-e%7,n=(1<<7-i)-1|128,c=to(a+((1n<<BigInt(i))-1n<<BigInt(e)));return o||(c[c.length-1]=c[c.length-1]&n),c}function oo(t){let a=Da(t);if(a>0xFFFFFFFFn)throw new Error("Number too big");if(a>0x7FFFFFFFn&&(a-=0x100000000n),a<-2147483648n)throw new Error("Number too small");return ao(a)}function eo(t){let a=Da(t);if(a>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(a>0x7FFFFFFFFFFFFFFFn&&(a-=0x10000000000000000n),a<-9223372036854775808n)throw new Error("Number too small");return ao(a)}function io(t){let a=Da(t);if(a>0xFFFFFFFFn)throw new Error("Number too big");return to(a)}function no(t){return Array.from(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")}class co{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,a){const o=this.func.localIdxByName[t];if(void 0===o)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...a,33,...io(o)]}teeLocal(t,a){const o=this.func.localIdxByName[t];if(void 0===o)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...a,34,...io(o)]}getLocal(t){const a=this.func.localIdxByName[t];if(void 0===a)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...io(a)]}i64_load8_s(t,a,o){return[...t,48,void 0===o?0:o,...io(a||0)]}i64_load8_u(t,a,o){return[...t,49,void 0===o?0:o,...io(a||0)]}i64_load16_s(t,a,o){return[...t,50,void 0===o?1:o,...io(a||0)]}i64_load16_u(t,a,o){return[...t,51,void 0===o?1:o,...io(a||0)]}i64_load32_s(t,a,o){return[...t,52,void 0===o?2:o,...io(a||0)]}i64_load32_u(t,a,o){return[...t,53,void 0===o?2:o,...io(a||0)]}i64_load(t,a,o){return[...t,41,void 0===o?3:o,...io(a||0)]}i64_store(t,a,o,e){let i,n,c;return Array.isArray(a)?(i=0,n=3,c=a):Array.isArray(o)?(i=a,n=3,c=o):Array.isArray(e)&&(i=a,n=o,c=e),[...t,...c,55,n,...io(i)]}i64_store32(t,a,o,e){let i,n,c;return Array.isArray(a)?(i=0,n=2,c=a):Array.isArray(o)?(i=a,n=2,c=o):Array.isArray(e)&&(i=a,n=o,c=e),[...t,...c,62,n,...io(i)]}i64_store16(t,a,o,e){let i,n,c;return Array.isArray(a)?(i=0,n=1,c=a):Array.isArray(o)?(i=a,n=1,c=o):Array.isArray(e)&&(i=a,n=o,c=e),[...t,...c,61,n,...io(i)]}i64_store8(t,a,o,e){let i,n,c;return Array.isArray(a)?(i=0,n=0,c=a):Array.isArray(o)?(i=a,n=0,c=o):Array.isArray(e)&&(i=a,n=o,c=e),[...t,...c,60,n,...io(i)]}i32_load8_s(t,a,o){return[...t,44,void 0===o?0:o,...io(a||0)]}i32_load8_u(t,a,o){return[...t,45,void 0===o?0:o,...io(a||0)]}i32_load16_s(t,a,o){return[...t,46,void 0===o?1:o,...io(a||0)]}i32_load16_u(t,a,o){return[...t,47,void 0===o?1:o,...io(a||0)]}i32_load(t,a,o){return[...t,40,void 0===o?2:o,...io(a||0)]}i32_store(t,a,o,e){let i,n,c;return Array.isArray(a)?(i=0,n=2,c=a):Array.isArray(o)?(i=a,n=2,c=o):Array.isArray(e)&&(i=a,n=o,c=e),[...t,...c,54,n,...io(i)]}i32_store16(t,a,o,e){let i,n,c;return Array.isArray(a)?(i=0,n=1,c=a):Array.isArray(o)?(i=a,n=1,c=o):Array.isArray(e)&&(i=a,n=o,c=e),[...t,...c,59,n,...io(i)]}i32_store8(t,a,o,e){let i,n,c;return Array.isArray(a)?(i=0,n=0,c=a):Array.isArray(o)?(i=a,n=0,c=o):Array.isArray(e)&&(i=a,n=o,c=e),[...t,...c,58,n,...io(i)]}call(t,...a){const o=this.module.functionIdxByName[t];if(void 0===o)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...a),16,...io(o)]}call_indirect(t,...a){return[...[].concat(...a),...t,17,0,0]}if(t,a,o){return o?[...t,4,64,...a,5,...o,11]:[...t,4,64,...a,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,a){return[...a,13,...io(t)]}br(t){return[12,...io(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...eo(t)]}i32_const(t){return[65,...oo(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,a){return[...t,...a,81]}i64_ne(t,a){return[...t,...a,82]}i64_lt_s(t,a){return[...t,...a,83]}i64_lt_u(t,a){return[...t,...a,84]}i64_gt_s(t,a){return[...t,...a,85]}i64_gt_u(t,a){return[...t,...a,86]}i64_le_s(t,a){return[...t,...a,87]}i64_le_u(t,a){return[...t,...a,88]}i64_ge_s(t,a){return[...t,...a,89]}i64_ge_u(t,a){return[...t,...a,90]}i64_add(t,a){return[...t,...a,124]}i64_sub(t,a){return[...t,...a,125]}i64_mul(t,a){return[...t,...a,126]}i64_div_s(t,a){return[...t,...a,127]}i64_div_u(t,a){return[...t,...a,128]}i64_rem_s(t,a){return[...t,...a,129]}i64_rem_u(t,a){return[...t,...a,130]}i64_and(t,a){return[...t,...a,131]}i64_or(t,a){return[...t,...a,132]}i64_xor(t,a){return[...t,...a,133]}i64_shl(t,a){return[...t,...a,134]}i64_shr_s(t,a){return[...t,...a,135]}i64_shr_u(t,a){return[...t,...a,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,a){return[...t,...a,70]}i32_ne(t,a){return[...t,...a,71]}i32_lt_s(t,a){return[...t,...a,72]}i32_lt_u(t,a){return[...t,...a,73]}i32_gt_s(t,a){return[...t,...a,74]}i32_gt_u(t,a){return[...t,...a,75]}i32_le_s(t,a){return[...t,...a,76]}i32_le_u(t,a){return[...t,...a,77]}i32_ge_s(t,a){return[...t,...a,78]}i32_ge_u(t,a){return[...t,...a,79]}i32_add(t,a){return[...t,...a,106]}i32_sub(t,a){return[...t,...a,107]}i32_mul(t,a){return[...t,...a,108]}i32_div_s(t,a){return[...t,...a,109]}i32_div_u(t,a){return[...t,...a,110]}i32_rem_s(t,a){return[...t,...a,111]}i32_rem_u(t,a){return[...t,...a,112]}i32_and(t,a){return[...t,...a,113]}i32_or(t,a){return[...t,...a,114]}i32_xor(t,a){return[...t,...a,115]}i32_shl(t,a){return[...t,...a,116]}i32_shr_s(t,a){return[...t,...a,117]}i32_shr_u(t,a){return[...t,...a,118]}i32_rotl(t,a){return[...t,...a,119]}i32_rotr(t,a){return[...t,...a,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}const lo={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class so{constructor(t,a,o,e,i){if("import"==o)this.fnType="import",this.moduleName=e,this.fieldName=i;else{if("internal"!=o)throw new Error("Invalid function fnType: "+o);this.fnType="internal"}this.module=t,this.fnName=a,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,a){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const o=this.nextLocal++;this.localIdxByName[t]=o,this.params.push({type:a})}addLocal(t,a,o){const e=o||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const i=this.nextLocal++;this.localIdxByName[t]=i,this.locals.push({type:a,length:e})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){return[96,...[...io(this.params.length),...this.params.map((t=>lo[t.type]))],...this.returnType?[1,lo[this.returnType]]:[0]]}getBody(){const t=this.locals.map((t=>[...io(t.length),lo[t.type]])),a=[...io(this.locals.length),...[].concat(...t),...this.code,11];return[...io(a.length),...a]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new co(this)}}class ro{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Ya(1836278016),...Ya(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);const a=this.functions.length;return this.functionIdxByName[t]=a,this.functions.push(new so(this,t,"internal")),this.nInternalFunctions++,this.functions[a]}addIimportFunction(t,a,o){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw new Error(`Import functions must be declared before internal: ${t}`);let e=o||t;const i=this.functions.length;return this.functionIdxByName[t]=i,this.functions.push(new so(this,t,"import",a,e)),this.nImportFunctions++,this.functions[i]}setMemory(t,a,o){this.memory={pagesSize:t,moduleName:a||"env",fieldName:o||"memory"}}exportFunction(t,a){const o=a||t;if(void 0===this.functionIdxByName[t])throw new Error(`Function not defined: ${t}`);const e=this.functionIdxByName[t];o!=t&&(this.functionIdxByName[o]=e),this.exports.push({exportName:o,idx:e})}addFunctionToTable(t){const a=this.functionIdxByName[t];this.functionsTable.push(a)}addData(t,a){this.datas.push({offset:t,bytes:a})}alloc(t,a){let o,e;(Array.isArray(t)||ArrayBuffer.isView(t))&&void 0===a?(o=t.length,e=t):(o=t,e=a),o=1+(o-1>>3)<<3;const i=this.free;return this.free+=o,e&&this.addData(i,e),i}allocString(t){const a=(new globalThis.TextEncoder).encode(t);return this.alloc([...a,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const a=this.functions[this.functionsTable[0]].getSignature();t["s_"+no(a)]=0,this.signatures.push(a)}for(let a=0;a<this.functions.length;a++){const o=this.functions[a].getSignature(),e="s_"+no(o);void 0===t[e]&&(t[e]=this.signatures.length,this.signatures.push(o)),this.functions[a].signatureIdx=t[e]}}_buildSection(t,a){return[t,...io(a.length),...a]}_buildType(){return this._buildSection(1,[...io(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...Ha(this.memory.moduleName),...Ha(this.memory.fieldName),2,0,...io(this.memory.pagesSize)]);for(let a=0;a<this.nImportFunctions;a++)t.push([...Ha(this.functions[a].moduleName),...Ha(this.functions[a].fieldName),0,...io(this.functions[a].signatureIdx)]);return this._buildSection(2,io(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let a=this.nImportFunctions;a<this.nImportFunctions+this.nInternalFunctions;a++)t.push(...io(this.functions[a].signatureIdx));return this._buildSection(3,[...io(t.length),...t])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...io(1),112,0,...io(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];const t=[];for(let a=0;a<this.functionsTable.length;a++)t.push(...io(this.functionsTable[a]));return this._buildSection(9,[...io(1),...io(0),65,...oo(0),11,...io(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let a=0;a<this.exports.length;a++)t.push([...Ha(this.exports[a].exportName),0,...io(this.exports[a].idx)]);return this._buildSection(7,io(t.length).concat(...t))}_buildCode(){const t=[];for(let a=this.nImportFunctions;a<this.nImportFunctions+this.nInternalFunctions;a++)t.push(this.functions[a].getBody());return this._buildSection(10,io(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Ya(this.free)]);for(let a=0;a<this.datas.length;a++)t.push([0,65,...oo(this.datas[a].offset),11,...io(this.datas[a].bytes.length),...this.datas[a].bytes]);return this._buildSection(11,io(t.length).concat(...t))}}globalThis.curve_bn128=null,globalThis.curve_bls12381=null,e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),e("21888242871839275222246405745257275088548364400416034343698204186575808495617"),e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),e("21888242871839275222246405745257275088696311157297823662689037894645226208583");const _o=S,uo=va;const go=new Uint8Array(4),po=new DataView(go.buffer),fo=new Uint8Array(8),Lo=new DataView(fo.buffer);class ho{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){const a=Math.max(this.allocSize+(1<<20),Math.floor(1.1*this.allocSize),t),o=new Uint8Array(a);o.set(this.o.data),this.o.data=o,this.allocSize=a}}async write(t,a){if(void 0===a&&(a=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(a+t.byteLength),this.o.data.set(t.slice(),a),a+t.byteLength>this.totalSize&&(this.totalSize=a+t.byteLength),this.pos=a+t.byteLength}async readToBuffer(t,a,o,e){if(void 0===e&&(e=this.pos),this.readOnly&&e+o>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(e+o);const i=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+e,o);t.set(i,a),this.pos=e+o}async read(t,a){const o=new Uint8Array(t);return await this.readToBuffer(o,0,t,a),o}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,a){po.setUint32(0,t,!0),await this.write(go,a)}async writeUBE32(t,a){po.setUint32(0,t,!1),await this.write(go,a)}async writeULE64(t,a){Lo.setUint32(0,4294967295&t,!0),Lo.setUint32(4,Math.floor(t/4294967296),!0),await this.write(fo,a)}async readULE32(t){const a=await this.read(4,t);return new Uint32Array(a.buffer)[0]}async readUBE32(t){const a=await this.read(4,t);return new DataView(a.buffer).getUint32(0,!1)}async readULE64(t){const a=await this.read(8,t),o=new Uint32Array(a.buffer);return 4294967296*o[1]+o[0]}async readString(t){const a=this;let o=void 0===t?a.pos:t;if(o>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}const e=new Uint8Array(a.o.data.buffer,o,this.totalSize-o);let i=e.findIndex((t=>0===t)),n="";return-1!==i?(n=(new TextDecoder).decode(e.slice(0,i)),a.pos=o+i+1):a.pos=o,n}}async function mo(t,a,o){if(t instanceof Uint8Array)t={type:"mem",data:t};else if(!t||"mem"!==t.type)throw new Error("Invalid FastFile type, should be a Uint8Array");return function(t){const a=new ho;return a.o=t,a.allocSize=t.data.byteLength,a.totalSize=t.data.byteLength,a.readOnly=!0,a.pos=0,a}(t)}async function bo(t,a,o){if("mem"==t.type)return function(t){const a=t.initialSize||1<<20,o=new ho;return o.o=t,o.o.data=new Uint8Array(a),o.allocSize=a,o.totalSize=0,o.readOnly=!1,o.pos=0,o}(t);throw new Error("Invalid FastFile type: "+t.type)}async function yo(t,a,o,e,i){const n=await mo(t.data||t),c=await n.read(4);let l="";for(let t=0;t<4;t++)l+=String.fromCharCode(c[t]);if(l!=a)throw new Error(t+": Invalid File format");if(await n.readULE32()>o)throw new Error("Version not supported");const s=await n.readULE32();let r=[];for(let t=0;t<s;t++){let t=await n.readULE32(),a=await n.readULE64();void 0===r[t]&&(r[t]=[]),r[t].push({p:n.pos,size:a}),n.pos+=a}return{fd:n,sections:r}}async function xo(t,a){if(void 0!==t.writingSection)throw new Error("Already writing a section");await t.writeULE32(a),t.writingSection={pSectionSize:t.pos},await t.writeULE64(0)}async function Fo(t){if(void 0===t.writingSection)throw new Error("Not writing a section");const a=t.pos-t.writingSection.pSectionSize-8,o=t.pos;t.pos=t.writingSection.pSectionSize,await t.writeULE64(a),t.pos=o,delete t.writingSection}async function Co(t,a,o){if(void 0!==t.readingSection)throw new Error("Already reading a section");if(!a[o])throw new Error(t.fileName+": Missing section "+o);if(a[o].length>1)throw new Error(t.fileName+": Section Duplicated "+o);t.pos=a[o][0].p,t.readingSection=a[o][0]}async function wo(t,a){if(void 0===t.readingSection)throw new Error("Not reading a section");if(!a&&t.pos-t.readingSection.p!=t.readingSection.size)throw new Error("Invalid section size reading");delete t.readingSection}async function Bo(t,a,o){const e=await t.read(a,o);return _o.fromRprLE(e,0,a)}async function Ao(t,a,o,e,i){if((e=void 0===e?0:e)+(i=void 0===i?a[o][0].size-e:i)>a[o][0].size)throw new Error("Reading out of the range of the section");let n;return n=i<1<<30?new Uint8Array(i):new qa(i),await t.readToBuffer(n,0,i,a[o][0].p+e),n}const Po=_o.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),vo=_o.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function Io(t){let a;if(_o.eq(t,vo))a=await async function(t,a){const o=new ro;o.setMemory(25),ma(o),a&&a(o);const i={};if(i.code=o.build(),i.pq=o.modules.f1m.pq,i.pr=o.modules.frm.pq,i.pG1gen=o.modules.bn128.pG1gen,i.pG1zero=o.modules.bn128.pG1zero,i.pG1b=o.modules.bn128.pG1b,i.pG2gen=o.modules.bn128.pG2gen,i.pG2zero=o.modules.bn128.pG2zero,i.pG2b=o.modules.bn128.pG2b,i.pOneT=o.modules.bn128.pOneT,i.prePSize=o.modules.bn128.prePSize,i.preQSize=o.modules.bn128.preQSize,i.n8q=32,i.n8r=32,i.q=o.modules.bn128.q,i.r=o.modules.bn128.r,!t&&globalThis.curve_bn128)return globalThis.curve_bn128;const n={name:"bn128",wasm:i,q:e("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:e("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:e("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},c=await Ja(n);return c.terminate=async function(){n.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=c),c}();else{if(!_o.eq(t,Po))throw new Error(`Curve not supported: ${_o.toString(t)}`);a=await async function(t,a){const o=new ro;o.setMemory(25),ba(o),a&&a(o);const i={};if(i.code=o.build(),i.pq=o.modules.f1m.pq,i.pr=o.modules.frm.pq,i.pG1gen=o.modules.bls12381.pG1gen,i.pG1zero=o.modules.bls12381.pG1zero,i.pG1b=o.modules.bls12381.pG1b,i.pG2gen=o.modules.bls12381.pG2gen,i.pG2zero=o.modules.bls12381.pG2zero,i.pG2b=o.modules.bls12381.pG2b,i.pOneT=o.modules.bls12381.pOneT,i.prePSize=o.modules.bls12381.prePSize,i.preQSize=o.modules.bls12381.preQSize,i.n8q=48,i.n8r=32,i.q=o.modules.bls12381.q,i.r=o.modules.bls12381.r,!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const n={name:"bls12381",wasm:i,q:e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:e("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:e("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},c=await Ja(n);return c.terminate=async function(){n.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=c),c}()}return a}function qo(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}const Eo=1;async function Oo(t,a,o){const e=await t.read(2*a.G1.F.n8),i=a.G1.fromRprLEM(e,0);return o?a.G1.toObject(i):i}async function So(t,a,o){const e=await t.read(2*a.G2.F.n8),i=a.G2.fromRprLEM(e,0);return o?a.G2.toObject(i):i}async function zo(t,a,o){await xo(t,1);const e=8*(Math.floor((_o.bitLength(o)-1)/64)+1);if(await t.writeULE32(e),await async function(t,a,o,e){const i=new Uint8Array(o);_o.toRprLE(i,0,a,o),await t.write(i,e)}(t,o,e),a.byteLength%e!=0)throw new Error("Invalid witness length");await t.writeULE32(a.byteLength/e),await Fo(t),await xo(t,2),await t.write(a),await Fo(t)}const{stringifyBigInts:Mo}=uo;async function To(t,a,o){const{fd:e,sections:i}=await yo(a,"wtns",2),n=await async function(t,a){await Co(t,a,1);const o=await t.readULE32(),e=await Bo(t,o),i=await t.readULE32();return await wo(t),{n8:o,q:e,nWitness:i}}(e,i),{fd:c,sections:l}=await yo(t,"zkey",2),s=await async function(t,a,o){await Co(t,a,1);const e=await t.readULE32();if(await wo(t),e!==Eo)throw new Error("Protocol not supported: ");const i={protocol:"groth16"};await Co(t,a,2);const n=await t.readULE32();i.n8q=n,i.q=await Bo(t,n);const c=await t.readULE32();return i.n8r=c,i.r=await Bo(t,c),i.curve=await Io(i.q),i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=qo(i.domainSize),i.vk_alpha_1=await Oo(t,i.curve,o),i.vk_beta_1=await Oo(t,i.curve,o),i.vk_beta_2=await So(t,i.curve,o),i.vk_gamma_2=await So(t,i.curve,o),i.vk_delta_1=await Oo(t,i.curve,o),i.vk_delta_2=await So(t,i.curve,o),await wo(t),i}(c,l);if("groth16"!=s.protocol)throw new Error("zkey file is not groth16");if(!_o.eq(s.r,n.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(n.nWitness!=s.nVars)throw new Error(`Invalid witness length. Circuit: ${s.nVars}, witness: ${n.nWitness}`);const r=s.curve,d=r.Fr,_=r.G1,u=r.G2,g=qo(s.domainSize);o&&o.debug("Reading Wtns");const p=await Ao(e,i,2);o&&o.debug("Reading Coeffs");const f=await Ao(c,l,4);o&&o.debug("Building ABC");const[L,h,m]=await async function(t,a,o,e,i){const n=t.Fr.n8,c=12+a.n8r,l=(e.byteLength-4)/c,s=new qa(a.domainSize*n),r=new qa(a.domainSize*n),d=new qa(a.domainSize*n),_=[s,r];for(let a=0;a<l;a++){i&&a%1e6==0&&i.debug(`QAP AB: ${a}/${l}`);const s=e.slice(4+a*c,4+a*c+c),r=new DataView(s.buffer),d=r.getUint32(0,!0),u=r.getUint32(4,!0),g=r.getUint32(8,!0),p=s.slice(12,12+n);_[d].set(t.Fr.add(_[d].slice(u*n,u*n+n),t.Fr.mul(p,o.slice(g*n,g*n+n))),u*n)}for(let o=0;o<a.domainSize;o++)i&&o%1e6==0&&i.debug(`QAP C: ${o}/${a.domainSize}`),d.set(t.Fr.mul(s.slice(o*n,o*n+n),r.slice(o*n,o*n+n)),o*n);return[s,r,d]}(r,s,p,f,o),b=g==d.s?r.Fr.shift:r.Fr.w[g+1],y=await d.ifft(L,"","",o,"IFFT_A"),x=await d.batchApplyKey(y,d.e(1),b),F=await d.fft(x,"","",o,"FFT_A"),C=await d.ifft(h,"","",o,"IFFT_B"),w=await d.batchApplyKey(C,d.e(1),b),B=await d.fft(w,"","",o,"FFT_B"),A=await d.ifft(m,"","",o,"IFFT_C"),P=await d.batchApplyKey(A,d.e(1),b),v=await d.fft(P,"","",o,"FFT_C");o&&o.debug("Join ABC");const I=await async function(t,a,o,e,i,n){const c=1<<22,l=t.Fr.n8,s=Math.floor(o.byteLength/t.Fr.n8),r=[];for(let a=0;a<s;a+=c){n&&n.debug(`JoinABC: ${a}/${s}`);const d=Math.min(s-a,c),_=[],u=o.slice(a*l,(a+d)*l),g=e.slice(a*l,(a+d)*l),p=i.slice(a*l,(a+d)*l);_.push({cmd:"ALLOCSET",var:0,buff:u}),_.push({cmd:"ALLOCSET",var:1,buff:g}),_.push({cmd:"ALLOCSET",var:2,buff:p}),_.push({cmd:"ALLOC",var:3,len:d*l}),_.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:d},{var:3}]}),_.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:d},{var:3}]}),_.push({cmd:"GET",out:0,var:3,len:d*l}),r.push(t.tm.queueAction(_))}const d=await Promise.all(r);let _;_=o instanceof qa?new qa(o.byteLength):new Uint8Array(o.byteLength);let u=0;for(let t=0;t<d.length;t++)_.set(d[t][0],u),u+=d[t][0].byteLength;return _}(r,0,F,B,v,o);let q={};o&&o.debug("Reading A Points");const E=await Ao(c,l,5);q.pi_a=await r.G1.multiExpAffine(E,p,o,"multiexp A"),o&&o.debug("Reading B1 Points");const O=await Ao(c,l,6);let S=await r.G1.multiExpAffine(O,p,o,"multiexp B1");o&&o.debug("Reading B2 Points");const z=await Ao(c,l,7);q.pi_b=await r.G2.multiExpAffine(z,p,o,"multiexp B2"),o&&o.debug("Reading C Points");const M=await Ao(c,l,8);q.pi_c=await r.G1.multiExpAffine(M,p.slice((s.nPublic+1)*r.Fr.n8),o,"multiexp C"),o&&o.debug("Reading H Points");const T=await Ao(c,l,9),G=await r.G1.multiExpAffine(T,I,o,"multiexp H"),R=r.Fr.random(),N=r.Fr.random();q.pi_a=_.add(q.pi_a,s.vk_alpha_1),q.pi_a=_.add(q.pi_a,_.timesFr(s.vk_delta_1,R)),q.pi_b=u.add(q.pi_b,s.vk_beta_2),q.pi_b=u.add(q.pi_b,u.timesFr(s.vk_delta_2,N)),S=_.add(S,s.vk_beta_1),S=_.add(S,_.timesFr(s.vk_delta_1,N)),q.pi_c=_.add(q.pi_c,G),q.pi_c=_.add(q.pi_c,_.timesFr(q.pi_a,N)),q.pi_c=_.add(q.pi_c,_.timesFr(S,R)),q.pi_c=_.add(q.pi_c,_.timesFr(s.vk_delta_1,d.neg(d.mul(R,N))));let k=[];for(let t=1;t<=s.nPublic;t++){const a=p.slice(t*d.n8,t*d.n8+d.n8);k.push(_o.fromRprLE(a))}return q.pi_a=_.toObject(_.toAffine(q.pi_a)),q.pi_b=u.toObject(u.toAffine(q.pi_b)),q.pi_c=_.toObject(_.toAffine(q.pi_c)),q.protocol="groth16",q.curve=r.name,await c.close(),await e.close(),q=Mo(q),k=Mo(k),{proof:q,publicSignals:k}}function Go(t){var a=[];return function t(a,o){if(Array.isArray(o))for(let e=0;e<o.length;e++)t(a,o[e]);else a.push(o)}(a,t),a}function Ro(t){const a=BigInt(2)**BigInt(64);let o=BigInt("0xCBF29CE484222325");for(var e=0;e<t.length;e++)o^=BigInt(t[e].charCodeAt()),o*=BigInt(1099511628211),o%=a;let i=o.toString(16),n=16-i.length;return i="0".repeat(n).concat(i),i}function No(t,a){const o=[];let e=BigInt(t);const i=BigInt(4294967296);for(;e;)o.unshift(Number(e%i)),e/=i;if(a)for(var n=a-o.length;n>0;)o.unshift(0),n--;return o}class ko{constructor(t,a,o){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=a,this.n32=(this.instance.exports.getFrLen()>>2)-2;const e=this.instance.exports.getPRawPrime(),i=new Array(this.n32);for(let t=0;t<this.n32;t++)i[this.n32-1-t]=this.i32[(e>>2)+t];this.prime=_o.fromArray(i,4294967296),this.Fr=new $(this.prime),this.mask32=_o.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(_o.shiftLeft(1,64*this.n64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=o}circom_version(){return 1}async _doCalculateWitness(t,a){this.instance.exports.init(this.sanityCheck||a?1:0);const o=this.allocInt(),e=this.allocFr();Object.keys(t).forEach((a=>{const i=Ro(a),n=parseInt(i.slice(0,8),16),c=parseInt(i.slice(8,16),16);try{this.instance.exports.getSignalOffset32(o,0,n,c)}catch(t){throw new Error(`Signal ${a} is not an input of the circuit.`)}const l=this.getInt(o),s=Go(t[a]);for(let t=0;t<s.length;t++)this.setFr(e,s[t]),this.instance.exports.setSignal(0,0,l+t,e)}))}async calculateWitness(t,a){const o=this,e=o.i32[0],i=[];await o._doCalculateWitness(t,a);for(let t=0;t<o.NVars;t++){const a=o.instance.exports.getPWitness(t);i.push(o.getFr(a))}return o.i32[0]=e,i}async calculateBinWitness(t,a){const o=this,e=o.i32[0];await o._doCalculateWitness(t,a);const i=o.instance.exports.getWitnessBuffer();o.i32[0]=e;const n=o.memory.buffer.slice(i,i+o.NVars*o.n64*8);return new Uint8Array(n)}allocInt(){const t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){const t=this.i32[0];return this.i32[0]=t+4*this.n32+8,t}getInt(t){return this.i32[t>>2]}setInt(t,a){this.i32[t>>2]=a}getFr(t){const a=this,o=t>>2;if(2147483648&a.i32[o+1]){const t=new Array(a.n32);for(let e=0;e<a.n32;e++)t[a.n32-1-e]=a.i32[o+2+e];const i=a.Fr.e(_o.fromArray(t,4294967296));return 1073741824&a.i32[o+1]?(e=i,a.Fr.mul(a.RInv,e)):i}return 2147483648&a.i32[o]?a.Fr.e(a.i32[o]-4294967296):a.Fr.e(a.i32[o]);var e}setFr(t,a){const o=this;a=o.Fr.e(a);const e=o.Fr.neg(o.Fr.e("80000000",16)),i=o.Fr.e("7FFFFFFF",16);if(o.Fr.geq(a,e)&&o.Fr.leq(a,i)){let i;return o.Fr.geq(a,o.Fr.zero)?i=_o.toNumber(a):(i=_o.toNumber(o.Fr.sub(a,e)),i-=2147483648,i=4294967296+i),o.i32[t>>2]=i,void(o.i32[1+(t>>2)]=0)}o.i32[t>>2]=0,o.i32[1+(t>>2)]=2147483648;const n=_o.toArray(a,4294967296);for(let a=0;a<o.n32;a++){const e=n.length-1-a;o.i32[2+(t>>2)+a]=e>=0?n[e]:0}}}class Uo{constructor(t,a){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const o=new Array(this.n32);for(let t=0;t<this.n32;t++)o[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);this.prime=_o.fromArray(o,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=a}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,a){this.instance.exports.init(this.sanityCheck||a?1:0);const o=Object.keys(t);var e=0;if(o.forEach((a=>{const o=Ro(a),i=parseInt(o.slice(0,8),16),n=parseInt(o.slice(8,16),16),c=Go(t[a]);for(let t=0;t<c.length;t++){const a=No(c[t],this.n32);for(let t=0;t<this.n32;t++)this.instance.exports.writeSharedRWMemory(t,a[this.n32-1-t]);try{this.instance.exports.setInputSignal(i,n,t),e++}catch(t){throw new Error(t)}}})),e<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${e} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,a){const o=[];await this._doCalculateWitness(t,a);for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);const a=new Uint32Array(this.n32);for(let t=0;t<this.n32;t++)a[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);o.push(_o.fromArray(a,4294967296))}return o}async calculateWTNSBin(t,a){const o=new Uint32Array(this.witnessSize*this.n32+this.n32+11),e=new Uint8Array(o.buffer);await this._doCalculateWitness(t,a),e[0]="w".charCodeAt(0),e[1]="t".charCodeAt(0),e[2]="n".charCodeAt(0),e[3]="s".charCodeAt(0),o[1]=2,o[2]=2,o[3]=1;const i=4*this.n32,n=(8+i).toString(16);o[4]=parseInt(n.slice(0,8),16),o[5]=parseInt(n.slice(8,16),16),o[6]=i,this.instance.exports.getRawPrime();var c=7;for(let t=0;t<this.n32;t++)o[c+t]=this.instance.exports.readSharedRWMemory(t);o[c+=this.n32]=this.witnessSize,o[++c]=2,c++;const l=(i*this.witnessSize).toString(16);o[c]=parseInt(l.slice(0,8),16),o[c+1]=parseInt(l.slice(8,16),16),c+=2;for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);for(let t=0;t<this.n32;t++)o[c+t]=this.instance.exports.readSharedRWMemory(t);c+=this.n32}return e}}const{unstringifyBigInts:jo}=uo;async function Zo(t,a,o,e){const i=jo(t),n=await mo(a),c=await n.read(n.totalSize);await n.close();const l=await async function(t,a){a=a||{};let o,e=32767,i=!1;for(;!i;)try{o=new WebAssembly.Memory({initial:e}),i=!0}catch(t){if(1===e)throw t;console.warn("Could not allocate "+1024*e*64+" bytes. This may cause severe instability. Trying with "+1024*e*64/2+" bytes"),e=Math.floor(e/2)}const n=await WebAssembly.compile(t);let c,l="",s="",r=1,d=0,_=0;const u=await WebAssembly.instantiate(n,{env:{memory:o},runtime:{exceptionHandler:function(t){let a;throw a=1==t?"Signal not found. ":2==t?"Too many signals set. ":3==t?"Signal already set. ":4==t?"Assert Failed. ":5==t?"Not enough memory. ":6==t?"Input signal array access exceeds the size. ":"Unknown error. ",console.error("ERROR: ",t,l),new Error(a+l)},printErrorMessage:function(){l+=p()+"\n"},writeBufferMessage:function(){const t=p();"\n"===t?(console.log(s),s=""):(""!==s&&(s+=" "),s+=t)},showSharedRWMemory:function(){const t=u.exports.getFieldNumLen32(),a=new Uint32Array(t);for(let o=0;o<t;o++)a[t-1-o]=u.exports.readSharedRWMemory(o);if(r>=2&&(d>=1||_>=7)){""!==s&&(s+=" ");const t=_o.fromArray(a,4294967296).toString();s+=t}else console.log(_o.fromArray(a,4294967296))},error:function(t,o,e,i,n,l){let s;throw s=7==t?f(o)+" "+c.getFr(i).toString()+" != "+c.getFr(n).toString()+" "+f(l):9==t?f(o)+" "+c.getFr(i).toString()+" "+f(n):5==t&&a.sym?f(o)+" "+a.sym.labelIdx2Name[n]:f(o)+" "+e+" "+i+" "+n+" "+l,console.log("ERROR: ",t,s),new Error(s)},log:function(t){console.log(c.getFr(t).toString())},logGetSignal:function(t,o){a.logGetSignal&&a.logGetSignal(t,c.getFr(o))},logSetSignal:function(t,o){a.logSetSignal&&a.logSetSignal(t,c.getFr(o))},logStartComponent:function(t){a.logStartComponent&&a.logStartComponent(t)},logFinishComponent:function(t){a.logFinishComponent&&a.logFinishComponent(t)}}});"function"==typeof u.exports.getVersion&&(r=u.exports.getVersion()),"function"==typeof u.exports.getMinorVersion&&(d=u.exports.getMinorVersion()),"function"==typeof u.exports.getPatchVersion&&(_=u.exports.getPatchVersion());const g=a&&(a.sanityCheck||a.logGetSignal||a.logSetSignal||a.logStartComponent||a.logFinishComponent);return c=2===r?new Uo(u,g):new ko(o,u,g),c;function p(){for(var t="",a=u.exports.getMessageChar();0!=a;)t+=String.fromCharCode(a),a=u.exports.getMessageChar();return t}function f(t){const a=new Uint8Array(o.buffer),e=[];for(let o=0;a[t+o]>0;o++)e.push(a[t+o]);return String.fromCharCode.apply(null,e)}}(c);if(1==l.circom_version()){const t=await l.calculateBinWitness(i),a=await async function(t,a,o,e,i,n){const c=await bo(t),l=new Uint8Array(4);for(let t=0;t<4;t++)l[t]=a.charCodeAt(t);return await c.write(l,0),await c.writeULE32(o),await c.writeULE32(e),c}(o,"wtns",2,2);await zo(a,t,l.prime),await a.close()}else{const t=await bo(o),a=await l.calculateWTNSBin(i);await t.write(a),await t.close()}}const{unstringifyBigInts:$o}=uo;var Wo=Object.freeze({__proto__:null,fullProve:async function(t,a,o,e){const i=$o(t),n={type:"mem"};return await Zo(i,a,n),await To(o,n,e)},prove:To});return t.groth16=Wo,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
